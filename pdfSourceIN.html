<html><head><meta charset="UTF-8"><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-bash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-css.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-dockerfile.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-groovy.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-nginx.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-none.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-sql.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-yaml.min.js"></script><style>
        .article {
            position: relative;
            padding-bottom: 24px;
        }
        

        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        

        .center-text {
            text-align: center;
        }
        

        .code-block {
            overflow: hidden;
            position: relative;
            padding: 0;
            border-radius: 8px;
            font-variant-ligatures: none;
            background-color: rgba(25, 25, 28, .05);
            word-break: break-all;
        }
        

        .container {
            max-width: 100%;
            overflow: hidden;
            page-break-inside: avoid;
            display: block;
        }
        

        .control {
            color: #19191c;
            font-size: 16px;
            font-weight: 670;
        }
        

        .detached {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-bottom: 8px;
        }
        

        .image {
            max-width: 100%;
            max-height: 90vh;
            width: auto;
        }
        

        .image-container {
            max-width: 100vw;
        }
        

        .image-size {
            height: auto;
        }
        

        .inline-code {
            border-radius: 4px;
            display: inline;
            padding: 2px 1px;
            font-family: JetBrains Sans,monospace;
            background: #e6e6e6;
        }
        

        .list {
            list-style-type: disc;
            padding-left: 0;
            margin-left: 15px;
        }
        

        .list-decimal {
            list-style-type: decimal;
        }
        

        .list-item {
            margin-top: 6px;
            margin-bottom: 6px;
            margin-left: 4px;
        }
        

        .main-title {
            padding-bottom: 24px;
            margin-top: 0;
            font-size: 40px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .prism {
            page-break-inside: avoid;
        }
        
        /* PrismJS 1.29.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+abnf+actionscript+ada+agda+al+antlr4+apacheconf+apex+apl+applescript+aql+arduino+arff+armasm+arturo+asciidoc+aspnet+asm6502+asmatmel+autohotkey+autoit+avisynth+avro-idl+awk+bash+basic+batch+bbcode+bbj+bicep+birb+bison+bnf+bqn+brainfuck+brightscript+bro+bsl+c+csharp+cpp+cfscript+chaiscript+cil+cilkc+cilkcpp+clojure+cmake+cobol+coffeescript+concurnas+csp+cooklang+coq+crystal+css-extras+csv+cue+cypher+d+dart+dataweave+dax+dhall+diff+django+dns-zone-file+docker+dot+ebnf+editorconfig+eiffel+ejs+elixir+elm+etlua+erb+erlang+excel-formula+fsharp+factor+false+firestore-security-rules+flow+fortran+ftl+gml+gap+gcode+gdscript+gedcom+gettext+gherkin+git+glsl+gn+linker-script+go+go-module+gradle+graphql+groovy+haml+handlebars+haskell+haxe+hcl+hlsl+hoon+http+hpkp+hsts+ichigojam+icon+icu-message-format+idris+ignore+inform7+ini+io+j+java+javadoc+javadoclike+javastacktrace+jexl+jolie+jq+jsdoc+js-extras+json+json5+jsonp+jsstacktrace+js-templates+julia+keepalived+keyman+kotlin+kumir+kusto+latex+latte+less+lilypond+liquid+lisp+livescript+llvm+log+lolcode+lua+magma+makefile+markdown+markup-templating+mata+matlab+maxscript+mel+mermaid+metafont+mizar+mongodb+monkey+moonscript+n1ql+n4js+nand2tetris-hdl+naniscript+nasm+neon+nevod+nginx+nim+nix+nsis+objectivec+ocaml+odin+opencl+openqasm+oz+parigp+parser+pascal+pascaligo+psl+pcaxis+peoplecode+perl+php+phpdoc+php-extras+plant-uml+plsql+powerquery+powershell+processing+prolog+promql+properties+protobuf+pug+puppet+pure+purebasic+purescript+python+qsharp+q+qml+qore+r+racket+cshtml+jsx+tsx+reason+regex+rego+renpy+rescript+rest+rip+roboconf+robotframework+ruby+rust+sas+sass+scss+scala+scheme+shell-session+smali+smalltalk+smarty+sml+solidity+solution-file+soy+sparql+splunk-spl+sqf+sql+squirrel+stan+stata+iecst+stylus+supercollider+swift+systemd+t4-templating+t4-cs+t4-vb+tap+tcl+tt2+textile+toml+tremor+turtle+twig+typescript+typoscript+unrealscript+uorazor+uri+v+vala+vbnet+velocity+verilog+vhdl+vim+visual-basic+warpscript+wasm+web-idl+wgsl+wiki+wolfram+wren+xeora+xml-doc+xojo+xquery+yaml+yang+zig&plugins=highlight-keywords */
code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:16px;margin:0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

        

        :root {
            width: 95%;
            max-width: 95vw;
            padding: 0 0 0 30px;
        }
        
        body {
            font-family: JetBrains Sans,serif;
        }
        
        a {
            overflow-wrap: anywhere;
            width: 100vw;
        }
        
        
        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff) format("woff");
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff) format("woff");
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff) format("woff");
            font-weight: 600;
            font-style: normal;
        }
        
        
        code {
            display: inline;
            word-break: break-word;
            font-size: 15px;
            line-height: inherit;
            font-variant-ligatures: none;
            font-family: JetBrains Sans,monospace;
            white-space: pre-line;
            overflow-wrap: break-word;
        }
        
        figcaption {
            margin-top: 5px;
        }
        
        h2 {
            padding-top: 16px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h3 {
            padding-top: 8px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h4 {
            padding-top: 4px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        p {
            padding: 0;
            border: 0;
            line-height: 25px;
            margin-block-start: 0;
            margin-block-end: 0;
            padding-bottom: 8px;
        }
        
        div {
            display: block;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #c4c4c4;
            padding: 10px;
            text-align: left;
            word-break: break-all;
        }
        
        .entry {
            display: grid;
            grid-template-columns: auto max-content;
            grid-template-areas: "chapter page";
            align-items: end;
            gap: 0 .25rem;
            line-height: 25px;
        }
        
        .toc-link-container{
            grid-area: chapter;
            position: relative;
            overflow: hidden;
        }
        
        .toc-link{
            text-decoration: none;
            color: black;
        }
        
        .toc-link-container::after {
            position: absolute;
            padding-left: .25ch;
            content: " . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ";
            text-align: right;
        }
        
        .page {
            grid-area: page;
            width: 30px;
            text-align: right;
        }
        

        .topic {
            page-break-before: always;
        }
        </style></head><body><div><section class="topic"><div><article class="article"><h1 class="main-title">Table of contents</h1><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1446709650">Getting started with docker</a></div><div class="page">2</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2101908822">Dockerizing MongoDB</a></div><div class="page">12</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-360695856">Dockerizing PostgreSQL</a></div><div class="page">19</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1933182566">Dockerizing MySQL</a></div><div class="page">27</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1559871545">Dockerizing MSSQL</a></div><div class="page">35</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1119023943">Dockerizing React, Node.js, Postgres &amp; Nginx &lt;Dev &amp; Prod&gt;</a></div><div class="page">44</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2032313741">Restore the old Context Menu in Windows 11</a></div><div class="page">81</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#114282917">Kubernetes Multi Container Deployment | React | Node.js | Postgres | Ingress Nginx | step by step</a></div><div class="page">82</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#52475659">What is Kubernetes?</a></div><div class="page">89</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1601392088">Kubernetes Cheat Sheet</a></div><div class="page">104</div></div></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1446709650">Getting started with docker</h1><section><h2 id="1446709650#chapter-1-introduction-to-docker" data-toc="chapter-1-introduction-to-docker#Getting-started-with-docker.md-chapter-1-introduction-to-docker">Chapter 1: Introduction to Docker</h2><section><h3 id="1446709650#1-1-what-is-docker" data-toc="1-1-what-is-docker#Getting-started-with-docker.md-1-1-what-is-docker">1.1 What is Docker?</h3><p id="1446709650#-apd569_17">Docker is a platform that enables developers to package, deploy, and run applications in containers. Containers include everything needed to run the application, making it portable and consistent across different environments.</p></section><section><h3 id="1446709650#1-2-why-use-docker" data-toc="1-2-why-use-docker#Getting-started-with-docker.md-1-2-why-use-docker">1.2 Why Use Docker?</h3><ul class="list" id="1446709650#-apd569_18" start="1"><li class="list-item" id="1446709650#-apd569_19"><p>Consistency across development, testing, and production environments</p></li><li class="list-item" id="1446709650#-apd569_20"><p>Isolation and security</p></li><li class="list-item" id="1446709650#-apd569_21"><p>Simplified dependency management</p></li><li class="list-item" id="1446709650#-apd569_22"><p>Efficient resource utilization</p></li></ul></section></section><section><h2 id="1446709650#chapter-2-installing-docker-on-windows" data-toc="chapter-2-installing-docker-on-windows#Getting-started-with-docker.md-chapter-2-installing-docker-on-windows">Chapter 2: Installing Docker on Windows</h2><section><h3 id="1446709650#2-1-docker-installation" data-toc="2-1-docker-installation#Getting-started-with-docker.md-2-1-docker-installation">2.1 Docker Installation</h3><ol class="list list-decimal" id="1446709650#-apd569_24" type="1" start="1"><li class="list-item" id="1446709650#-apd569_25"><p id="1446709650#-apd569_29">Download Docker Desktop from the Docker website (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li><li class="list-item" id="1446709650#-apd569_26"><p id="1446709650#-apd569_31">Run the installer and follow the on-screen instructions.</p></li><li class="list-item" id="1446709650#-apd569_27"><p id="1446709650#-apd569_32">After installation, launch Docker Desktop.</p></li><li class="list-item" id="1446709650#-apd569_28"><p id="1446709650#-apd569_33">Ensure Docker is running by opening a terminal and typing:</p><div class="detached code-block" id="1446709650#-apd569_34"><pre><code class="language-bash">docker --version</code></pre></div></li></ol></section></section><section><h2 id="1446709650#chapter-3-docker-basics" data-toc="chapter-3-docker-basics#Getting-started-with-docker.md-chapter-3-docker-basics">Chapter 3: Docker Basics</h2><section><h3 id="1446709650#3-1-docker-architecture" data-toc="3-1-docker-architecture#Getting-started-with-docker.md-3-1-docker-architecture">3.1 Docker Architecture</h3><ul class="list" id="1446709650#-apd569_38" start="1"><li class="list-item" id="1446709650#-apd569_39"><p><span class="control" id="1446709650#-apd569_44">Docker Client</span>: CLI to interact with Docker.</p></li><li class="list-item" id="1446709650#-apd569_40"><p><span class="control" id="1446709650#-apd569_45">Docker Daemon</span>: Runs on the host machine, manages Docker objects.</p></li><li class="list-item" id="1446709650#-apd569_41"><p><span class="control" id="1446709650#-apd569_46">Docker Images</span>: Read-only templates to create containers.</p></li><li class="list-item" id="1446709650#-apd569_42"><p><span class="control" id="1446709650#-apd569_47">Docker Containers</span>: Running instances of Docker images.</p></li><li class="list-item" id="1446709650#-apd569_43"><p><span class="control" id="1446709650#-apd569_48">Docker Registry</span>: Stores Docker images.</p></li></ul></section><section><h3 id="1446709650#3-2-hello-world-in-docker" data-toc="3-2-hello-world-in-docker#Getting-started-with-docker.md-3-2-hello-world-in-docker">3.2 Hello World in Docker</h3><ol class="list list-decimal" id="1446709650#-apd569_49" type="1" start="1"><li class="list-item" id="1446709650#-apd569_50"><p id="1446709650#-apd569_52">Open PowerShell or Command Prompt.</p></li><li class="list-item" id="1446709650#-apd569_51"><p id="1446709650#-apd569_53">Run your first container:</p><div class="detached code-block" id="1446709650#-apd569_54"><pre><code class="language-bash">docker run hello-world</code></pre></div></li></ol></section><section><h3 id="1446709650#3-3-docker-cli-basics" data-toc="3-3-docker-cli-basics#Getting-started-with-docker.md-3-3-docker-cli-basics">3.3 Docker CLI Basics</h3><ul class="list" id="1446709650#-apd569_55" start="1"><li class="list-item" id="1446709650#-apd569_56"><p id="1446709650#-apd569_58">List Docker CLI commands:</p><div class="detached code-block" id="1446709650#-apd569_59"><pre><code class="language-bash">docker</code></pre></div></li><li class="list-item" id="1446709650#-apd569_57"><p id="1446709650#-apd569_60">Get help on a command:</p><div class="detached code-block" id="1446709650#-apd569_61"><pre><code class="language-bash">docker &lt;command&gt; --help</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-4-working-with-docker-images" data-toc="chapter-4-working-with-docker-images#Getting-started-with-docker.md-chapter-4-working-with-docker-images">Chapter 4: Working with Docker Images</h2><section><h3 id="1446709650#4-1-pulling-images" data-toc="4-1-pulling-images#Getting-started-with-docker.md-4-1-pulling-images">4.1 Pulling Images</h3><ul class="list" id="1446709650#-apd569_65" start="1"><li class="list-item" id="1446709650#-apd569_66"><p id="1446709650#-apd569_67">Pull an image from Docker Hub:</p><div class="detached code-block" id="1446709650#-apd569_68"><pre><code class="language-bash">docker pull node</code></pre></div></li></ul></section><section><h3 id="1446709650#4-2-listing-images" data-toc="4-2-listing-images#Getting-started-with-docker.md-4-2-listing-images">4.2 Listing Images</h3><ul class="list" id="1446709650#-apd569_69" start="1"><li class="list-item" id="1446709650#-apd569_70"><p id="1446709650#-apd569_71">List all images on your system:</p><div class="detached code-block" id="1446709650#-apd569_72"><pre><code class="language-bash">docker images</code></pre></div></li></ul></section><section><h3 id="1446709650#4-3-removing-images" data-toc="4-3-removing-images#Getting-started-with-docker.md-4-3-removing-images">4.3 Removing Images</h3><ul class="list" id="1446709650#-apd569_73" start="1"><li class="list-item" id="1446709650#-apd569_74"><p id="1446709650#-apd569_75">Remove an image:</p><div class="detached code-block" id="1446709650#-apd569_76"><pre><code class="language-bash">docker rmi &lt;image_id&gt;</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-5-docker-containers" data-toc="chapter-5-docker-containers#Getting-started-with-docker.md-chapter-5-docker-containers">Chapter 5: Docker Containers</h2><section><h3 id="1446709650#5-1-running-containers" data-toc="5-1-running-containers#Getting-started-with-docker.md-5-1-running-containers">5.1 Running Containers</h3><ul class="list" id="1446709650#-apd569_81" start="1"><li class="list-item" id="1446709650#-apd569_82"><p id="1446709650#-apd569_84">Run a Node.js container interactively:</p><div class="detached code-block" id="1446709650#-apd569_85"><pre><code class="language-bash">docker run -it node /bin/bash</code></pre></div></li><li class="list-item" id="1446709650#-apd569_83"><p id="1446709650#-apd569_86">Run a container in the background:</p><div class="detached code-block" id="1446709650#-apd569_87"><pre><code class="language-bash">docker run -d node</code></pre></div></li></ul></section><section><h3 id="1446709650#5-2-listing-containers" data-toc="5-2-listing-containers#Getting-started-with-docker.md-5-2-listing-containers">5.2 Listing Containers</h3><ul class="list" id="1446709650#-apd569_88" start="1"><li class="list-item" id="1446709650#-apd569_89"><p id="1446709650#-apd569_91">List all running containers:</p><div class="detached code-block" id="1446709650#-apd569_92"><pre><code class="language-bash">docker ps</code></pre></div></li><li class="list-item" id="1446709650#-apd569_90"><p id="1446709650#-apd569_93">List all containers (including stopped):</p><div class="detached code-block" id="1446709650#-apd569_94"><pre><code class="language-bash">docker ps -a</code></pre></div></li></ul></section><section><h3 id="1446709650#5-3-stopping-containers" data-toc="5-3-stopping-containers#Getting-started-with-docker.md-5-3-stopping-containers">5.3 Stopping Containers</h3><ul class="list" id="1446709650#-apd569_95" start="1"><li class="list-item" id="1446709650#-apd569_96"><p id="1446709650#-apd569_97">Stop a running container:</p><div class="detached code-block" id="1446709650#-apd569_98"><pre><code class="language-bash">docker stop &lt;container_id&gt;</code></pre></div></li></ul></section><section><h3 id="1446709650#5-4-removing-containers" data-toc="5-4-removing-containers#Getting-started-with-docker.md-5-4-removing-containers">5.4 Removing Containers</h3><ul class="list" id="1446709650#-apd569_99" start="1"><li class="list-item" id="1446709650#-apd569_100"><p id="1446709650#-apd569_101">Remove a container:</p><div class="detached code-block" id="1446709650#-apd569_102"><pre><code class="language-bash">docker rm &lt;container_id&gt;</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-6-dockerfile" data-toc="chapter-6-dockerfile#Getting-started-with-docker.md-chapter-6-dockerfile">Chapter 6: Dockerfile</h2><section><h3 id="1446709650#6-1-introduction-to-dockerfile" data-toc="6-1-introduction-to-dockerfile#Getting-started-with-docker.md-6-1-introduction-to-dockerfile">6.1 Introduction to Dockerfile</h3><p id="1446709650#-apd569_107">A Dockerfile is a text document that contains instructions for building a Docker image.</p></section><section><h3 id="1446709650#6-2-creating-a-dockerfile-for-node-js" data-toc="6-2-creating-a-dockerfile-for-node-js#Getting-started-with-docker.md-6-2-creating-a-dockerfile-for-node-js">6.2 Creating a Dockerfile for Node.js</h3><ol class="list list-decimal" id="1446709650#-apd569_108" type="1" start="1"><li class="list-item" id="1446709650#-apd569_109"><p id="1446709650#-apd569_112">Create a directory for your Node.js application, e.g., <span class="inline-code" id="1446709650#-apd569_113">my-node-app</span>.</p></li><li class="list-item" id="1446709650#-apd569_110"><p id="1446709650#-apd569_114">Inside this directory, create a file named <span class="inline-code" id="1446709650#-apd569_115">Dockerfile</span>.</p></li><li class="list-item" id="1446709650#-apd569_111"><p id="1446709650#-apd569_116">Add the following content:</p><div class="detached code-block" id="1446709650#-apd569_117"><pre><code class="language-bash"># Use an official Node.js runtime as a parent image
FROM node:14

# Set the working directory in the container
WORKDIR /usr/src/app

# Copy package.json and package-lock.json
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy the rest of the application code
COPY . .

# Expose port 3000
EXPOSE 3000

# Command to run the application
CMD [&quot;node&quot;, &quot;index.js&quot;]</code></pre></div></li></ol></section><section><h3 id="1446709650#6-3-building-an-image" data-toc="6-3-building-an-image#Getting-started-with-docker.md-6-3-building-an-image">6.3 Building an Image</h3><ul class="list" id="1446709650#-apd569_118" start="1"><li class="list-item" id="1446709650#-apd569_119"><p id="1446709650#-apd569_120">Build an image from the Dockerfile:</p><div class="detached code-block" id="1446709650#-apd569_121"><pre><code class="language-bash">docker build -t my-node-app .</code></pre></div></li></ul></section><section><h3 id="1446709650#6-4-running-your-image" data-toc="6-4-running-your-image#Getting-started-with-docker.md-6-4-running-your-image">6.4 Running Your Image</h3><ul class="list" id="1446709650#-apd569_122" start="1"><li class="list-item" id="1446709650#-apd569_123"><p id="1446709650#-apd569_124">Run the image as a container:</p><div class="detached code-block" id="1446709650#-apd569_125"><pre><code class="language-bash">docker run -p 3000:3000 my-node-app</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-7-docker-volumes" data-toc="chapter-7-docker-volumes#Getting-started-with-docker.md-chapter-7-docker-volumes">Chapter 7: Docker Volumes</h2><section><h3 id="1446709650#7-1-introduction-to-volumes" data-toc="7-1-introduction-to-volumes#Getting-started-with-docker.md-7-1-introduction-to-volumes">7.1 Introduction to Volumes</h3><p id="1446709650#-apd569_129">Volumes are used to persist data generated by and used by Docker containers.</p></section><section><h3 id="1446709650#7-2-creating-volumes" data-toc="7-2-creating-volumes#Getting-started-with-docker.md-7-2-creating-volumes">7.2 Creating Volumes</h3><ul class="list" id="1446709650#-apd569_130" start="1"><li class="list-item" id="1446709650#-apd569_131"><p id="1446709650#-apd569_132">Create a volume:</p><div class="detached code-block" id="1446709650#-apd569_133"><pre><code class="language-bash">docker volume create my-volume</code></pre></div></li></ul></section><section><h3 id="1446709650#7-3-using-volumes" data-toc="7-3-using-volumes#Getting-started-with-docker.md-7-3-using-volumes">7.3 Using Volumes</h3><ul class="list" id="1446709650#-apd569_134" start="1"><li class="list-item" id="1446709650#-apd569_135"><p id="1446709650#-apd569_136">Use a volume in a container:</p><div class="detached code-block" id="1446709650#-apd569_137"><pre><code class="language-bash">docker run -d -v my-volume:/usr/src/app my-node-app</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-8-docker-compose" data-toc="chapter-8-docker-compose#Getting-started-with-docker.md-chapter-8-docker-compose">Chapter 8: Docker Compose</h2><section><h3 id="1446709650#8-1-introduction-to-docker-compose" data-toc="8-1-introduction-to-docker-compose#Getting-started-with-docker.md-8-1-introduction-to-docker-compose">8.1 Introduction to Docker Compose</h3><p id="1446709650#-apd569_141">Docker Compose is a tool for defining and running multi-container Docker applications.</p></section><section><h3 id="1446709650#8-2-creating-a-docker-compose-yml-for-node-js-and-react" data-toc="8-2-creating-a-docker-compose-yml-for-node-js-and-react#Getting-started-with-docker.md-8-2-creating-a-docker-compose-yml-for-node-js-and-react">8.2 Creating a docker-compose.yml for Node.js and React</h3><ol class="list list-decimal" id="1446709650#-apd569_143" type="1" start="1"><li class="list-item" id="1446709650#-apd569_145"><p id="1446709650#-apd569_147">In your project directory, create a file named <span class="inline-code" id="1446709650#-apd569_148">docker-compose.yml</span>.</p></li><li class="list-item" id="1446709650#-apd569_146"><p id="1446709650#-apd569_149">Add the following content:</p><div class="detached code-block" id="1446709650#-apd569_150"><pre><code class="language-yaml">version: '3'

services:
  web:
    image: my-node-app
    build: .
    ports:
      - &quot;3000:3000&quot;
    volumes:
      - .:/usr/src/app
    environment:
      - NODE_ENV=development
  client:
    image: node:14
    working_dir: /usr/src/app
    volumes:
      - ./client:/usr/src/app
    command: npm start
    ports:
      - &quot;3001:3001&quot;</code></pre></div></li></ol></section><section><h3 id="1446709650#8-3-running-docker-compose" data-toc="8-3-running-docker-compose#Getting-started-with-docker.md-8-3-running-docker-compose">8.3 Running Docker Compose</h3><ul class="list" id="1446709650#-apd569_151" start="1"><li class="list-item" id="1446709650#-apd569_152"><p id="1446709650#-apd569_154">Start your application:</p><div class="detached code-block" id="1446709650#-apd569_155"><pre><code class="language-bash">docker-compose up</code></pre></div></li><li class="list-item" id="1446709650#-apd569_153"><p id="1446709650#-apd569_156">Stop your application:</p><div class="detached code-block" id="1446709650#-apd569_157"><pre><code class="language-bash">docker-compose down</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-9-docker-networking" data-toc="chapter-9-docker-networking#Getting-started-with-docker.md-chapter-9-docker-networking">Chapter 9: Docker Networking</h2><section><h3 id="1446709650#9-1-introduction-to-docker-networking" data-toc="9-1-introduction-to-docker-networking#Getting-started-with-docker.md-9-1-introduction-to-docker-networking">9.1 Introduction to Docker Networking</h3><p id="1446709650#-apd569_163">Docker provides a networking model to allow containers to communicate with each other and with non-Docker workloads.</p></section><section><h3 id="1446709650#9-2-listing-networks" data-toc="9-2-listing-networks#Getting-started-with-docker.md-9-2-listing-networks">9.2 Listing Networks</h3><ul class="list" id="1446709650#-apd569_164" start="1"><li class="list-item" id="1446709650#-apd569_165"><p id="1446709650#-apd569_166">List all Docker networks:</p><div class="detached code-block" id="1446709650#-apd569_167"><pre><code class="language-bash">docker network ls</code></pre></div></li></ul></section><section><h3 id="1446709650#9-3-creating-a-network" data-toc="9-3-creating-a-network#Getting-started-with-docker.md-9-3-creating-a-network">9.3 Creating a Network</h3><ul class="list" id="1446709650#-apd569_168" start="1"><li class="list-item" id="1446709650#-apd569_169"><p id="1446709650#-apd569_170">Create a custom network:</p><div class="detached code-block" id="1446709650#-apd569_171"><pre><code class="language-bash">docker network create my-network</code></pre></div></li></ul></section><section><h3 id="1446709650#9-4-connecting-containers-to-a-network" data-toc="9-4-connecting-containers-to-a-network#Getting-started-with-docker.md-9-4-connecting-containers-to-a-network">9.4 Connecting Containers to a Network</h3><ul class="list" id="1446709650#-apd569_172" start="1"><li class="list-item" id="1446709650#-apd569_173"><p id="1446709650#-apd569_174">Connect a container to a network:</p><div class="detached code-block" id="1446709650#-apd569_175"><pre><code class="language-bash">docker network connect my-network &lt;container_id&gt;</code></pre></div></li></ul></section><section><h3 id="1446709650#9-5-disconnecting-containers-from-a-network" data-toc="9-5-disconnecting-containers-from-a-network#Getting-started-with-docker.md-9-5-disconnecting-containers-from-a-network">9.5 Disconnecting Containers from a Network</h3><ul class="list" id="1446709650#-apd569_176" start="1"><li class="list-item" id="1446709650#-apd569_177"><p id="1446709650#-apd569_178">Disconnect a container from a network:</p><div class="detached code-block" id="1446709650#-apd569_179"><pre><code class="language-bash">docker network disconnect my-network &lt;container_id&gt;</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-10-docker-swarm" data-toc="chapter-10-docker-swarm#Getting-started-with-docker.md-chapter-10-docker-swarm">Chapter 10: Docker Swarm</h2><section><h3 id="1446709650#10-1-introduction-to-docker-swarm" data-toc="10-1-introduction-to-docker-swarm#Getting-started-with-docker.md-10-1-introduction-to-docker-swarm">10.1 Introduction to Docker Swarm</h3><p id="1446709650#-apd569_186">Docker Swarm is a container orchestration tool that allows you to manage a cluster of Docker nodes.</p></section><section><h3 id="1446709650#10-2-initializing-a-swarm" data-toc="10-2-initializing-a-swarm#Getting-started-with-docker.md-10-2-initializing-a-swarm">10.2 Initializing a Swarm</h3><ul class="list" id="1446709650#-apd569_187" start="1"><li class="list-item" id="1446709650#-apd569_188"><p id="1446709650#-apd569_189">Initialize a swarm:</p><div class="detached code-block" id="1446709650#-apd569_190"><pre><code class="language-bash">docker swarm init</code></pre></div></li></ul></section><section><h3 id="1446709650#10-3-joining-a-swarm" data-toc="10-3-joining-a-swarm#Getting-started-with-docker.md-10-3-joining-a-swarm">10.3 Joining a Swarm</h3><ul class="list" id="1446709650#-apd569_191" start="1"><li class="list-item" id="1446709650#-apd569_192"><p id="1446709650#-apd569_193">Get the join command from the manager node and run it on the worker node:</p><div class="detached code-block" id="1446709650#-apd569_194"><pre><code class="language-bash">docker swarm join --token &lt;token&gt; &lt;manager_ip&gt;:2377</code></pre></div></li></ul></section><section><h3 id="1446709650#10-4-deploying-a-service" data-toc="10-4-deploying-a-service#Getting-started-with-docker.md-10-4-deploying-a-service">10.4 Deploying a Service</h3><ul class="list" id="1446709650#-apd569_195" start="1"><li class="list-item" id="1446709650#-apd569_196"><p id="1446709650#-apd569_197">Deploy a service in the swarm:</p><div class="detached code-block" id="1446709650#-apd569_198"><pre><code class="language-bash">docker service create --name my-web-service -p 3000:3000 my-node-app</code></pre></div></li></ul></section><section><h3 id="1446709650#10-5-listing-services" data-toc="10-5-listing-services#Getting-started-with-docker.md-10-5-listing-services">10.5 Listing Services</h3><ul class="list" id="1446709650#-apd569_199" start="1"><li class="list-item" id="1446709650#-apd569_200"><p id="1446709650#-apd569_201">List all services in the swarm:</p><div class="detached code-block" id="1446709650#-apd569_202"><pre><code class="language-bash">docker service ls</code></pre></div></li></ul></section><section><h3 id="1446709650#10-6-removing-a-service" data-toc="10-6-removing-a-service#Getting-started-with-docker.md-10-6-removing-a-service">10.6 Removing a Service</h3><ul class="list" id="1446709650#-apd569_203" start="1"><li class="list-item" id="1446709650#-apd569_204"><p id="1446709650#-apd569_205">Remove a service:</p><div class="detached code-block" id="1446709650#-apd569_206"><pre><code class="language-bash">docker service rm my-web-service</code></pre></div></li></ul></section></section><section><h2 id="1446709650#chapter-11-docker-best-practices" data-toc="chapter-11-docker-best-practices#Getting-started-with-docker.md-chapter-11-docker-best-practices">Chapter 11: Docker Best Practices</h2><section><h3 id="1446709650#11-1-writing-efficient-dockerfiles" data-toc="11-1-writing-efficient-dockerfiles#Getting-started-with-docker.md-11-1-writing-efficient-dockerfiles">11.1 Writing Efficient Dockerfiles</h3><ul class="list" id="1446709650#-apd569_210" start="1"><li class="list-item" id="1446709650#-apd569_211"><p>Use official images as a base.</p></li><li class="list-item" id="1446709650#-apd569_212"><p>Minimize the number of layers.</p></li><li class="list-item" id="1446709650#-apd569_213"><p>Use multi-stage builds for optimized images.</p></li></ul></section><section><h3 id="1446709650#11-2-managing-secrets" data-toc="11-2-managing-secrets#Getting-started-with-docker.md-11-2-managing-secrets">11.2 Managing Secrets</h3><ul class="list" id="1446709650#-apd569_214" start="1"><li class="list-item" id="1446709650#-apd569_215"><p id="1446709650#-apd569_216">Use Docker secrets to manage sensitive data:</p><div class="detached code-block" id="1446709650#-apd569_217"><pre><code class="language-bash">echo &quot;my_secret_password&quot; | docker secret create my_secret -</code></pre></div></li></ul></section><section><h3 id="1446709650#11-3-security-practices" data-toc="11-3-security-practices#Getting-started-with-docker.md-11-3-security-practices">11.3 Security Practices</h3><ul class="list" id="1446709650#-apd569_218" start="1"><li class="list-item" id="1446709650#-apd569_219"><p>Run containers as a non-root user.</p></li><li class="list-item" id="1446709650#-apd569_220"><p>Keep the host and Docker up to date.</p></li></ul></section></section><section><h2 id="1446709650#chapter-12-advanced-topics" data-toc="chapter-12-advanced-topics#Getting-started-with-docker.md-chapter-12-advanced-topics">Chapter 12: Advanced Topics</h2><section><h3 id="1446709650#12-1-docker-with-kubernetes" data-toc="12-1-docker-with-kubernetes#Getting-started-with-docker.md-12-1-docker-with-kubernetes">12.1 Docker with Kubernetes</h3><ul class="list" id="1446709650#-apd569_223" start="1"><li class="list-item" id="1446709650#-apd569_224"><p>Install and configure Kubernetes.</p></li><li class="list-item" id="1446709650#-apd569_225"><p>Deploy Docker containers using Kubernetes.</p></li></ul></section><section><h3 id="1446709650#12-2-ci-cd-with-docker" data-toc="12-2-ci-cd-with-docker#Getting-started-with-docker.md-12-2-ci-cd-with-docker">12.2 CI/CD with Docker</h3><ul class="list" id="1446709650#-apd569_226" start="1"><li class="list-item" id="1446709650#-apd569_227"><p id="1446709650#-apd569_229">Use Docker in your CI/CD pipeline.</p></li><li class="list-item" id="1446709650#-apd569_228"><p id="1446709650#-apd569_230">Example with Jenkins:</p><div class="detached code-block" id="1446709650#-apd569_231"><pre><code class="language-groovy">pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                script {
                    dockerImage = docker.build(&quot;my-node-app&quot;)
                }
            }
        }
        stage('Test') {
            steps {
                script {
                    dockerImage.inside {
                        sh 'npm test'
                    }
                }
            }
        }
        stage('Deploy') {
            steps {
                script {
                    dockerImage.push('my-repo/my-node-app')
                }
            }
        }
    }
}</code></pre></div></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2101908822">Dockerizing MongoDB</h1><section><h2 id="2101908822#chapter-1-introduction" data-toc="chapter-1-introduction#Dockerizing-MongoDB.md-chapter-1-introduction">Chapter 1: Introduction</h2><p id="2101908822#bptw7f_10">This guide will walk you through the steps of Dockerizing MongoDB, setting up a user with specific credentials, persisting data using Docker volumes, and performing basic CRUD (Create, Read, Update, Delete) operations. We will cover everything from pulling the MongoDB image to running queries.</p></section><section><h2 id="2101908822#chapter-2-setting-up-docker" data-toc="chapter-2-setting-up-docker#Dockerizing-MongoDB.md-chapter-2-setting-up-docker">Chapter 2: Setting Up Docker</h2><section><h3 id="2101908822#2-1-installing-docker-on-windows" data-toc="2-1-installing-docker-on-windows#Dockerizing-MongoDB.md-2-1-installing-docker-on-windows">2.1 Installing Docker on Windows</h3><ol class="list list-decimal" id="2101908822#bptw7f_12" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_13"><p id="2101908822#bptw7f_17">Download Docker Desktop from the Docker website (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li><li class="list-item" id="2101908822#bptw7f_14"><p id="2101908822#bptw7f_19">Run the installer and follow the instructions.</p></li><li class="list-item" id="2101908822#bptw7f_15"><p id="2101908822#bptw7f_20">After installation, start Docker Desktop.</p></li><li class="list-item" id="2101908822#bptw7f_16"><p id="2101908822#bptw7f_21">Verify the installation:</p><div class="detached code-block" id="2101908822#bptw7f_22"><pre><code class="language-bash">docker --version</code></pre></div></li></ol></section></section><section><h2 id="2101908822#chapter-3-dockerizing-mongodb" data-toc="chapter-3-dockerizing-mongodb#Dockerizing-MongoDB.md-chapter-3-dockerizing-mongodb">Chapter 3: Dockerizing MongoDB</h2><section><h3 id="2101908822#3-1-pulling-the-mongodb-image" data-toc="3-1-pulling-the-mongodb-image#Dockerizing-MongoDB.md-3-1-pulling-the-mongodb-image">3.1 Pulling the MongoDB Image</h3><ul class="list" id="2101908822#bptw7f_26" start="1"><li class="list-item" id="2101908822#bptw7f_27"><p id="2101908822#bptw7f_28">Open a command prompt and run the following command to pull the official MongoDB image:</p><div class="detached code-block" id="2101908822#bptw7f_29"><pre><code class="language-bash">docker pull mongo</code></pre></div></li></ul></section><section><h3 id="2101908822#3-2-creating-a-docker-volume" data-toc="3-2-creating-a-docker-volume#Dockerizing-MongoDB.md-3-2-creating-a-docker-volume">3.2 Creating a Docker Volume</h3><ul class="list" id="2101908822#bptw7f_30" start="1"><li class="list-item" id="2101908822#bptw7f_31"><p id="2101908822#bptw7f_32">Create a volume to persist MongoDB data:</p><div class="detached code-block" id="2101908822#bptw7f_33"><pre><code class="language-bash">docker volume create mongodb-data</code></pre></div></li></ul></section><section><h3 id="2101908822#3-3-running-mongodb-container-with-authentication-and-persistent-storage" data-toc="3-3-running-mongodb-container-with-authentication-and-persistent-storage#Dockerizing-MongoDB.md-3-3-running-mongodb-container-with-authentication-and-persistent-storage">3.3 Running MongoDB Container with Authentication and Persistent Storage</h3><ul class="list" id="2101908822#bptw7f_34" start="1"><li class="list-item" id="2101908822#bptw7f_35"><p id="2101908822#bptw7f_37">Run the MongoDB container with environment variables to set the username and password, and use the volume for data persistence:</p><div class="detached code-block" id="2101908822#bptw7f_38"><pre><code class="language-bash">docker run --name mongodb_container -d -p 27017:27017 -e MONGO_INITDB_ROOT_USERNAME=admin -e MONGO_INITDB_ROOT_PASSWORD=pass -v mongodb-data:/data/db mongo</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_36"><p id="2101908822#bptw7f_39">Verify the container is running:</p><div class="detached code-block" id="2101908822#bptw7f_40"><pre><code class="language-bash">docker ps</code></pre></div></li></ul></section></section><section><h2 id="2101908822#chapter-4-connecting-to-mongodb" data-toc="chapter-4-connecting-to-mongodb#Dockerizing-MongoDB.md-chapter-4-connecting-to-mongodb">Chapter 4: Connecting to MongoDB</h2><section><h3 id="2101908822#4-1-using-mongodb-shell" data-toc="4-1-using-mongodb-shell#Dockerizing-MongoDB.md-4-1-using-mongodb-shell">4.1 Using MongoDB Shell</h3><p id="2101908822#bptw7f_42">You have two options to connect to MongoDB shell:</p><section><h4 id="2101908822#option-1-direct-command" data-toc="option-1-direct-command#Dockerizing-MongoDB.md-option-1-direct-command">Option 1: Direct Command</h4><ul class="list" id="2101908822#bptw7f_45" start="1"><li class="list-item" id="2101908822#bptw7f_46"><p id="2101908822#bptw7f_47">Start the MongoDB shell directly:</p><div class="detached code-block" id="2101908822#bptw7f_48"><pre><code class="language-bash">docker exec -it mongodb_container bash -c 'mongosh -u admin -p pass --authenticationDatabase admin'</code></pre></div></li></ul></section><section><h4 id="2101908822#option-2-entering-the-container-first" data-toc="option-2-entering-the-container-first#Dockerizing-MongoDB.md-option-2-entering-the-container-first">Option 2: Entering the Container First</h4><ol class="list list-decimal" id="2101908822#bptw7f_49" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_50"><p id="2101908822#bptw7f_54">Start a bash shell inside the running MongoDB container:</p><div class="detached code-block" id="2101908822#bptw7f_55"><pre><code class="language-bash">docker exec -it mongodb_container /bin/bash</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_51"><p id="2101908822#bptw7f_56">Once inside the container, start the MongoDB shell:</p><div class="detached code-block" id="2101908822#bptw7f_57"><pre><code class="language-bash">mongosh -u admin -p pass --authenticationDatabase admin</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_52"><p id="2101908822#bptw7f_58">You should now be in the MongoDB shell:</p><div class="detached code-block" id="2101908822#bptw7f_59"><pre><code class="language-bash">&gt;</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_53"><p id="2101908822#bptw7f_60">List all databases:</p><div class="detached code-block" id="2101908822#bptw7f_61"><pre><code class="language-bash">&gt; show databases</code></pre></div></li></ol></section></section></section><section><h2 id="2101908822#chapter-5-crud-operations" data-toc="chapter-5-crud-operations#Dockerizing-MongoDB.md-chapter-5-crud-operations">Chapter 5: CRUD Operations</h2><section><h3 id="2101908822#5-1-creating-a-database-and-collection" data-toc="5-1-creating-a-database-and-collection#Dockerizing-MongoDB.md-5-1-creating-a-database-and-collection">5.1 Creating a Database and Collection</h3><ol class="list list-decimal" id="2101908822#bptw7f_67" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_68"><p id="2101908822#bptw7f_70">Create a new database called <span class="inline-code" id="2101908822#bptw7f_72">mydatabase</span>:</p><div class="detached code-block" id="2101908822#bptw7f_71"><pre><code class="language-bash">use mydatabase</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_69"><p id="2101908822#bptw7f_73">Create a new collection called <span class="inline-code" id="2101908822#bptw7f_75">mycollection</span>:</p><div class="detached code-block" id="2101908822#bptw7f_74"><pre><code class="language-bash">db.createCollection(&quot;mycollection&quot;)</code></pre></div></li></ol></section><section><h3 id="2101908822#5-2-create-insert-documents" data-toc="5-2-create-insert-documents#Dockerizing-MongoDB.md-5-2-create-insert-documents">5.2 Create (Insert) Documents</h3><ol class="list list-decimal" id="2101908822#bptw7f_76" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_77"><p id="2101908822#bptw7f_79">Insert a single document into <span class="inline-code" id="2101908822#bptw7f_81">mycollection</span>:</p><div class="detached code-block" id="2101908822#bptw7f_80"><pre><code class="language-bash">db.mycollection.insertOne({ name: &quot;John Doe&quot;, age: 30, occupation: &quot;Engineer&quot; })</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_78"><p id="2101908822#bptw7f_82">Insert multiple documents:</p><div class="detached code-block" id="2101908822#bptw7f_83"><pre><code class="language-bash">db.mycollection.insertMany([
  { name: &quot;Jane Doe&quot;, age: 25, occupation: &quot;Teacher&quot; },
  { name: &quot;Steve Smith&quot;, age: 40, occupation: &quot;Chef&quot; }
])</code></pre></div></li></ol></section><section><h3 id="2101908822#5-3-read-query-documents" data-toc="5-3-read-query-documents#Dockerizing-MongoDB.md-5-3-read-query-documents">5.3 Read (Query) Documents</h3><ol class="list list-decimal" id="2101908822#bptw7f_84" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_85"><p id="2101908822#bptw7f_88">Find one document:</p><div class="detached code-block" id="2101908822#bptw7f_89"><pre><code class="language-bash">db.mycollection.findOne({ name: &quot;John Doe&quot; })</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_86"><p id="2101908822#bptw7f_90">Find all documents:</p><div class="detached code-block" id="2101908822#bptw7f_91"><pre><code class="language-bash">db.mycollection.find()</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_87"><p id="2101908822#bptw7f_92">Find documents with a condition:</p><div class="detached code-block" id="2101908822#bptw7f_93"><pre><code class="language-bash">db.mycollection.find({ age: { $gt: 30 } })</code></pre></div></li></ol></section><section><h3 id="2101908822#5-4-update-documents" data-toc="5-4-update-documents#Dockerizing-MongoDB.md-5-4-update-documents">5.4 Update Documents</h3><ol class="list list-decimal" id="2101908822#bptw7f_94" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_95"><p id="2101908822#bptw7f_97">Update a single document:</p><div class="detached code-block" id="2101908822#bptw7f_98"><pre><code class="language-bash">db.mycollection.updateOne({ name: &quot;John Doe&quot; }, { $set: { age: 31 } })</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_96"><p id="2101908822#bptw7f_99">Update multiple documents:</p><div class="detached code-block" id="2101908822#bptw7f_100"><pre><code class="language-bash">db.mycollection.updateMany({ occupation: &quot;Chef&quot; }, { $set: { occupation: &quot;Head Chef&quot; } })</code></pre></div></li></ol></section><section><h3 id="2101908822#5-5-delete-documents" data-toc="5-5-delete-documents#Dockerizing-MongoDB.md-5-5-delete-documents">5.5 Delete Documents</h3><ol class="list list-decimal" id="2101908822#bptw7f_101" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_102"><p id="2101908822#bptw7f_104">Delete a single document:</p><div class="detached code-block" id="2101908822#bptw7f_105"><pre><code class="language-bash">db.mycollection.deleteOne({ name: &quot;John Doe&quot; })</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_103"><p id="2101908822#bptw7f_106">Delete multiple documents:</p><div class="detached code-block" id="2101908822#bptw7f_107"><pre><code class="language-bash">db.mycollection.deleteMany({ age: { $lt: 30 } })</code></pre></div></li></ol></section></section><section><h2 id="2101908822#chapter-6-accessing-mongodb-from-an-application" data-toc="chapter-6-accessing-mongodb-from-an-application#Dockerizing-MongoDB.md-chapter-6-accessing-mongodb-from-an-application">Chapter 6: Accessing MongoDB from an Application</h2><section><h3 id="2101908822#6-1-using-mongodb-with-node-js" data-toc="6-1-using-mongodb-with-node-js#Dockerizing-MongoDB.md-6-1-using-mongodb-with-node-js">6.1 Using MongoDB with Node.js</h3><ol class="list list-decimal" id="2101908822#bptw7f_109" type="1" start="1"><li class="list-item" id="2101908822#bptw7f_110"><p id="2101908822#bptw7f_116">Install Node.js from the official website (<a href="https://nodejs.org/">https://nodejs.org/</a>).</p></li><li class="list-item" id="2101908822#bptw7f_111"><p id="2101908822#bptw7f_118">Create a new project directory and navigate into it:</p><div class="detached code-block" id="2101908822#bptw7f_119"><pre><code class="language-bash">mkdir my-mongo-app
cd my-mongo-app</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_112"><p id="2101908822#bptw7f_120">Initialize a new Node.js project:</p><div class="detached code-block" id="2101908822#bptw7f_121"><pre><code class="language-bash">npm init -y</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_113"><p id="2101908822#bptw7f_122">Install the MongoDB driver:</p><div class="detached code-block" id="2101908822#bptw7f_123"><pre><code class="language-bash">npm install mongodb</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_114"><p id="2101908822#bptw7f_124">Create an <span class="inline-code" id="2101908822#bptw7f_126">index.js</span> file and add the following code:</p><div class="detached code-block" id="2101908822#bptw7f_125"><pre><code class="language-javascript">const { MongoClient } = require('mongodb');

async function main() {
  const uri = &quot;mongodb://admin:pass@localhost:27017/?authSource=admin&quot;;
  const client = new MongoClient(uri);

  try {
    await client.connect();

    const database = client.db('mydatabase');
    const collection = database.collection('mycollection');

    // Insert a document
    const insertResult = await collection.insertOne({ name: &quot;Alice&quot;, age: 28, occupation: &quot;Designer&quot; });
    console.log('Inserted document:', insertResult.insertedId);

    // Find a document
    const findResult = await collection.findOne({ name: &quot;Alice&quot; });
    console.log('Found document:', findResult);

    // Update a document
    const updateResult = await collection.updateOne({ name: &quot;Alice&quot; }, { $set: { age: 29 } });
    console.log('Updated document:', updateResult.modifiedCount);

    // Delete a document
    const deleteResult = await collection.deleteOne({ name: &quot;Alice&quot; });
    console.log('Deleted document:', deleteResult.deletedCount);
  } finally {
    await client.close();
  }
}

main().catch(console.error);</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_115"><p id="2101908822#bptw7f_127">Run the application:</p><div class="detached code-block" id="2101908822#bptw7f_128"><pre><code class="language-bash">node index.js</code></pre></div></li></ol></section></section><section><h2 id="2101908822#chapter-7-cleaning-up" data-toc="chapter-7-cleaning-up#Dockerizing-MongoDB.md-chapter-7-cleaning-up">Chapter 7: Cleaning Up</h2><section><h3 id="2101908822#7-1-stopping-and-removing-the-mongodb-container" data-toc="7-1-stopping-and-removing-the-mongodb-container#Dockerizing-MongoDB.md-7-1-stopping-and-removing-the-mongodb-container">7.1 Stopping and Removing the MongoDB Container</h3><ul class="list" id="2101908822#bptw7f_132" start="1"><li class="list-item" id="2101908822#bptw7f_133"><p id="2101908822#bptw7f_135">Stop the container:</p><div class="detached code-block" id="2101908822#bptw7f_136"><pre><code class="language-bash">docker stop mongodb_container</code></pre></div></li><li class="list-item" id="2101908822#bptw7f_134"><p id="2101908822#bptw7f_137">Remove the container:</p><div class="detached code-block" id="2101908822#bptw7f_138"><pre><code class="language-bash">docker rm mongodb_container</code></pre></div></li></ul></section><section><h3 id="2101908822#7-2-removing-the-mongodb-image" data-toc="7-2-removing-the-mongodb-image#Dockerizing-MongoDB.md-7-2-removing-the-mongodb-image">7.2 Removing the MongoDB Image</h3><ul class="list" id="2101908822#bptw7f_139" start="1"><li class="list-item" id="2101908822#bptw7f_140"><p id="2101908822#bptw7f_141">Remove the MongoDB image:</p><div class="detached code-block" id="2101908822#bptw7f_142"><pre><code class="language-bash">docker rmi mongo</code></pre></div></li></ul></section><section><h3 id="2101908822#7-3-removing-the-docker-volume" data-toc="7-3-removing-the-docker-volume#Dockerizing-MongoDB.md-7-3-removing-the-docker-volume">7.3 Removing the Docker Volume</h3><ul class="list" id="2101908822#bptw7f_143" start="1"><li class="list-item" id="2101908822#bptw7f_144"><p id="2101908822#bptw7f_145">Remove the Docker volume:</p><div class="detached code-block" id="2101908822#bptw7f_146"><pre><code class="language-bash">docker volume rm mongodb-data</code></pre></div></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-360695856">Dockerizing PostgreSQL</h1><section><h2 id="-360695856#chapter-1-introduction" data-toc="chapter-1-introduction#Dockerizing-PostgreSQL.md-chapter-1-introduction">Chapter 1: Introduction</h2><p id="-360695856#z324mvt_10">This guide will walk you through the steps of Dockerizing PostgreSQL, setting up a user with specific credentials, persisting data using Docker volumes, and performing basic CRUD (Create, Read, Update, Delete) operations. We will cover everything from pulling the PostgreSQL image to running queries.</p></section><section><h2 id="-360695856#chapter-2-setting-up-docker" data-toc="chapter-2-setting-up-docker#Dockerizing-PostgreSQL.md-chapter-2-setting-up-docker">Chapter 2: Setting Up Docker</h2><section><h3 id="-360695856#2-1-installing-docker-on-windows" data-toc="2-1-installing-docker-on-windows#Dockerizing-PostgreSQL.md-2-1-installing-docker-on-windows">2.1 Installing Docker on Windows</h3><ol class="list list-decimal" id="-360695856#z324mvt_12" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_13"><p id="-360695856#z324mvt_17">Download Docker Desktop from the Docker website (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li><li class="list-item" id="-360695856#z324mvt_14"><p id="-360695856#z324mvt_19">Run the installer and follow the instructions.</p></li><li class="list-item" id="-360695856#z324mvt_15"><p id="-360695856#z324mvt_20">After installation, start Docker Desktop.</p></li><li class="list-item" id="-360695856#z324mvt_16"><p id="-360695856#z324mvt_21">Verify the installation:</p><div class="detached code-block" id="-360695856#z324mvt_22"><pre><code class="language-bash">docker --version</code></pre></div></li></ol></section></section><section><h2 id="-360695856#chapter-3-dockerizing-postgresql" data-toc="chapter-3-dockerizing-postgresql#Dockerizing-PostgreSQL.md-chapter-3-dockerizing-postgresql">Chapter 3: Dockerizing PostgreSQL</h2><section><h3 id="-360695856#3-1-pulling-the-postgresql-image" data-toc="3-1-pulling-the-postgresql-image#Dockerizing-PostgreSQL.md-3-1-pulling-the-postgresql-image">3.1 Pulling the PostgreSQL Image</h3><ul class="list" id="-360695856#z324mvt_26" start="1"><li class="list-item" id="-360695856#z324mvt_27"><p id="-360695856#z324mvt_28">Open a command prompt and run the following command to pull the official PostgreSQL image:</p><div class="detached code-block" id="-360695856#z324mvt_29"><pre><code class="language-bash">docker pull postgres</code></pre></div></li></ul></section><section><h3 id="-360695856#3-2-creating-a-docker-volume" data-toc="3-2-creating-a-docker-volume#Dockerizing-PostgreSQL.md-3-2-creating-a-docker-volume">3.2 Creating a Docker Volume</h3><ul class="list" id="-360695856#z324mvt_30" start="1"><li class="list-item" id="-360695856#z324mvt_31"><p id="-360695856#z324mvt_32">Create a volume to persist PostgreSQL data:</p><div class="detached code-block" id="-360695856#z324mvt_33"><pre><code class="language-bash">docker volume create postgres-data</code></pre></div></li></ul></section><section><h3 id="-360695856#3-3-running-postgresql-container-with-authentication-and-persistent-storage" data-toc="3-3-running-postgresql-container-with-authentication-and-persistent-storage#Dockerizing-PostgreSQL.md-3-3-running-postgresql-container-with-authentication-and-persistent-storage">3.3 Running PostgreSQL Container with Authentication and Persistent Storage</h3><ul class="list" id="-360695856#z324mvt_34" start="1"><li class="list-item" id="-360695856#z324mvt_35"><p id="-360695856#z324mvt_37">Run the PostgreSQL container with environment variables to set the username and password, and use the volume for data persistence:</p><div class="detached code-block" id="-360695856#z324mvt_38"><pre><code class="language-bash">docker run --name postgres_container -d -p 5432:5432 -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=pass -v postgres-data:/var/lib/postgresql/data postgres</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_36"><p id="-360695856#z324mvt_39">Verify the container is running:</p><div class="detached code-block" id="-360695856#z324mvt_40"><pre><code class="language-bash">docker ps</code></pre></div></li></ul></section></section><section><h2 id="-360695856#chapter-4-connecting-to-postgresql" data-toc="chapter-4-connecting-to-postgresql#Dockerizing-PostgreSQL.md-chapter-4-connecting-to-postgresql">Chapter 4: Connecting to PostgreSQL</h2><section><h3 id="-360695856#4-1-using-psql-shell" data-toc="4-1-using-psql-shell#Dockerizing-PostgreSQL.md-4-1-using-psql-shell">4.1 Using psql Shell</h3><p id="-360695856#z324mvt_42">You have two options to connect to the PostgreSQL shell:</p><section><h4 id="-360695856#option-1-direct-command" data-toc="option-1-direct-command#Dockerizing-PostgreSQL.md-option-1-direct-command">Option 1: Direct Command</h4><ul class="list" id="-360695856#z324mvt_45" start="1"><li class="list-item" id="-360695856#z324mvt_46"><p id="-360695856#z324mvt_47">Start the PostgreSQL shell directly:</p><div class="detached code-block" id="-360695856#z324mvt_48"><pre><code class="language-bash">docker exec -it postgres_container psql -U admin</code></pre></div></li></ul></section><section><h4 id="-360695856#option-2-entering-the-container-first" data-toc="option-2-entering-the-container-first#Dockerizing-PostgreSQL.md-option-2-entering-the-container-first">Option 2: Entering the Container First</h4><ol class="list list-decimal" id="-360695856#z324mvt_49" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_51"><p id="-360695856#z324mvt_56">Start a bash shell inside the running PostgreSQL container:</p><div class="detached code-block" id="-360695856#z324mvt_57"><pre><code class="language-bash">docker exec -it postgres_container /bin/bash</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_52"><p id="-360695856#z324mvt_58">Once inside the container, start the PostgreSQL shell:</p><div class="detached code-block" id="-360695856#z324mvt_59"><pre><code class="language-bash">psql -U admin</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_53"><p id="-360695856#z324mvt_60">You should now be in the PostgreSQL shell:</p><div class="detached code-block" id="-360695856#z324mvt_61"><pre><code class="language-bash">admin=#</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_54"><p id="-360695856#z324mvt_62">In the PostgreSQL shell (psql), you can list all databases using the following command:</p><ul class="list" id="-360695856#z324mvt_63" start="1"><li class="list-item" id="-360695856#z324mvt_67"><p>List All Databases</p></li></ul><div class="detached code-block" id="-360695856#z324mvt_64"><pre><code class="language-bash">\l</code></pre></div><ul class="list" id="-360695856#z324mvt_65" start="1"><li class="list-item" id="-360695856#z324mvt_68"><p>or</p></li></ul><div class="detached code-block" id="-360695856#z324mvt_66"><pre><code class="language-bash">\list</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_55"><p id="-360695856#z324mvt_69">Additional Useful Commands</p></li></ol><ul class="list" id="-360695856#z324mvt_50" start="1"><li class="list-item" id="-360695856#z324mvt_70"><p id="-360695856#z324mvt_74">List all tables in the current database:</p><div class="detached code-block" id="-360695856#z324mvt_75"><pre><code class="language-bash">\dt</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_71"><p id="-360695856#z324mvt_76">List all schemas in the current database:</p><div class="detached code-block" id="-360695856#z324mvt_77"><pre><code class="language-bash">\dn</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_72"><p id="-360695856#z324mvt_78">List all users:</p><div class="detached code-block" id="-360695856#z324mvt_79"><pre><code class="language-bash">\du</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_73"><p id="-360695856#z324mvt_80">List all indexes:</p><div class="detached code-block" id="-360695856#z324mvt_81"><pre><code class="language-bash">\di</code></pre></div></li></ul></section></section></section><section><h2 id="-360695856#chapter-5-crud-operations" data-toc="chapter-5-crud-operations#Dockerizing-PostgreSQL.md-chapter-5-crud-operations">Chapter 5: CRUD Operations</h2><section><h3 id="-360695856#5-1-creating-a-database-and-table" data-toc="5-1-creating-a-database-and-table#Dockerizing-PostgreSQL.md-5-1-creating-a-database-and-table">5.1 Creating a Database and Table</h3><ol class="list list-decimal" id="-360695856#z324mvt_87" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_88"><p id="-360695856#z324mvt_91">Create a new database called <span class="inline-code" id="-360695856#z324mvt_93">mydatabase</span>:</p><div class="detached code-block" id="-360695856#z324mvt_92"><pre><code class="language-sql">CREATE DATABASE mydatabase;</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_89"><p id="-360695856#z324mvt_94">Connect to the new database:</p><div class="detached code-block" id="-360695856#z324mvt_95"><pre><code class="language-sql">\c mydatabase</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_90"><p id="-360695856#z324mvt_96">Create a new table called <span class="inline-code" id="-360695856#z324mvt_98">mytable</span>:</p><div class="detached code-block" id="-360695856#z324mvt_97"><pre><code class="language-sql">CREATE TABLE mytable (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    age INT,
    occupation VARCHAR(100)
);</code></pre></div></li></ol></section><section><h3 id="-360695856#5-2-create-insert-records" data-toc="5-2-create-insert-records#Dockerizing-PostgreSQL.md-5-2-create-insert-records">5.2 Create (Insert) Records</h3><ol class="list list-decimal" id="-360695856#z324mvt_99" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_100"><p id="-360695856#z324mvt_102">Insert a single record into <span class="inline-code" id="-360695856#z324mvt_104">mytable</span>:</p><div class="detached code-block" id="-360695856#z324mvt_103"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES ('John Doe', 30, 'Engineer');</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_101"><p id="-360695856#z324mvt_105">Insert multiple records:</p><div class="detached code-block" id="-360695856#z324mvt_106"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES 
('Jane Doe', 25, 'Teacher'),
('Steve Smith', 40, 'Chef');</code></pre></div></li></ol></section><section><h3 id="-360695856#5-3-read-query-records" data-toc="5-3-read-query-records#Dockerizing-PostgreSQL.md-5-3-read-query-records">5.3 Read (Query) Records</h3><ol class="list list-decimal" id="-360695856#z324mvt_107" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_108"><p id="-360695856#z324mvt_111">Select one record:</p><div class="detached code-block" id="-360695856#z324mvt_112"><pre><code class="language-sql">SELECT * FROM mytable WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_109"><p id="-360695856#z324mvt_113">Select all records:</p><div class="detached code-block" id="-360695856#z324mvt_114"><pre><code class="language-sql">SELECT * FROM mytable;</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_110"><p id="-360695856#z324mvt_115">Select records with a condition:</p><div class="detached code-block" id="-360695856#z324mvt_116"><pre><code class="language-sql">SELECT * FROM mytable WHERE age &gt; 30;</code></pre></div></li></ol></section><section><h3 id="-360695856#5-4-update-records" data-toc="5-4-update-records#Dockerizing-PostgreSQL.md-5-4-update-records">5.4 Update Records</h3><ol class="list list-decimal" id="-360695856#z324mvt_117" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_118"><p id="-360695856#z324mvt_120">Update a single record:</p><div class="detached code-block" id="-360695856#z324mvt_121"><pre><code class="language-sql">UPDATE mytable SET age = 31 WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_119"><p id="-360695856#z324mvt_122">Update multiple records:</p><div class="detached code-block" id="-360695856#z324mvt_123"><pre><code class="language-sql">UPDATE mytable SET occupation = 'Head Chef' WHERE occupation = 'Chef';</code></pre></div></li></ol></section><section><h3 id="-360695856#5-5-delete-records" data-toc="5-5-delete-records#Dockerizing-PostgreSQL.md-5-5-delete-records">5.5 Delete Records</h3><ol class="list list-decimal" id="-360695856#z324mvt_124" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_125"><p id="-360695856#z324mvt_127">Delete a single record:</p><div class="detached code-block" id="-360695856#z324mvt_128"><pre><code class="language-sql">DELETE FROM mytable WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_126"><p id="-360695856#z324mvt_129">Delete multiple records:</p><div class="detached code-block" id="-360695856#z324mvt_130"><pre><code class="language-sql">DELETE FROM mytable WHERE age &lt; 30;</code></pre></div></li></ol></section></section><section><h2 id="-360695856#chapter-6-accessing-postgresql-from-an-application" data-toc="chapter-6-accessing-postgresql-from-an-application#Dockerizing-PostgreSQL.md-chapter-6-accessing-postgresql-from-an-application">Chapter 6: Accessing PostgreSQL from an Application</h2><section><h3 id="-360695856#6-1-using-postgresql-with-node-js" data-toc="6-1-using-postgresql-with-node-js#Dockerizing-PostgreSQL.md-6-1-using-postgresql-with-node-js">6.1 Using PostgreSQL with Node.js</h3><ol class="list list-decimal" id="-360695856#z324mvt_132" type="1" start="1"><li class="list-item" id="-360695856#z324mvt_133"><p id="-360695856#z324mvt_139">Install Node.js from the official website (<a href="https://nodejs.org/">https://nodejs.org/</a>).</p></li><li class="list-item" id="-360695856#z324mvt_134"><p id="-360695856#z324mvt_141">Create a new project directory and navigate into it:</p><div class="detached code-block" id="-360695856#z324mvt_142"><pre><code class="language-bash">mkdir my-postgres-app
cd my-postgres-app</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_135"><p id="-360695856#z324mvt_143">Initialize a new Node.js project:</p><div class="detached code-block" id="-360695856#z324mvt_144"><pre><code class="language-bash">npm init -y</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_136"><p id="-360695856#z324mvt_145">Install the <span class="inline-code" id="-360695856#z324mvt_147">pg</span> package:</p><div class="detached code-block" id="-360695856#z324mvt_146"><pre><code class="language-bash">npm install pg</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_137"><p id="-360695856#z324mvt_148">Create an <span class="inline-code" id="-360695856#z324mvt_150">index.js</span> file and add the following code:</p><div class="detached code-block" id="-360695856#z324mvt_149"><pre><code class="language-javascript">const { Client } = require('pg');

async function main() {
  const client = new Client({
    user: 'admin',
    host: 'localhost',
    database: 'mydatabase',
    password: 'pass',
    port: 5432,
  });

  await client.connect();

  try {
    // Insert a record
    const insertResult = await client.query(&quot;INSERT INTO mytable (name, age, occupation) VALUES ('Alice', 28, 'Designer') RETURNING id&quot;);
    console.log('Inserted record ID:', insertResult.rows[0].id);

    // Select a record
    const selectResult = await client.query(&quot;SELECT * FROM mytable WHERE name = 'Alice'&quot;);
    console.log('Selected record:', selectResult.rows[0]);

    // Update a record
    const updateResult = await client.query(&quot;UPDATE mytable SET age = 29 WHERE name = 'Alice'&quot;);
    console.log('Updated record count:', updateResult.rowCount);

    // Delete a record
    const deleteResult = await client.query(&quot;DELETE FROM mytable WHERE name = 'Alice'&quot;);
    console.log('Deleted record count:', deleteResult.rowCount);
  } finally {
    await client.end();
  }
}

main().catch(console.error);</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_138"><p id="-360695856#z324mvt_151">Run the application:</p><div class="detached code-block" id="-360695856#z324mvt_152"><pre><code class="language-bash">node index.js</code></pre></div></li></ol></section></section><section><h2 id="-360695856#chapter-7-cleaning-up" data-toc="chapter-7-cleaning-up#Dockerizing-PostgreSQL.md-chapter-7-cleaning-up">Chapter 7: Cleaning Up</h2><section><h3 id="-360695856#7-1-stopping-and-removing-the-postgresql-container" data-toc="7-1-stopping-and-removing-the-postgresql-container#Dockerizing-PostgreSQL.md-7-1-stopping-and-removing-the-postgresql-container">7.1 Stopping and Removing the PostgreSQL Container</h3><ul class="list" id="-360695856#z324mvt_156" start="1"><li class="list-item" id="-360695856#z324mvt_157"><p id="-360695856#z324mvt_159">Stop the container:</p><div class="detached code-block" id="-360695856#z324mvt_160"><pre><code class="language-bash">docker stop postgres_container</code></pre></div></li><li class="list-item" id="-360695856#z324mvt_158"><p id="-360695856#z324mvt_161">Remove the container:</p><div class="detached code-block" id="-360695856#z324mvt_162"><pre><code class="language-bash">docker rm postgres_container</code></pre></div></li></ul></section><section><h3 id="-360695856#7-2-removing-the-postgresql-image" data-toc="7-2-removing-the-postgresql-image#Dockerizing-PostgreSQL.md-7-2-removing-the-postgresql-image">7.2 Removing the PostgreSQL Image</h3><ul class="list" id="-360695856#z324mvt_163" start="1"><li class="list-item" id="-360695856#z324mvt_164"><p id="-360695856#z324mvt_165">Remove the PostgreSQL image:</p><div class="detached code-block" id="-360695856#z324mvt_166"><pre><code class="language-bash">docker rmi postgres</code></pre></div></li></ul></section><section><h3 id="-360695856#7-3-removing-the-docker-volume" data-toc="7-3-removing-the-docker-volume#Dockerizing-PostgreSQL.md-7-3-removing-the-docker-volume">7.3 Removing the Docker Volume</h3><ul class="list" id="-360695856#z324mvt_167" start="1"><li class="list-item" id="-360695856#z324mvt_169"><p id="-360695856#z324mvt_170">Remove the Docker volume:</p><div class="detached code-block" id="-360695856#z324mvt_171"><pre><code class="language-bash">docker volume rm postgres-data</code></pre></div></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1933182566">Dockerizing MySQL</h1><section><h2 id="1933182566#chapter-1-introduction" data-toc="chapter-1-introduction#Dockerizing-MySQL.md-chapter-1-introduction">Chapter 1: Introduction</h2><p id="1933182566#-kghlfp_10">This guide will walk you through the steps of Dockerizing MySQL, setting up a user with specific credentials, persisting data using Docker volumes, and performing basic CRUD (Create, Read, Update, Delete) operations. We will cover everything from pulling the MySQL image to running queries.</p></section><section><h2 id="1933182566#chapter-2-setting-up-docker" data-toc="chapter-2-setting-up-docker#Dockerizing-MySQL.md-chapter-2-setting-up-docker">Chapter 2: Setting Up Docker</h2><section><h3 id="1933182566#2-1-installing-docker-on-windows" data-toc="2-1-installing-docker-on-windows#Dockerizing-MySQL.md-2-1-installing-docker-on-windows">2.1 Installing Docker on Windows</h3><ol class="list list-decimal" id="1933182566#-kghlfp_12" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_13"><p id="1933182566#-kghlfp_17">Download Docker Desktop from the Docker website (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li><li class="list-item" id="1933182566#-kghlfp_14"><p id="1933182566#-kghlfp_19">Run the installer and follow the instructions.</p></li><li class="list-item" id="1933182566#-kghlfp_15"><p id="1933182566#-kghlfp_20">After installation, start Docker Desktop.</p></li><li class="list-item" id="1933182566#-kghlfp_16"><p id="1933182566#-kghlfp_21">Verify the installation:</p><div class="detached code-block" id="1933182566#-kghlfp_22"><pre><code class="language-bash">docker --version</code></pre></div></li></ol></section></section><section><h2 id="1933182566#chapter-3-dockerizing-mysql" data-toc="chapter-3-dockerizing-mysql#Dockerizing-MySQL.md-chapter-3-dockerizing-mysql">Chapter 3: Dockerizing MySQL</h2><section><h3 id="1933182566#3-1-pulling-the-mysql-image" data-toc="3-1-pulling-the-mysql-image#Dockerizing-MySQL.md-3-1-pulling-the-mysql-image">3.1 Pulling the MySQL Image</h3><ul class="list" id="1933182566#-kghlfp_26" start="1"><li class="list-item" id="1933182566#-kghlfp_27"><p id="1933182566#-kghlfp_28">Open a command prompt and run the following command to pull the official MySQL image:</p><div class="detached code-block" id="1933182566#-kghlfp_29"><pre><code class="language-bash">docker pull mysql</code></pre></div></li></ul></section><section><h3 id="1933182566#3-2-creating-a-docker-volume" data-toc="3-2-creating-a-docker-volume#Dockerizing-MySQL.md-3-2-creating-a-docker-volume">3.2 Creating a Docker Volume</h3><ul class="list" id="1933182566#-kghlfp_30" start="1"><li class="list-item" id="1933182566#-kghlfp_31"><p id="1933182566#-kghlfp_32">Create a volume to persist MySQL data:</p><div class="detached code-block" id="1933182566#-kghlfp_33"><pre><code class="language-bash">docker volume create mysql-data</code></pre></div></li></ul></section><section><h3 id="1933182566#3-3-running-mysql-container-with-authentication-and-persistent-storage" data-toc="3-3-running-mysql-container-with-authentication-and-persistent-storage#Dockerizing-MySQL.md-3-3-running-mysql-container-with-authentication-and-persistent-storage">3.3 Running MySQL Container with Authentication and Persistent Storage</h3><ul class="list" id="1933182566#-kghlfp_34" start="1"><li class="list-item" id="1933182566#-kghlfp_35"><p id="1933182566#-kghlfp_37">Run the MySQL container with environment variables to set the username and password, and use the volume for data persistence:</p><div class="detached code-block" id="1933182566#-kghlfp_38"><pre><code class="language-bash">docker run --name mysql_container -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=pass -e MYSQL_USER=admin -e MYSQL_PASSWORD=pass -e MYSQL_DATABASE=mydatabase -v mysql-data:/var/lib/mysql mysql</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_36"><p id="1933182566#-kghlfp_39">Verify the container is running:</p><div class="detached code-block" id="1933182566#-kghlfp_40"><pre><code class="language-bash">docker ps</code></pre></div></li></ul></section></section><section><h2 id="1933182566#chapter-4-connecting-to-mysql" data-toc="chapter-4-connecting-to-mysql#Dockerizing-MySQL.md-chapter-4-connecting-to-mysql">Chapter 4: Connecting to MySQL</h2><section><h3 id="1933182566#4-1-using-mysql-shell" data-toc="4-1-using-mysql-shell#Dockerizing-MySQL.md-4-1-using-mysql-shell">4.1 Using MySQL Shell</h3><p id="1933182566#-kghlfp_42">You have two options to connect to the MySQL shell:</p><section><h4 id="1933182566#option-1-direct-command" data-toc="option-1-direct-command#Dockerizing-MySQL.md-option-1-direct-command">Option 1: Direct Command</h4><ul class="list" id="1933182566#-kghlfp_45" start="1"><li class="list-item" id="1933182566#-kghlfp_46"><p id="1933182566#-kghlfp_48">Start the MySQL shell directly:</p><div class="detached code-block" id="1933182566#-kghlfp_49"><pre><code class="language-bash">docker exec -it mysql_container mysql -u admin -p</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_47"><p id="1933182566#-kghlfp_50">you will be prompted to Enter password:</p><div class="detached code-block" id="1933182566#-kghlfp_51"><pre><code class="language-bash">Enter password: pass</code></pre></div></li></ul></section><section><h4 id="1933182566#option-2-entering-the-container-first" data-toc="option-2-entering-the-container-first#Dockerizing-MySQL.md-option-2-entering-the-container-first">Option 2: Entering the Container First</h4><ol class="list list-decimal" id="1933182566#-kghlfp_52" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_54"><p id="1933182566#-kghlfp_59">Start a bash shell inside the running MySQL container:</p><div class="detached code-block" id="1933182566#-kghlfp_60"><pre><code class="language-bash">docker exec -it mysql_container /bin/bash</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_55"><p id="1933182566#-kghlfp_61">Once inside the container, start the MySQL shell:</p><div class="detached code-block" id="1933182566#-kghlfp_62"><pre><code class="language-bash">mysql -u admin -p</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_56"><p id="1933182566#-kghlfp_63">Enter the password when prompted (<span class="inline-code" id="1933182566#-kghlfp_64">pass</span> in this example).</p></li><li class="list-item" id="1933182566#-kghlfp_57"><p id="1933182566#-kghlfp_65">You should now be in the MySQL shell:</p><div class="detached code-block" id="1933182566#-kghlfp_66"><pre><code class="language-sql">mysql&gt;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_58"><p id="1933182566#-kghlfp_67">In the MySQL shell, you can list all databases using the following command:</p></li></ol><ul class="list" id="1933182566#-kghlfp_53" start="1"><li class="list-item" id="1933182566#-kghlfp_68"><p id="1933182566#-kghlfp_69">List All Databases:</p><div class="detached code-block" id="1933182566#-kghlfp_70"><pre><code class="language-sql">SHOW DATABASES;</code></pre></div></li></ul></section></section></section><section><h2 id="1933182566#chapter-5-crud-operations" data-toc="chapter-5-crud-operations#Dockerizing-MySQL.md-chapter-5-crud-operations">Chapter 5: CRUD Operations</h2><section><h3 id="1933182566#5-1-creating-a-database-and-table" data-toc="5-1-creating-a-database-and-table#Dockerizing-MySQL.md-5-1-creating-a-database-and-table">5.1 Creating a Database and Table</h3><ol class="list list-decimal" id="1933182566#-kghlfp_77" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_78"><p id="1933182566#-kghlfp_81">Create a new database called <span class="inline-code" id="1933182566#-kghlfp_83">mydatabase</span>:</p><div class="detached code-block" id="1933182566#-kghlfp_82"><pre><code class="language-sql">CREATE DATABASE mydatabase;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_79"><p id="1933182566#-kghlfp_84">Select the new database:</p><div class="detached code-block" id="1933182566#-kghlfp_85"><pre><code class="language-sql">USE mydatabase;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_80"><p id="1933182566#-kghlfp_86">Create a new table called <span class="inline-code" id="1933182566#-kghlfp_88">mytable</span>:</p><div class="detached code-block" id="1933182566#-kghlfp_87"><pre><code class="language-sql">CREATE TABLE mytable (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    age INT,
    occupation VARCHAR(100)
);</code></pre></div></li></ol></section><section><h3 id="1933182566#5-2-create-insert-records" data-toc="5-2-create-insert-records#Dockerizing-MySQL.md-5-2-create-insert-records">5.2 Create (Insert) Records</h3><ol class="list list-decimal" id="1933182566#-kghlfp_89" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_90"><p id="1933182566#-kghlfp_92">Insert a single record into <span class="inline-code" id="1933182566#-kghlfp_94">mytable</span>:</p><div class="detached code-block" id="1933182566#-kghlfp_93"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES ('John Doe', 30, 'Engineer');</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_91"><p id="1933182566#-kghlfp_95">Insert multiple records:</p><div class="detached code-block" id="1933182566#-kghlfp_96"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES 
('Jane Doe', 25, 'Teacher'),
('Steve Smith', 40, 'Chef');</code></pre></div></li></ol></section><section><h3 id="1933182566#5-3-read-query-records" data-toc="5-3-read-query-records#Dockerizing-MySQL.md-5-3-read-query-records">5.3 Read (Query) Records</h3><ol class="list list-decimal" id="1933182566#-kghlfp_97" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_98"><p id="1933182566#-kghlfp_101">Select one record:</p><div class="detached code-block" id="1933182566#-kghlfp_102"><pre><code class="language-sql">SELECT * FROM mytable WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_99"><p id="1933182566#-kghlfp_103">Select all records:</p><div class="detached code-block" id="1933182566#-kghlfp_104"><pre><code class="language-sql">SELECT * FROM mytable;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_100"><p id="1933182566#-kghlfp_105">Select records with a condition:</p><div class="detached code-block" id="1933182566#-kghlfp_106"><pre><code class="language-sql">SELECT * FROM mytable WHERE age &gt; 30;</code></pre></div></li></ol></section><section><h3 id="1933182566#5-4-update-records" data-toc="5-4-update-records#Dockerizing-MySQL.md-5-4-update-records">5.4 Update Records</h3><ol class="list list-decimal" id="1933182566#-kghlfp_107" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_108"><p id="1933182566#-kghlfp_110">Update a single record:</p><div class="detached code-block" id="1933182566#-kghlfp_111"><pre><code class="language-sql">UPDATE mytable SET age = 31 WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_109"><p id="1933182566#-kghlfp_112">Update multiple records:</p><div class="detached code-block" id="1933182566#-kghlfp_113"><pre><code class="language-sql">UPDATE mytable SET occupation = 'Head Chef' WHERE occupation = 'Chef';</code></pre></div></li></ol></section><section><h3 id="1933182566#5-5-delete-records" data-toc="5-5-delete-records#Dockerizing-MySQL.md-5-5-delete-records">5.5 Delete Records</h3><ol class="list list-decimal" id="1933182566#-kghlfp_114" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_115"><p id="1933182566#-kghlfp_117">Delete a single record:</p><div class="detached code-block" id="1933182566#-kghlfp_118"><pre><code class="language-sql">DELETE FROM mytable WHERE name = 'John Doe';</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_116"><p id="1933182566#-kghlfp_119">Delete multiple records:</p><div class="detached code-block" id="1933182566#-kghlfp_120"><pre><code class="language-sql">DELETE FROM mytable WHERE age &lt; 30;</code></pre></div></li></ol></section><section><h3 id="1933182566#5-6-additional-useful-commands" data-toc="5-6-additional-useful-commands#Dockerizing-MySQL.md-5-6-additional-useful-commands">5.6 Additional Useful Commands</h3><ul class="list" id="1933182566#-kghlfp_121" start="1"><li class="list-item" id="1933182566#-kghlfp_122"><p id="1933182566#-kghlfp_125">List all tables in the current database:</p><div class="detached code-block" id="1933182566#-kghlfp_126"><pre><code class="language-sql">SHOW TABLES;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_123"><p id="1933182566#-kghlfp_127">Describe the structure of a table:</p><div class="detached code-block" id="1933182566#-kghlfp_128"><pre><code class="language-sql">DESCRIBE mytable;</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_124"><p id="1933182566#-kghlfp_129">List all users:</p><div class="detached code-block" id="1933182566#-kghlfp_130"><pre><code class="language-sql">SELECT User, Host FROM mysql.user;</code></pre></div></li></ul></section></section><section><h2 id="1933182566#chapter-6-accessing-mysql-from-an-application" data-toc="chapter-6-accessing-mysql-from-an-application#Dockerizing-MySQL.md-chapter-6-accessing-mysql-from-an-application">Chapter 6: Accessing MySQL from an Application</h2><section><h3 id="1933182566#6-1-using-mysql-with-node-js" data-toc="6-1-using-mysql-with-node-js#Dockerizing-MySQL.md-6-1-using-mysql-with-node-js">6.1 Using MySQL with Node.js</h3><ol class="list list-decimal" id="1933182566#-kghlfp_132" type="1" start="1"><li class="list-item" id="1933182566#-kghlfp_133"><p id="1933182566#-kghlfp_139">Install Node.js from the official website (<a href="https://nodejs.org/">https://nodejs.org/</a>).</p></li><li class="list-item" id="1933182566#-kghlfp_134"><p id="1933182566#-kghlfp_141">Create a new project directory and navigate into it:</p><div class="detached code-block" id="1933182566#-kghlfp_142"><pre><code class="language-bash">mkdir my-mysql-app
cd my-mysql-app</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_135"><p id="1933182566#-kghlfp_143">Initialize a new Node.js project:</p><div class="detached code-block" id="1933182566#-kghlfp_144"><pre><code class="language-bash">npm init -y</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_136"><p id="1933182566#-kghlfp_145">Install the <span class="inline-code" id="1933182566#-kghlfp_147">mysql</span> package:</p><div class="detached code-block" id="1933182566#-kghlfp_146"><pre><code class="language-bash">npm install mysql2</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_137"><p id="1933182566#-kghlfp_148">Create an <span class="inline-code" id="1933182566#-kghlfp_150">index.js</span> file and add the following code:</p><div class="detached code-block" id="1933182566#-kghlfp_149"><pre><code class="language-javascript">const mysql = require('mysql2/promise');

 async function main() {
 const connection = await mysql.createConnection({
 host: 'localhost',
 user: 'admin',
 password: 'pass',
 database: 'mydatabase'
 });

 try {
 console.log('connected as id ' + connection.threadId);

     // Insert a record
     const [insertResults] = await connection.execute(
       &quot;INSERT INTO mytable (name, age, occupation) VALUES (?, ?, ?)&quot;,
       ['Alice', 28, 'Designer']
     );
     console.log('Inserted record ID:', insertResults.insertId);

     // Select a record
     const [selectResults] = await connection.execute(
       &quot;SELECT * FROM mytable WHERE name = ?&quot;,
       ['Alice']
     );
     console.log('Selected record:', selectResults[0]);

     // Update a record
     const [updateResults] = await connection.execute(
       &quot;UPDATE mytable SET age = ? WHERE name = ?&quot;,
       [29, 'Alice']
     );
     console.log('Updated record count:', updateResults.affectedRows);

     // Delete a record
     const [deleteResults] = await connection.execute(
       &quot;DELETE FROM mytable WHERE name = ?&quot;,
       ['Alice']
     );
     console.log('Deleted record count:', deleteResults.affectedRows);
 } catch (err) {
 console.error('error:', err.stack);
 } finally {
 await connection.end();
 }
 }

 main();</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_138"><p id="1933182566#-kghlfp_151">Run the application:</p><div class="detached code-block" id="1933182566#-kghlfp_152"><pre><code class="language-bash">node index.js</code></pre></div></li></ol></section></section><section><h2 id="1933182566#chapter-7-cleaning-up" data-toc="chapter-7-cleaning-up#Dockerizing-MySQL.md-chapter-7-cleaning-up">Chapter 7: Cleaning Up</h2><section><h3 id="1933182566#7-1-stopping-and-removing-the-mysql-container" data-toc="7-1-stopping-and-removing-the-mysql-container#Dockerizing-MySQL.md-7-1-stopping-and-removing-the-mysql-container">7.1 Stopping and Removing the MySQL Container</h3><ul class="list" id="1933182566#-kghlfp_156" start="1"><li class="list-item" id="1933182566#-kghlfp_157"><p id="1933182566#-kghlfp_159">Stop the container:</p><div class="detached code-block" id="1933182566#-kghlfp_160"><pre><code class="language-bash">docker stop mysql_container</code></pre></div></li><li class="list-item" id="1933182566#-kghlfp_158"><p id="1933182566#-kghlfp_161">Remove the container:</p><div class="detached code-block" id="1933182566#-kghlfp_162"><pre><code class="language-bash">docker rm mysql_container</code></pre></div></li></ul></section><section><h3 id="1933182566#7-2-removing-the-mysql-image" data-toc="7-2-removing-the-mysql-image#Dockerizing-MySQL.md-7-2-removing-the-mysql-image">7.2 Removing the MySQL Image</h3><ul class="list" id="1933182566#-kghlfp_163" start="1"><li class="list-item" id="1933182566#-kghlfp_164"><p id="1933182566#-kghlfp_165">Remove the MySQL image:</p><div class="detached code-block" id="1933182566#-kghlfp_166"><pre><code class="language-bash">docker rmi mysql</code></pre></div></li></ul></section><section><h3 id="1933182566#7-3-removing-the-docker-volume" data-toc="7-3-removing-the-docker-volume#Dockerizing-MySQL.md-7-3-removing-the-docker-volume">7.3 Removing the Docker Volume</h3><ul class="list" id="1933182566#-kghlfp_167" start="1"><li class="list-item" id="1933182566#-kghlfp_169"><p id="1933182566#-kghlfp_170">Remove the Docker volume:</p><div class="detached code-block" id="1933182566#-kghlfp_171"><pre><code class="language-bash">docker volume rm mysql-data</code></pre></div></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1559871545">Dockerizing MSSQL</h1><section><h2 id="1559871545#chapter-1-introduction" data-toc="chapter-1-introduction#Dockerizing MSSQL.md-chapter-1-introduction">Chapter 1: Introduction</h2><p id="1559871545#nh82a0_11">This guide will walk you through the steps of Dockerizing Microsoft SQL Server (MSSQL), setting up a user with specific credentials, persisting data using Docker volumes, and performing basic CRUD (Create, Read, Update, Delete) operations on a Windows system. We will cover everything from pulling the MSSQL image to running queries.</p></section><section><h2 id="1559871545#chapter-2-setting-up-docker" data-toc="chapter-2-setting-up-docker#Dockerizing MSSQL.md-chapter-2-setting-up-docker">Chapter 2: Setting Up Docker</h2><section><h3 id="1559871545#2-1-installing-docker-on-windows" data-toc="2-1-installing-docker-on-windows#Dockerizing MSSQL.md-2-1-installing-docker-on-windows">2.1 Installing Docker on Windows</h3><ol class="list list-decimal" id="1559871545#nh82a0_13" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_14"><p id="1559871545#nh82a0_18">Download Docker Desktop from the Docker website (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li><li class="list-item" id="1559871545#nh82a0_15"><p id="1559871545#nh82a0_20">Run the installer and follow the instructions.</p></li><li class="list-item" id="1559871545#nh82a0_16"><p id="1559871545#nh82a0_21">After installation, start Docker Desktop.</p></li><li class="list-item" id="1559871545#nh82a0_17"><p id="1559871545#nh82a0_22">Verify the installation:</p><div class="detached code-block" id="1559871545#nh82a0_23"><pre><code class="language-bash">docker --version</code></pre></div></li></ol></section></section><section><h2 id="1559871545#chapter-3-dockerizing-mssql-server" data-toc="chapter-3-dockerizing-mssql-server#Dockerizing MSSQL.md-chapter-3-dockerizing-mssql-server">Chapter 3: Dockerizing MSSQL Server</h2><section><h3 id="1559871545#3-1-pulling-the-mssql-server-image" data-toc="3-1-pulling-the-mssql-server-image#Dockerizing MSSQL.md-3-1-pulling-the-mssql-server-image">3.1 Pulling the MSSQL Server Image</h3><ul class="list" id="1559871545#nh82a0_27" start="1"><li class="list-item" id="1559871545#nh82a0_28"><p id="1559871545#nh82a0_29">Open a command prompt or PowerShell and run the following command to pull the official MSSQL Server image:</p><div class="detached code-block" id="1559871545#nh82a0_30"><pre><code class="language-bash">docker pull mcr.microsoft.com/mssql/server</code></pre></div></li></ul></section><section><h3 id="1559871545#3-2-creating-a-docker-volume" data-toc="3-2-creating-a-docker-volume#Dockerizing MSSQL.md-3-2-creating-a-docker-volume">3.2 Creating a Docker Volume</h3><ul class="list" id="1559871545#nh82a0_31" start="1"><li class="list-item" id="1559871545#nh82a0_32"><p id="1559871545#nh82a0_33">Create a volume to persist MSSQL Server data:</p><div class="detached code-block" id="1559871545#nh82a0_34"><pre><code class="language-bash">docker volume create mssql-data</code></pre></div></li></ul></section><section><h3 id="1559871545#3-3-running-mssql-server-container-with-authentication-and-persistent-storage" data-toc="3-3-running-mssql-server-container-with-authentication-and-persistent-storage#Dockerizing MSSQL.md-3-3-running-mssql-server-container-with-authentication-and-persistent-storage">3.3 Running MSSQL Server Container with Authentication and Persistent Storage</h3><ul class="list" id="1559871545#nh82a0_35" start="1"><li class="list-item" id="1559871545#nh82a0_36"><p id="1559871545#nh82a0_38">Run the MSSQL Server container with environment variables to set the SA password and use the volume for data persistence:</p><div class="detached code-block" id="1559871545#nh82a0_39"><pre><code class="language-bash">docker run -e &quot;ACCEPT_EULA=Y&quot; -e &quot;SA_PASSWORD=yourStrong(!)Password&quot; -p 1433:1433 --name mssql_container -v mssql-data:/var/opt/mssql -d mcr.microsoft.com/mssql/server</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_37"><p id="1559871545#nh82a0_40">Verify the container is running:</p><div class="detached code-block" id="1559871545#nh82a0_41"><pre><code class="language-bash">docker ps</code></pre></div></li></ul></section></section><section><h2 id="1559871545#chapter-4-installing-mssql-command-line-tools" data-toc="chapter-4-installing-mssql-command-line-tools#Dockerizing MSSQL.md-chapter-4-installing-mssql-command-line-tools">Chapter 4: Installing MSSQL Command Line Tools</h2><section><h3 id="1559871545#4-1-download-and-install-mssql-tools" data-toc="4-1-download-and-install-mssql-tools#Dockerizing MSSQL.md-4-1-download-and-install-mssql-tools">4.1 Download and Install MSSQL Tools</h3><ol class="list list-decimal" id="1559871545#nh82a0_43" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_44"><p id="1559871545#nh82a0_48">Download the Microsoft ODBC Driver 17 for SQL Server from the Microsoft website (<a href="https://docs.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server">https://docs.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server</a>).</p></li><li class="list-item" id="1559871545#nh82a0_45"><p id="1559871545#nh82a0_50">Install the ODBC driver by running the downloaded installer.</p></li><li class="list-item" id="1559871545#nh82a0_46"><p id="1559871545#nh82a0_51">Download the SQL Server Command Line Tools (<span class="inline-code" id="1559871545#nh82a0_52">sqlcmd</span> and <span class="inline-code" id="1559871545#nh82a0_53">bcp</span>) from the Microsoft website (<a href="https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility">https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility</a>).</p></li><li class="list-item" id="1559871545#nh82a0_47"><p id="1559871545#nh82a0_55">Install the SQL Server Command Line Tools by running the downloaded installer.</p></li></ol></section></section><section><h2 id="1559871545#chapter-5-connecting-to-mssql-server" data-toc="chapter-5-connecting-to-mssql-server#Dockerizing MSSQL.md-chapter-5-connecting-to-mssql-server">Chapter 5: Connecting to MSSQL Server</h2><section><h3 id="1559871545#5-1-using-mssql-server-command-line-tools" data-toc="5-1-using-mssql-server-command-line-tools#Dockerizing MSSQL.md-5-1-using-mssql-server-command-line-tools">5.1 Using MSSQL Server Command Line Tools</h3><ol class="list list-decimal" id="1559871545#nh82a0_58" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_59"><p id="1559871545#nh82a0_63">Open Command Prompt or PowerShell.</p></li><li class="list-item" id="1559871545#nh82a0_60"><p id="1559871545#nh82a0_64">Connect to the MSSQL Server using <span class="inline-code" id="1559871545#nh82a0_66">sqlcmd</span>:</p><div class="detached code-block" id="1559871545#nh82a0_65"><pre><code class="language-bash">sqlcmd -S localhost -U SA -P &quot;yourStrong(!)Password&quot;</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_61"><p id="1559871545#nh82a0_67">You should now be in the MSSQL command line:</p><div class="detached code-block" id="1559871545#nh82a0_68"><pre><code class="language-sql">1&gt;</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_62"><p id="1559871545#nh82a0_69">In the MSSQL command line, you can list all databases using the following command:</p><div class="detached code-block" id="1559871545#nh82a0_70"><pre><code class="language-sql">SELECT name FROM sys.databases;
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#example-session" data-toc="example-session#Dockerizing MSSQL.md-example-session">Example Session</h3><ul class="list" id="1559871545#nh82a0_71" start="1"><li class="list-item" id="1559871545#nh82a0_72"><p id="1559871545#nh82a0_73">Here's how an example session might look:</p><div class="detached code-block" id="1559871545#nh82a0_74"><pre><code class="language-bash">C:\&gt; sqlcmd -S localhost -U SA -P &quot;yourStrong(!)Password&quot;
1&gt; SELECT name FROM sys.databases;
2&gt; GO
name
--------------------------------------------------------------------------------------------------------------------------------
master
tempdb
model
msdb
mydatabase

(5 rows affected)
1&gt;</code></pre></div></li></ul></section></section><section><h2 id="1559871545#chapter-6-crud-operations" data-toc="chapter-6-crud-operations#Dockerizing MSSQL.md-chapter-6-crud-operations">Chapter 6: CRUD Operations</h2><section><h3 id="1559871545#6-1-creating-a-database-and-table" data-toc="6-1-creating-a-database-and-table#Dockerizing MSSQL.md-6-1-creating-a-database-and-table">6.1 Creating a Database and Table</h3><ol class="list list-decimal" id="1559871545#nh82a0_81" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_82"><p id="1559871545#nh82a0_85">Create a new database called <span class="inline-code" id="1559871545#nh82a0_87">mydatabase</span>:</p><div class="detached code-block" id="1559871545#nh82a0_86"><pre><code class="language-sql">CREATE DATABASE mydatabase;
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_83"><p id="1559871545#nh82a0_88">Use the new database:</p><div class="detached code-block" id="1559871545#nh82a0_89"><pre><code class="language-sql">USE mydatabase;
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_84"><p id="1559871545#nh82a0_90">Create a new table called <span class="inline-code" id="1559871545#nh82a0_92">mytable</span>:</p><div class="detached code-block" id="1559871545#nh82a0_91"><pre><code class="language-sql">CREATE TABLE mytable (
    id INT PRIMARY KEY IDENTITY(1,1),
    name NVARCHAR(100),
    age INT,
    occupation NVARCHAR(100)
);
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#6-2-create-insert-records" data-toc="6-2-create-insert-records#Dockerizing MSSQL.md-6-2-create-insert-records">6.2 Create (Insert) Records</h3><ol class="list list-decimal" id="1559871545#nh82a0_93" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_94"><p id="1559871545#nh82a0_96">Insert a single record into <span class="inline-code" id="1559871545#nh82a0_98">mytable</span>:</p><div class="detached code-block" id="1559871545#nh82a0_97"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES ('John Doe', 30, 'Engineer');
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_95"><p id="1559871545#nh82a0_99">Insert multiple records:</p><div class="detached code-block" id="1559871545#nh82a0_100"><pre><code class="language-sql">INSERT INTO mytable (name, age, occupation) VALUES 
('Jane Doe', 25, 'Teacher'),
('Steve Smith', 40, 'Chef');
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#6-3-read-query-records" data-toc="6-3-read-query-records#Dockerizing MSSQL.md-6-3-read-query-records">6.3 Read (Query) Records</h3><ol class="list list-decimal" id="1559871545#nh82a0_101" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_102"><p id="1559871545#nh82a0_105">Select one record:</p><div class="detached code-block" id="1559871545#nh82a0_106"><pre><code class="language-sql">SELECT * FROM mytable WHERE name = 'John Doe';
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_103"><p id="1559871545#nh82a0_107">Select all records:</p><div class="detached code-block" id="1559871545#nh82a0_108"><pre><code class="language-sql">SELECT * FROM mytable;
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_104"><p id="1559871545#nh82a0_109">Select records with a condition:</p><div class="detached code-block" id="1559871545#nh82a0_110"><pre><code class="language-sql">SELECT * FROM mytable WHERE age &gt; 30;
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#6-4-update-records" data-toc="6-4-update-records#Dockerizing MSSQL.md-6-4-update-records">6.4 Update Records</h3><ol class="list list-decimal" id="1559871545#nh82a0_111" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_112"><p id="1559871545#nh82a0_114">Update a single record:</p><div class="detached code-block" id="1559871545#nh82a0_115"><pre><code class="language-sql">UPDATE mytable SET age = 31 WHERE name = 'John Doe';
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_113"><p id="1559871545#nh82a0_116">Update multiple records:</p><div class="detached code-block" id="1559871545#nh82a0_117"><pre><code class="language-sql">UPDATE mytable SET occupation = 'Head Chef' WHERE occupation = 'Chef';
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#6-5-delete-records" data-toc="6-5-delete-records#Dockerizing MSSQL.md-6-5-delete-records">6.5 Delete Records</h3><ol class="list list-decimal" id="1559871545#nh82a0_118" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_119"><p id="1559871545#nh82a0_121">Delete a single record:</p><div class="detached code-block" id="1559871545#nh82a0_122"><pre><code class="language-sql">DELETE FROM mytable WHERE name = 'John Doe';
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_120"><p id="1559871545#nh82a0_123">Delete multiple records:</p><div class="detached code-block" id="1559871545#nh82a0_124"><pre><code class="language-sql">DELETE FROM mytable WHERE age &lt; 30;
GO</code></pre></div></li></ol></section><section><h3 id="1559871545#6-6-additional-useful-commands" data-toc="6-6-additional-useful-commands#Dockerizing MSSQL.md-6-6-additional-useful-commands">6.6 Additional Useful Commands</h3><ul class="list" id="1559871545#nh82a0_125" start="1"><li class="list-item" id="1559871545#nh82a0_126"><p id="1559871545#nh82a0_129">List all tables in the current database:</p><div class="detached code-block" id="1559871545#nh82a0_130"><pre><code class="language-sql">SELECT * FROM sys.Tables;
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_127"><p id="1559871545#nh82a0_131">Describe the structure of a table:</p><div class="detached code-block" id="1559871545#nh82a0_132"><pre><code class="language-sql">sp_help mytable;
GO</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_128"><p id="1559871545#nh82a0_133">List all users:</p><div class="detached code-block" id="1559871545#nh82a0_134"><pre><code class="language-sql">SELECT name FROM sys.sql_logins;
GO</code></pre></div></li></ul></section></section><section><h2 id="1559871545#chapter-7-accessing-mssql-server-from-an-application" data-toc="chapter-7-accessing-mssql-server-from-an-application#Dockerizing MSSQL.md-chapter-7-accessing-mssql-server-from-an-application">Chapter 7: Accessing MSSQL Server from an Application</h2><section><h3 id="1559871545#7-1-using-mssql-server-with-node-js" data-toc="7-1-using-mssql-server-with-node-js#Dockerizing MSSQL.md-7-1-using-mssql-server-with-node-js">7.1 Using MSSQL Server with Node.js</h3><ol class="list list-decimal" id="1559871545#nh82a0_136" type="1" start="1"><li class="list-item" id="1559871545#nh82a0_137"><p id="1559871545#nh82a0_143">Install Node.js from the official website (<a href="https://nodejs.org/">https://nodejs.org/</a>).</p></li><li class="list-item" id="1559871545#nh82a0_138"><p id="1559871545#nh82a0_145">Create a new project directory and navigate into it:</p><div class="detached code-block" id="1559871545#nh82a0_146"><pre><code class="language-bash">mkdir my-mssql-app
cd my-mssql-app</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_139"><p id="1559871545#nh82a0_147">Initialize a new Node.js project:</p><div class="detached code-block" id="1559871545#nh82a0_148"><pre><code class="language-bash">npm init -y</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_140"><p id="1559871545#nh82a0_149">Install the <span class="inline-code" id="1559871545#nh82a0_151">mssql</span> package:</p><div class="detached code-block" id="1559871545#nh82a0_150"><pre><code class="language-bash">npm install mssql</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_141"><p id="1559871545#nh82a0_152">Create an <span class="inline-code" id="1559871545#nh82a0_154">index.js</span> file and add the following code:</p><div class="detached code-block" id="1559871545#nh82a0_153"><pre><code class="language-javascript">const sql = require('mssql');

const config = {
  user: 'sa',
  password: 'yourStrong(!)Password',
  server: 'localhost', 
  database: 'mydatabase',
  options: {
    encrypt: true, // Use encryption
    trustServerCertificate: true // For self-signed certificate
  }
};

async function main() {
  try {
    let pool = await sql.connect(config);

    // Insert a record
    let insertResult = await pool.request()
      .query(&quot;INSERT INTO mytable (name, age, occupation) VALUES ('Alice', 28, 'Designer')&quot;);
    console.log('Inserted record:', insertResult);

     // Insert a many
     let insertResult = await pool.request()
         .query(`INSERT INTO mytable (name, age, occupation) VALUES  
             ('jane doe', 30, 'Designer'),
             ('kyle Smith', 40, 'Chef')`);
     console.log('Inserted record:', insertResult);

    // Select a record
    let selectResult = await pool.request()
      .query(&quot;SELECT * FROM mytable WHERE name = 'Alice'&quot;);
    console.log('Selected record:', selectResult.recordset);

    // Update a record
    let updateResult = await pool.request()
      .query(&quot;UPDATE mytable SET age = 29 WHERE name = 'Alice'&quot;);
    console.log('Updated record:', updateResult);

    // Delete a record
    let deleteResult = await pool.request()
      .query(&quot;DELETE FROM mytable WHERE name = 'Alice'&quot;);
    console.log('Deleted record:', deleteResult);

  } catch (err) {
    console.error('SQL error', err);
  }
}

main();</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_142"><p id="1559871545#nh82a0_155">Run the application:</p><div class="detached code-block" id="1559871545#nh82a0_156"><pre><code class="language-bash">node index.js</code></pre></div></li></ol></section></section><section><h2 id="1559871545#chapter-8-cleaning-up" data-toc="chapter-8-cleaning-up#Dockerizing MSSQL.md-chapter-8-cleaning-up">Chapter 8: Cleaning Up</h2><section><h3 id="1559871545#8-1-stopping-and-removing-the-mssql-server-container" data-toc="8-1-stopping-and-removing-the-mssql-server-container#Dockerizing MSSQL.md-8-1-stopping-and-removing-the-mssql-server-container">8.1 Stopping and Removing the MSSQL Server Container</h3><ul class="list" id="1559871545#nh82a0_160" start="1"><li class="list-item" id="1559871545#nh82a0_161"><p id="1559871545#nh82a0_163">Stop the container:</p><div class="detached code-block" id="1559871545#nh82a0_164"><pre><code class="language-bash">docker stop mssql_container
``</code></pre></div></li><li class="list-item" id="1559871545#nh82a0_162"><p id="1559871545#nh82a0_165">Remove the container:</p><div class="detached code-block" id="1559871545#nh82a0_166"><pre><code class="language-bash">docker rm mssql_container</code></pre></div></li></ul></section><section><h3 id="1559871545#8-2-removing-the-mssql-server-image" data-toc="8-2-removing-the-mssql-server-image#Dockerizing MSSQL.md-8-2-removing-the-mssql-server-image">8.2 Removing the MSSQL Server Image</h3><ul class="list" id="1559871545#nh82a0_167" start="1"><li class="list-item" id="1559871545#nh82a0_168"><p id="1559871545#nh82a0_169">Remove the MSSQL Server image:</p><div class="detached code-block" id="1559871545#nh82a0_170"><pre><code class="language-bash">docker rmi mcr.microsoft.com/mssql/server</code></pre></div></li></ul></section><section><h3 id="1559871545#8-3-removing-the-docker-volume" data-toc="8-3-removing-the-docker-volume#Dockerizing MSSQL.md-8-3-removing-the-docker-volume">8.3 Removing the Docker Volume</h3><ul class="list" id="1559871545#nh82a0_171" start="1"><li class="list-item" id="1559871545#nh82a0_172"><p id="1559871545#nh82a0_173">Remove the Docker volume:</p><div class="detached code-block" id="1559871545#nh82a0_174"><pre><code class="language-bash">docker volume rm mssql-data</code></pre></div></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1119023943">Dockerizing React, Node.js, Postgres &amp; Nginx &lt;Dev &amp; Prod&gt;</h1><p id="-1119023943#ewdids_2">This guide provides a step-by-step approach to Dockerizing a React application using Vite, with Node.js, Postgres, and Nginx, for both development and production environments.</p><section><h2 id="-1119023943#development-mode" data-toc="development-mode#Dockerizing-React-Node-Nginx.md-development-mode">Development Mode</h2><div class="container"><figure class="image-container"><img class="center image image-size" id="-1119023943#ewdids_15" alt="dev.png" title="dev.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/dev.png" width="1041" height="442"><figcaption class="center-text">dev.png</figcaption></figure></div><p id="-1119023943#ewdids_16">In your development environment, the architecture works as follows:</p><ol class="list list-decimal" id="-1119023943#ewdids_17" type="1" start="1"><li class="list-item" id="-1119023943#ewdids_19"><p><span class="control" id="-1119023943#ewdids_23">Nginx</span> acts as a reverse proxy, routing incoming HTTP requests to either the <span class="control" id="-1119023943#ewdids_24">React server</span> or the <span class="control" id="-1119023943#ewdids_25">Express server</span> based on the request path.</p></li><li class="list-item" id="-1119023943#ewdids_20"><p><span class="control" id="-1119023943#ewdids_26">React Server</span> handles all requests for the frontend (i.e., your React application). When you develop, changes here are served by the React development server, often with hot-reloading.</p></li><li class="list-item" id="-1119023943#ewdids_21"><p><span class="control" id="-1119023943#ewdids_27">Express Server</span> processes backend API requests. These requests might involve querying or updating data in the <span class="control" id="-1119023943#ewdids_28">Postgres</span> database.</p></li><li class="list-item" id="-1119023943#ewdids_22"><p><span class="control" id="-1119023943#ewdids_29">Nginx</span> forwards requests: </p><ul class="list" id="-1119023943#ewdids_30" start="1"><li class="list-item" id="-1119023943#ewdids_31"><p>Requests to the base URL (e.g., <span class="inline-code" id="-1119023943#ewdids_33">http://localhost/</span>) are sent to the React server.</p></li><li class="list-item" id="-1119023943#ewdids_32"><p>Requests to paths starting with <span class="inline-code" id="-1119023943#ewdids_34">/api</span> are forwarded to the Express server, which may interact with the Postgres database.</p></li></ul></li></ol><p id="-1119023943#ewdids_18">This setup allows you to work on both the frontend and backend in a unified environment, ensuring that you can test how they interact together while still enjoying the benefits of a development-focused workflow like hot-reloading and quick feedback.</p></section><section><h2 id="-1119023943#react-folder-file-structure" data-toc="react-folder-file-structure#Dockerizing-React-Node-Nginx.md-react-folder-file-structure">React Folder &amp; File structure</h2><section><h3 id="-1119023943#1-client-react-vite" data-toc="1-client-react-vite#Dockerizing-React-Node-Nginx.md-1-client-react-vite">1. Client: React + Vite</h3><div class="container"><figure class="image-container"><img class="center image image-size" id="-1119023943#ewdids_41" alt="react-structure.png" title="react-structure.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/react-structure.png" width="492" height="454"><figcaption class="center-text">react-structure.png</figcaption></figure></div><ul class="list" id="-1119023943#ewdids_42" start="1"><li class="list-item" id="-1119023943#ewdids_43"><p id="-1119023943#ewdids_45"><span class="control" id="-1119023943#ewdids_47">Create a Vite React project:</span></p><div class="detached code-block" id="-1119023943#ewdids_46"><pre><code class="language-bash">npm create vite@latest my-react-app -- --template react
cd my-react-app
npm install</code></pre></div></li><li class="list-item" id="-1119023943#ewdids_44"><p id="-1119023943#ewdids_48"><span class="control" id="-1119023943#ewdids_50">Install necessary dependencies:</span> You'll need to install <span class="inline-code" id="-1119023943#ewdids_51">react-router-dom</span> and <span class="inline-code" id="-1119023943#ewdids_52">axios</span> for routing and HTTP requests.</p><div class="detached code-block" id="-1119023943#ewdids_49"><pre><code class="language-bash">npm install react-router-dom@4.3.1 axios</code></pre></div></li></ul></section><section><h3 id="-1119023943#2-create-the-project-structure" data-toc="2-create-the-project-structure#Dockerizing-React-Node-Nginx.md-2-create-the-project-structure">2. Create the Project Structure</h3><p id="-1119023943#ewdids_53">Your project should be structured as follows:</p><div class="detached code-block" id="-1119023943#ewdids_54"><pre><code class="language-none">my-react-app/
 node_modules/ 
 public/
 src/
    assets/
    Components/
       MainComponent.jsx
       MainComponent.css
       OtherPage.jsx
    App.css
    App.jsx
    index.css
    main.jsx
    vite-env.d.ts
 .dockerignore
 .gitignore
 Dockerfile.dev
 Dockerfile
 eslint.config.js
 index.html
 package.json
 pnpm-lock.yaml
 README.md
 vite.config.js</code></pre></div></section><section><h3 id="-1119023943#3-add-the-required-code" data-toc="3-add-the-required-code#Dockerizing-React-Node-Nginx.md-3-add-the-required-code">3. Add the Required Code</h3><ul class="list" id="-1119023943#ewdids_55" start="1"><li class="list-item" id="-1119023943#ewdids_69"><section><h4 id="-1119023943#src-app-jsx" data-toc="src-app-jsx#Dockerizing-React-Node-Nginx.md-src-app-jsx">src/App.jsx</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_56"><pre><code class="language-javascript">import './App.css';
import { BrowserRouter as Router, Route, Link } from &quot;react-router-dom&quot;;
import MainComponent from './Components/MainComponent';
import OtherPage from './Components/OtherPage';

function App() {
  return (
    &lt;Router&gt;
      &lt;&gt;
        &lt;header className=&quot;header&quot;&gt;
          &lt;div&gt;This is a multicontainer application&lt;/div&gt;
          &lt;Link to=&quot;/&quot;&gt;Home&lt;/Link&gt;
          &lt;Link to=&quot;/otherpage&quot;&gt;Other page&lt;/Link&gt;
        &lt;/header&gt;
        &lt;div className=&quot;main&quot;&gt;
          &lt;Route exact path=&quot;/&quot; component={MainComponent} /&gt;
          &lt;Route path=&quot;/otherpage&quot; component={OtherPage} /&gt;
        &lt;/div&gt;
      &lt;/&gt;
    &lt;/Router&gt;
  );
}

export default App;</code></pre></div><ul class="list" id="-1119023943#ewdids_57" start="1"><li class="list-item" id="-1119023943#ewdids_73"><section><h4 id="-1119023943#src-app-css" data-toc="src-app-css#Dockerizing-React-Node-Nginx.md-src-app-css">src/App.css</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_58"><pre><code class="language-css">.header {
  background: #eee;
}

.header a {
  margin-left: 20px;
}

.main {
  padding: 10px;
  background: #ccc;
}</code></pre></div><ul class="list" id="-1119023943#ewdids_59" start="1"><li class="list-item" id="-1119023943#ewdids_77"><section><h4 id="-1119023943#src-index-css" data-toc="src-index-css#Dockerizing-React-Node-Nginx.md-src-index-css">src/index.css</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_60"><pre><code class="language-css">body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}</code></pre></div><ul class="list" id="-1119023943#ewdids_61" start="1"><li class="list-item" id="-1119023943#ewdids_81"><section><h4 id="-1119023943#src-main-jsx" data-toc="src-main-jsx#Dockerizing-React-Node-Nginx.md-src-main-jsx">src/main.jsx</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_62"><pre><code class="language-javascript">import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import App from './App.jsx';
import './index.css';

createRoot(document.getElementById('root')).render(
  &lt;StrictMode&gt;
    &lt;App /&gt;
  &lt;/StrictMode&gt;,
);</code></pre></div><ul class="list" id="-1119023943#ewdids_63" start="1"><li class="list-item" id="-1119023943#ewdids_85"><section><h4 id="-1119023943#src-components-maincomponent-jsx" data-toc="src-components-maincomponent-jsx#Dockerizing-React-Node-Nginx.md-src-components-maincomponent-jsx">src/Components/MainComponent.jsx</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_64"><pre><code class="language-javascript">import { useCallback, useState, useEffect } from &quot;react&quot;;
import axios from &quot;axios&quot;;
import &quot;./MainComponent.css&quot;;

function MainComponent() {
  const [values, setValues] = useState([]);
  const [value, setValue] = useState(&quot;&quot;);

  const getAllNumbers = useCallback(async () =&gt; {
    const data = await axios.get(&quot;/api/values/all&quot;);
    setValues(data.data.rows.map(row =&gt; row.number));
  }, []);

  const saveNumber = useCallback(
    async (event) =&gt; {
      event.preventDefault();
      await axios.post(&quot;/api/values&quot;, { value });

      setValue(&quot;&quot;);
      getAllNumbers();
    },
    [value, getAllNumbers]
  );

  useEffect(() =&gt; {
    getAllNumbers();
  }, []);

  return (
    &lt;div&gt;
      &lt;button onClick={getAllNumbers}&gt;Get all numbers&lt;/button&gt;
      &lt;br /&gt;
      &lt;span className=&quot;title&quot;&gt;Values&lt;/span&gt;
      &lt;div className=&quot;values&quot;&gt;
        {values.map((value, index) =&gt; (
          &lt;div className=&quot;value&quot; key={index}&gt;{value}&lt;/div&gt;
        ))}
      &lt;/div&gt;
      &lt;form className=&quot;form&quot; onSubmit={saveNumber}&gt;
        &lt;label&gt;Enter your value: &lt;/label&gt;
        &lt;input
          value={value}
          onChange={event =&gt; {
            setValue(event.target.value);
          }}
        /&gt;
        &lt;button&gt;Submit&lt;/button&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  );
}

export default MainComponent;</code></pre></div><ul class="list" id="-1119023943#ewdids_65" start="1"><li class="list-item" id="-1119023943#ewdids_89"><section><h4 id="-1119023943#src-components-maincomponent-css" data-toc="src-components-maincomponent-css#Dockerizing-React-Node-Nginx.md-src-components-maincomponent-css">src/Components/MainComponent.css</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_66"><pre><code class="language-css">.title {
  font-weight: bold;
}

.values {
  margin-top: 20px;
  background: yellow;
}

.value {
  margin-top: 10px;
  border-top: 1px dashed black;
}

.form {
  margin-top: 20px;
}</code></pre></div><ul class="list" id="-1119023943#ewdids_67" start="1"><li class="list-item" id="-1119023943#ewdids_93"><section><h4 id="-1119023943#src-components-otherpage-jsx" data-toc="src-components-otherpage-jsx#Dockerizing-React-Node-Nginx.md-src-components-otherpage-jsx">src/Components/OtherPage.jsx</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_68"><pre><code class="language-javascript">import { Link } from &quot;react-router-dom&quot;;

function OtherPage() {
  return (
    &lt;div&gt;
      I'm another page!
      &lt;br /&gt;
      &lt;br /&gt;
      &lt;Link to=&quot;/&quot;&gt;Go back to home screen&lt;/Link&gt;
    &lt;/div&gt;
  );
}

export default OtherPage;</code></pre></div></section><section><h3 id="-1119023943#4-configuration-files" data-toc="4-configuration-files#Dockerizing-React-Node-Nginx.md-4-configuration-files">4. Configuration Files</h3><ul class="list" id="-1119023943#ewdids_97" start="1"><li class="list-item" id="-1119023943#ewdids_101"><section><h4 id="-1119023943#dockerignore" data-toc="dockerignore#Dockerizing-React-Node-Nginx.md-dockerignore">.dockerignore</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_98"><pre><code class="language-none">node_modules
build
.git
.gitignore
Dockerfile
Dockerfile.dev
.dockerignore
*.log
.DS_Store
.git</code></pre></div><ul class="list" id="-1119023943#ewdids_99" start="1"><li class="list-item" id="-1119023943#ewdids_105"><section><h4 id="-1119023943#gitignore" data-toc="gitignore#Dockerizing-React-Node-Nginx.md-gitignore">.gitignore</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_100"><pre><code class="language-none"># Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?</code></pre></div></section><section><h3 id="-1119023943#4-adjust-the-vite-config-js-config" data-toc="4-adjust-the-vite-config-js-config#Dockerizing-React-Node-Nginx.md-4-adjust-the-vite-config-js-config">4. Adjust the vite.config.js config</h3><ul class="list" id="-1119023943#ewdids_109" start="1"><li class="list-item" id="-1119023943#ewdids_111"><section><h4 id="-1119023943#vite-config-js" data-toc="vite-config-js#Dockerizing-React-Node-Nginx.md-vite-config-js">vite.config.js</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_110"><pre><code class="language-javascript">import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
export default defineConfig({
  plugins: [react()],
  server: {
    host: true,
    port: 5173,
    watch: {
      usePolling: true
    }
  }
})</code></pre></div></section><section><h3 id="-1119023943#5-add-the-docker-files" data-toc="5-add-the-docker-files#Dockerizing-React-Node-Nginx.md-5-add-the-docker-files">5. Add the docker files</h3><ul class="list" id="-1119023943#ewdids_115" start="1"><li class="list-item" id="-1119023943#ewdids_117"><section><h4 id="-1119023943#docker-dev" data-toc="docker-dev#Dockerizing-React-Node-Nginx.md-docker-dev">Docker.dev</h4></section></li></ul><div class="detached code-block" id="-1119023943#ewdids_116"><pre><code class="language-dockerfile"># Use an official Node.js runtime as a parent image                       
FROM node:20.16.0-alpine                                                  
# Set the working directory in the container                              
WORKDIR /app                                                              
# Install dependencies                                                    
COPY package.json pnpm-lock.yaml ./                                       
# Copy the rest of the application code                                   
COPY . .                                                                  
# Expose port 5173 (default Vite port)                                    
EXPOSE 5173                                                               
# Command to run the development server                                   
CMD [&quot;npm&quot;, &quot;run&quot;, &quot;dev&quot;]</code></pre></div></section></section><section><h2 id="-1119023943#build-the-docker-image" data-toc="build-the-docker-image#Dockerizing-React-Node-Nginx.md-build-the-docker-image">Build the Docker Image</h2><p id="-1119023943#ewdids_121">Navigate to the root directory of your project where the Dockerfile.dev is located. Run the following command to build the Docker image for development:</p><div class="detached code-block" id="-1119023943#ewdids_122"><pre><code class="language-bash">docker build -t my-react-app-dev -f Dockerfile.dev .</code></pre></div><p id="-1119023943#ewdids_123">This command tells Docker to:</p><p id="-1119023943#ewdids_124">-t client: Tag the image as my-react-app-dev. -f Dockerfile.dev: Use the Dockerfile.dev file for building the image.</p></section><section><h2 id="-1119023943#run-the-docker-container" data-toc="run-the-docker-container#Dockerizing-React-Node-Nginx.md-run-the-docker-container">Run the Docker Container</h2><p id="-1119023943#ewdids_125">After building the image, you can run the container with the following command:</p><div class="detached code-block" id="-1119023943#ewdids_126"><pre><code class="language-bash">docker run -it --rm -p 5173:5173 client</code></pre></div><p id="-1119023943#ewdids_127">Explanation:</p><ul class="list" id="-1119023943#ewdids_128" start="1"><li class="list-item" id="-1119023943#ewdids_129"><p><span class="control" id="-1119023943#ewdids_131">-it</span>: Runs the container interactively.</p></li><li class="list-item" id="-1119023943#ewdids_130"><p><span class="control" id="-1119023943#ewdids_132">--rm</span>: Automatically removes the container when it exits. -p <span class="inline-code" id="-1119023943#ewdids_133">5173:5173</span>: Maps port 5173 on your local machine to port 5173 in the container, which is where the Vite development server will be running.</p></li></ul></section><section><h2 id="-1119023943#node-express-folder-file-structure" data-toc="node-express-folder-file-structure#Dockerizing-React-Node-Nginx.md-node-express-folder-file-structure">Node Express Folder &amp; File Structure</h2><p id="-1119023943#ewdids_134">Here's a guide to create an Express.js application, dockerizing it for development, and managing environment variables securely using a <span class="inline-code" id="-1119023943#ewdids_144">keys.js</span> file.</p><div class="container"><figure class="image-container"><img class="center image image-size" id="-1119023943#ewdids_135" alt="serverfolderstructure.png" title="serverfolderstructure.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/serverfolderstructure.png" width="292" height="214"><figcaption class="center-text">serverfolderstructure.png</figcaption></figure></div><section><h3 id="-1119023943#step-1-set-up-the-project-directory" data-toc="step-1-set-up-the-project-directory#Dockerizing-React-Node-Nginx.md-step-1-set-up-the-project-directory">Step 1: Set Up the Project Directory</h3><div class="detached code-block" id="-1119023943#ewdids_145"><pre><code class="language-bash">server/
 node_modules/ 
 .dockerignore 
 Dockerfile.dev 
 index.js
 keys.js 
 package.json
 pnpm-lock.yaml
 .gitignore</code></pre></div><p id="-1119023943#ewdids_146">Create a new directory for your project:</p><div class="detached code-block" id="-1119023943#ewdids_147"><pre><code class="language-bash">mkdir express-postgres-app
cd express-postgres-app</code></pre></div></section><section><h3 id="-1119023943#step-2-initialize-the-node-js-project" data-toc="step-2-initialize-the-node-js-project#Dockerizing-React-Node-Nginx.md-step-2-initialize-the-node-js-project">Step 2: Initialize the Node.js Project</h3><p id="-1119023943#ewdids_148">Run the following command to initialize a new Node.js project:</p><div class="detached code-block" id="-1119023943#ewdids_149"><pre><code class="language-bash">npm init -y</code></pre></div><p id="-1119023943#ewdids_150">This will create a <span class="inline-code" id="-1119023943#ewdids_151">package.json</span> file with default settings.</p></section><section><h3 id="-1119023943#step-3-install-dependencies" data-toc="step-3-install-dependencies#Dockerizing-React-Node-Nginx.md-step-3-install-dependencies">Step 3: Install Dependencies</h3><p id="-1119023943#ewdids_152">Install the required dependencies: Express, PostgreSQL client (pg), CORS, and body-parser:</p><div class="detached code-block" id="-1119023943#ewdids_153"><pre><code class="language-bash">npm install express pg cors body-parser</code></pre></div></section><section><h3 id="-1119023943#step-4-create-the-application-files" data-toc="step-4-create-the-application-files#Dockerizing-React-Node-Nginx.md-step-4-create-the-application-files">Step 4: Create the Application Files</h3><section><h4 id="-1119023943#1-create-index-js" data-toc="1-create-index-js#Dockerizing-React-Node-Nginx.md-1-create-index-js">1. Create index.js</h4><p id="-1119023943#ewdids_157">In the root of your project directory, create a file named <span class="inline-code" id="-1119023943#ewdids_161">index.js</span> and add the following code:</p><div class="detached code-block" id="-1119023943#ewdids_158"><pre><code class="language-javascript">const keys = require(&quot;./keys&quot;);
const express = require(&quot;express&quot;);
const bodyParser = require(&quot;body-parser&quot;);
const cors = require(&quot;cors&quot;);
const { Pool } = require(&quot;pg&quot;);

const app = express();

// Middlewares
app.use(cors());
app.use(bodyParser.json());

// Postgres client setup
const pgClient = new Pool({
  user: keys.pgUser,
  host: keys.pgHost,
  database: keys.pgDatabase,
  password: keys.pgPassword,
  port: keys.pgPort
});

pgClient.on(&quot;connect&quot;, client =&gt; {
  client.query(&quot;CREATE TABLE IF NOT EXISTS values (number INT)&quot;)
    .catch(err =&gt; console.log(&quot;PG ERROR&quot;, err));
});

// Express route definitions
app.get(&quot;/&quot;, (req, res) =&gt; {
  res.send(&quot;Hi&quot;);
});

// Get all values
app.get(&quot;/values/all&quot;, async (req, res) =&gt; {
  const values = await pgClient.query(&quot;SELECT * FROM values&quot;);
  res.send(values.rows);
});

// Insert a new value
app.post(&quot;/values&quot;, async (req, res) =&gt; {
  if (!req.body.value) return res.send({ working: false });

  await pgClient.query(&quot;INSERT INTO values(number) VALUES($1)&quot;, [req.body.value]);

  res.send({ working: true });
});

app.listen(8000, () =&gt; {
  console.log(&quot;Listening on port 8000&quot;);
});</code></pre></div></section><section><h4 id="-1119023943#2-create-keys-js" data-toc="2-create-keys-js#Dockerizing-React-Node-Nginx.md-2-create-keys-js">2. Create keys.js</h4><p id="-1119023943#ewdids_163">Create a file named <span class="inline-code" id="-1119023943#ewdids_168">keys.js</span> in the root directory with the following content:</p><div class="detached code-block" id="-1119023943#ewdids_164"><pre><code class="language-javascript">module.exports = {
  pgUser: process.env.PGUSER,
  pgHost: process.env.PGHOST,
  pgDatabase: process.env.PGDATABASE,
  pgPassword: process.env.PGPASSWORD,
  pgPort: process.env.PGPORT
};</code></pre></div><p id="-1119023943#ewdids_165">This file securely references environment variables for your PostgreSQL connection.</p></section></section><section><h3 id="-1119023943#step-5-create-docker-configuration" data-toc="step-5-create-docker-configuration#Dockerizing-React-Node-Nginx.md-step-5-create-docker-configuration">Step 5: Create Docker Configuration</h3><section><h4 id="-1119023943#1-create-dockerfile-dev" data-toc="1-create-dockerfile-dev#Dockerizing-React-Node-Nginx.md-1-create-dockerfile-dev">1. Create Dockerfile.dev</h4><p id="-1119023943#ewdids_172">Create a file named <span class="inline-code" id="-1119023943#ewdids_176">Dockerfile.dev</span> in the root directory with the following content:</p><div class="detached code-block" id="-1119023943#ewdids_173"><pre><code class="language-none"># Use Alpine Node.js runtime as a parent image
FROM node:20.16.0-alpine

# Set the working directory in the container
WORKDIR /app

# Copy package.json and pnpm-lock.yaml (or package-lock.json)
COPY package*.json pnpm-lock.yaml ./

# Install dependencies
RUN npm install

# Copy the rest of the application code
COPY . .

# Expose port 8000
EXPOSE 8000

# Command to run the application
CMD [&quot;npm&quot;, &quot;run&quot;, &quot;dev&quot;]</code></pre></div></section><section><h4 id="-1119023943#2-create-dockerignore" data-toc="2-create-dockerignore#Dockerizing-React-Node-Nginx.md-2-create-dockerignore">2. Create .dockerignore</h4><p id="-1119023943#ewdids_178">Create a <span class="inline-code" id="-1119023943#ewdids_182">.dockerignore</span> file to ensure unnecessary files aren't copied into the Docker image:</p><div class="detached code-block" id="-1119023943#ewdids_179"><pre><code class="language-none">node_modules
build
.git
.gitignore
Dockerfile
Dockerfile.dev
.dockerignore
*.log
.DS_Store
.git</code></pre></div></section></section><section><h3 id="-1119023943#step-6-define-the-npm-scripts" data-toc="step-6-define-the-npm-scripts#Dockerizing-React-Node-Nginx.md-step-6-define-the-npm-scripts">Step 6: Define the NPM Scripts</h3><p id="-1119023943#ewdids_183">Open your <span class="inline-code" id="-1119023943#ewdids_189">package.json</span> and add a script for running the development server:</p><div class="detached code-block" id="-1119023943#ewdids_184"><pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node index.js&quot;,  
    &quot;dev&quot;: &quot;nodemon index.js&quot;   
  }     
}</code></pre></div><p id="-1119023943#ewdids_185">Ensure you have nodemon installed globally or as a dev dependency:</p><div class="detached code-block" id="-1119023943#ewdids_186"><pre><code class="language-bash">npm install -g nodemon</code></pre></div><p id="-1119023943#ewdids_187">Or:</p><div class="detached code-block" id="-1119023943#ewdids_188"><pre><code class="language-bash">npm install --save-dev nodemon</code></pre></div></section><section><h3 id="-1119023943#step-7-running-the-application-with-docker" data-toc="step-7-running-the-application-with-docker#Dockerizing-React-Node-Nginx.md-step-7-running-the-application-with-docker">Step 7: Running the Application with Docker</h3><section><h4 id="-1119023943#1-build-the-docker-image" data-toc="1-build-the-docker-image#Dockerizing-React-Node-Nginx.md-1-build-the-docker-image">1. Build the Docker Image</h4><p id="-1119023943#ewdids_193">Run the following command to build the Docker image using the development Dockerfile:</p><div class="detached code-block" id="-1119023943#ewdids_194"><pre><code class="language-bash">docker build -t server -f Dockerfile.dev .</code></pre></div></section><section><h4 id="-1119023943#2-run-the-docker-container" data-toc="2-run-the-docker-container#Dockerizing-React-Node-Nginx.md-2-run-the-docker-container">2. Run the Docker Container</h4><p id="-1119023943#ewdids_197">Run the Docker container:</p><div class="detached code-block" id="-1119023943#ewdids_198"><pre><code class="language-bash">docker run -it --rm -p 8000:8000 server</code></pre></div><p id="-1119023943#ewdids_199">Explanation:</p><ul class="list" id="-1119023943#ewdids_200" start="1"><li class="list-item" id="-1119023943#ewdids_202"><p><span class="inline-code" id="-1119023943#ewdids_203">-p 8000:8000</span>: Maps port 8000 on your machine to port 8000 in the container.</p></li></ul></section></section><section><h3 id="-1119023943#step-8-test-the-application" data-toc="step-8-test-the-application#Dockerizing-React-Node-Nginx.md-step-8-test-the-application">Step 8: Test the Application</h3><p id="-1119023943#ewdids_204">Open your browser or use a tool like Postman to test the endpoints:</p><ul class="list" id="-1119023943#ewdids_205" start="1"><li class="list-item" id="-1119023943#ewdids_206"><p><span class="control" id="-1119023943#ewdids_207">GET</span> request to <span class="inline-code" id="-1119023943#ewdids_208">http://localhost:8000/</span> should return &quot;Hi&quot;.</p></li></ul></section></section><section><h2 id="-1119023943#nginx-file-structure" data-toc="nginx-file-structure#Dockerizing-React-Node-Nginx.md-nginx-file-structure">NGINX &amp; File structure</h2><p id="-1119023943#ewdids_209">Nginx as a reverse proxy to route traffic between a React frontend (client) and an Express backend (API), using Docker. The configuration involves two files: default.conf (Nginx configuration) and Dockerfile.dev (Docker configuration for Nginx).</p><ul class="list" id="-1119023943#ewdids_210" start="1"><li class="list-item" id="-1119023943#ewdids_218"><p>Step 1: The structure looks like this:</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_211"><pre><code class="language-bash">nginx/
 default.conf          # Nginx configuration file
 Dockerfile.dev        # Dockerfile for building the Nginx image</code></pre></div><ul class="list" id="-1119023943#ewdids_212" start="1"><li class="list-item" id="-1119023943#ewdids_219"><p>Step 2: Configure default.conf for Nginx The default.conf file is an Nginx configuration file that routes traffic based on the request paths. Here&rsquo;s what the configuration does:</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_213"><pre><code class="language-javascript">upstream client {
    server client:5173;
}

upstream api {
    server api:8000;
}

server {
    listen 80;

    location / {
        proxy_pass http://client;
    }

    location /sockjs-node {
        proxy_pass http://client;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;Upgrade&quot;;
    }

    location /api {
        rewrite /api/(.*) /$1 break;
        proxy_pass http://api;
    }
}</code></pre></div><p id="-1119023943#ewdids_214">Explanation:</p><ul class="list" id="-1119023943#ewdids_215" start="1"><li class="list-item" id="-1119023943#ewdids_220"><p id="-1119023943#ewdids_223">Upstream Sections:</p><ul class="list" id="-1119023943#ewdids_224" start="1"><li class="list-item" id="-1119023943#ewdids_225"><p>upstream client: Defines a group of servers for the React frontend running on port 5173.</p></li><li class="list-item" id="-1119023943#ewdids_226"><p>upstream api: Defines a group of servers for the Express backend running on port 8000.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_221"><p id="-1119023943#ewdids_227">Server Block:</p><ul class="list" id="-1119023943#ewdids_228" start="1"><li class="list-item" id="-1119023943#ewdids_229"><p>listen 80: Configures Nginx to listen on port 80 (standard HTTP port).</p></li><li class="list-item" id="-1119023943#ewdids_230"><p>location /: Routes root URL requests to the React client.</p></li><li class="list-item" id="-1119023943#ewdids_231"><p>location /sockjs-node: Special handling for WebSocket connections, typically used for hot-reloading in development.</p></li><li class="list-item" id="-1119023943#ewdids_232"><p>location /api: Routes /api requests to the Express backend, rewriting the URL to strip the /api prefix.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_222"><p id="-1119023943#ewdids_233">Step 3: Create the Dockerfile.dev for Nginx The Dockerfile.dev will build a Docker image for Nginx that uses your custom configuration. The Dockerfile content is:</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_216"><pre><code class="language-dockerfile">FROM nginx
COPY ./default.conf /etc/nginx/conf.d/default.conf</code></pre></div><section><h3 id="-1119023943#step-by-step-guide-for-configuring-nginx-with-docker" data-toc="step-by-step-guide-for-configuring-nginx-with-docker#Dockerizing-React-Node-Nginx.md-step-by-step-guide-for-configuring-nginx-with-docker">Step-by-Step Guide for Configuring Nginx with Docker</h3><p id="-1119023943#ewdids_234">This guide walks you through setting up Nginx as a reverse proxy to route traffic between a React frontend (client) and an Express backend (API), using Docker. The configuration involves two files: <span class="inline-code" id="-1119023943#ewdids_238">default.conf</span> (Nginx configuration) and <span class="inline-code" id="-1119023943#ewdids_239">Dockerfile.dev</span> (Docker configuration for Nginx).</p><section><h4 id="-1119023943#step-1-understand-the-project-structure" data-toc="step-1-understand-the-project-structure#Dockerizing-React-Node-Nginx.md-step-1-understand-the-project-structure">Step 1: Understand the Project Structure</h4><p id="-1119023943#ewdids_240">From the provided image, the structure looks like this:</p><div class="detached code-block" id="-1119023943#ewdids_241"><pre><code class="language-none">nginx/
 default.conf          # Nginx configuration file
 Dockerfile.dev        # Dockerfile for building the Nginx image</code></pre></div></section><section><h4 id="-1119023943#step-2-configure-default-conf-for-nginx" data-toc="step-2-configure-default-conf-for-nginx#Dockerizing-React-Node-Nginx.md-step-2-configure-default-conf-for-nginx">Step 2: Configure default.conf for Nginx</h4><p id="-1119023943#ewdids_243">The <span class="inline-code" id="-1119023943#ewdids_248">default.conf</span> file is an Nginx configuration file that routes traffic based on the request paths. Here&rsquo;s what the configuration does:</p><div class="detached code-block" id="-1119023943#ewdids_244"><pre><code class="language-nginx">upstream client {
    server client:5173;
}

upstream api {
    server api:8000;
}

server {
    listen 80;

    location / {
        proxy_pass http://client;
    }

    location /sockjs-node {
        proxy_pass http://client;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;Upgrade&quot;;
    }

    location /api {
        rewrite /api/(.*) /$1 break;
        proxy_pass http://api;
    }
}</code></pre></div><p id="-1119023943#ewdids_245"><span class="control" id="-1119023943#ewdids_249">Explanation:</span></p><ul class="list" id="-1119023943#ewdids_246" start="1"><li class="list-item" id="-1119023943#ewdids_250"><p id="-1119023943#ewdids_252"><span class="control" id="-1119023943#ewdids_254">Upstream Sections</span>:</p><ul class="list" id="-1119023943#ewdids_253" start="1"><li class="list-item" id="-1119023943#ewdids_255"><p><span class="inline-code" id="-1119023943#ewdids_257">upstream client</span>: Defines a group of servers for the React frontend running on port 5173.</p></li><li class="list-item" id="-1119023943#ewdids_256"><p><span class="inline-code" id="-1119023943#ewdids_258">upstream api</span>: Defines a group of servers for the Express backend running on port 8000.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_251"><p id="-1119023943#ewdids_259"><span class="control" id="-1119023943#ewdids_261">Server Block</span>:</p><ul class="list" id="-1119023943#ewdids_260" start="1"><li class="list-item" id="-1119023943#ewdids_262"><p><span class="control" id="-1119023943#ewdids_266">listen 80</span>: Configures Nginx to listen on port 80 (standard HTTP port).</p></li><li class="list-item" id="-1119023943#ewdids_263"><p><span class="control" id="-1119023943#ewdids_267">location /</span>: Routes root URL requests to the React client.</p></li><li class="list-item" id="-1119023943#ewdids_264"><p><span class="control" id="-1119023943#ewdids_268">location /sockjs-node</span>: Special handling for WebSocket connections, typically used for hot-reloading in development.</p></li><li class="list-item" id="-1119023943#ewdids_265"><p><span class="control" id="-1119023943#ewdids_269">location /api</span>: Routes <span class="inline-code" id="-1119023943#ewdids_270">/api</span> requests to the Express backend, rewriting the URL to strip the <span class="inline-code" id="-1119023943#ewdids_271">/api</span> prefix.</p></li></ul></li></ul></section><section><h4 id="-1119023943#step-3-create-the-dockerfile-dev-for-nginx" data-toc="step-3-create-the-dockerfile-dev-for-nginx#Dockerizing-React-Node-Nginx.md-step-3-create-the-dockerfile-dev-for-nginx">Step 3: Create the Dockerfile.dev for Nginx</h4><p id="-1119023943#ewdids_273">The <span class="inline-code" id="-1119023943#ewdids_278">Dockerfile.dev</span> will build a Docker image for Nginx that uses your custom configuration. The Dockerfile content is:</p><div class="detached code-block" id="-1119023943#ewdids_274"><pre><code class="language-none">FROM nginx
COPY ./default.conf /etc/nginx/conf.d/default.conf</code></pre></div><p id="-1119023943#ewdids_275"><span class="control" id="-1119023943#ewdids_279">Explanation:</span></p><ul class="list" id="-1119023943#ewdids_276" start="1"><li class="list-item" id="-1119023943#ewdids_280"><p><span class="control" id="-1119023943#ewdids_282">FROM nginx</span>: This uses the official Nginx image as the base image.</p></li><li class="list-item" id="-1119023943#ewdids_281"><p><span class="control" id="-1119023943#ewdids_283">COPY ./default.conf /etc/nginx/conf.d/default.conf</span>: Copies your custom Nginx configuration file (<span class="inline-code" id="-1119023943#ewdids_284">default.conf</span>) into the appropriate directory inside the Nginx container (<span class="inline-code" id="-1119023943#ewdids_285">/etc/nginx/conf.d/default.conf</span>), replacing the default configuration.</p></li></ul></section></section></section><section><h2 id="-1119023943#combined-project-structure-with-docker-compose" data-toc="combined-project-structure-with-docker-compose#Dockerizing-React-Node-Nginx.md-combined-project-structure-with-docker-compose">Combined Project Structure with Docker Compose</h2><p id="-1119023943#ewdids_286">Here's how to combine your <span class="inline-code" id="-1119023943#ewdids_291">client</span>, <span class="inline-code" id="-1119023943#ewdids_292">server</span>, and <span class="inline-code" id="-1119023943#ewdids_293">nginx</span> components into a single project structure with a <span class="inline-code" id="-1119023943#ewdids_294">docker-compose.yml</span> file that orchestrates the services. This structure is typical for a full-stack application setup using Docker Compose.</p><section><h3 id="-1119023943#project-structure" data-toc="project-structure#Dockerizing-React-Node-Nginx.md-project-structure">Project Structure</h3><div class="detached code-block" id="-1119023943#ewdids_295"><pre><code class="language-none">my-app/
 client/                   # React frontend
    Dockerfile.dev        # Dockerfile for the React app (development)
    src/                  # Source code for React
    public/               # Public assets for React
    package.json          # Package configuration for React
    ...                   # Other React files and folders
 server/                   # Express backend
    Dockerfile.dev        # Dockerfile for the Express app (development)
    index.js              # Main entry point for the Express server
    keys.js               # Environment configuration file
    package.json          # Package configuration for Express
    ...                   # Other server files and folders
 nginx/                    # Nginx reverse proxy
    default.conf          # Nginx configuration file
    Dockerfile.dev        # Dockerfile for Nginx (development)
 docker-compose.yml        # Docker Compose configuration file</code></pre></div></section><section><h3 id="-1119023943#docker-compose-yml" data-toc="docker-compose-yml#Dockerizing-React-Node-Nginx.md-docker-compose-yml">docker-compose.yml</h3><p id="-1119023943#ewdids_297">Below is the <span class="inline-code" id="-1119023943#ewdids_300">docker-compose.yml</span> file that defines all the services:</p><div class="detached code-block" id="-1119023943#ewdids_298"><pre><code class="language-yaml">version: &quot;3.8&quot;
services:
  postgres:
    image: &quot;postgres:latest&quot;
    environment:
      - POSTGRES_PASSWORD=postgres_password
    ports:
      - &quot;5432:5432&quot;
    restart: always

  nginx:
    container_name: nginx
    build:
      context: ./nginx
      dockerfile: Dockerfile.dev  # Change to `Dockerfile` for production
    ports:
      - &quot;3500:80&quot;
    depends_on:
      - api
      - client
    restart: always    

  api:
    build:
      context: &quot;./server&quot;
      dockerfile: Dockerfile.dev # Change to `Dockerfile` for production
    volumes:
      - /app/node_modules
      - ./server:/app
    environment:
      - PGUSER=postgres
      - PGHOST=postgres
      - PGDATABASE=postgres
      - PGPASSWORD=postgres_password
      - PGPORT=5432
    depends_on:
      - postgres
    ports:
      - &quot;8000:8000&quot;
    restart: always

  client:
    stdin_open: true
    build:
      context: ./client
      dockerfile: Dockerfile.dev # Change to `Dockerfile` for production
    volumes:
      - /app/node_modules
      - ./client:/app
    ports:
      - &quot;5173:5173&quot;
    depends_on:
      - api
    restart: always</code></pre></div></section><section><h3 id="-1119023943#explanation-of-the-docker-compose-yml-services" data-toc="explanation-of-the-docker-compose-yml-services#Dockerizing-React-Node-Nginx.md-explanation-of-the-docker-compose-yml-services">Explanation of the docker-compose.yml Services</h3><ol class="list list-decimal" id="-1119023943#ewdids_302" type="1" start="1"><li class="list-item" id="-1119023943#ewdids_304"><p id="-1119023943#ewdids_308"><span class="control" id="-1119023943#ewdids_310">Postgres</span>:</p><ul class="list" id="-1119023943#ewdids_309" start="1"><li class="list-item" id="-1119023943#ewdids_311"><p>This service runs the PostgreSQL database.</p></li><li class="list-item" id="-1119023943#ewdids_312"><p><span class="inline-code" id="-1119023943#ewdids_315">environment</span>: Sets the environment variable <span class="inline-code" id="-1119023943#ewdids_316">POSTGRES_PASSWORD</span> to <span class="inline-code" id="-1119023943#ewdids_317">postgres_password</span> for the database.</p></li><li class="list-item" id="-1119023943#ewdids_313"><p><span class="inline-code" id="-1119023943#ewdids_318">ports</span>: Exposes port <span class="inline-code" id="-1119023943#ewdids_319">5432</span> for database connections.</p></li><li class="list-item" id="-1119023943#ewdids_314"><p><span class="inline-code" id="-1119023943#ewdids_320">restart: always</span>: Ensures the container restarts automatically in case of a failure.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_305"><p id="-1119023943#ewdids_321"><span class="control" id="-1119023943#ewdids_323">Nginx</span>:</p><ul class="list" id="-1119023943#ewdids_322" start="1"><li class="list-item" id="-1119023943#ewdids_324"><p>Acts as a reverse proxy, routing requests to the <span class="inline-code" id="-1119023943#ewdids_328">client</span> (React frontend) and <span class="inline-code" id="-1119023943#ewdids_329">api</span> (Express backend) services.</p></li><li class="list-item" id="-1119023943#ewdids_325"><p><span class="inline-code" id="-1119023943#ewdids_330">build</span>: Builds the Nginx image from the <span class="inline-code" id="-1119023943#ewdids_331">Dockerfile.dev</span> located in the <span class="inline-code" id="-1119023943#ewdids_332">nginx</span> directory.</p></li><li class="list-item" id="-1119023943#ewdids_326"><p><span class="inline-code" id="-1119023943#ewdids_333">ports</span>: Exposes port <span class="inline-code" id="-1119023943#ewdids_334">3500</span> on the host, mapping it to port <span class="inline-code" id="-1119023943#ewdids_335">80</span> inside the container (where Nginx listens).</p></li><li class="list-item" id="-1119023943#ewdids_327"><p><span class="inline-code" id="-1119023943#ewdids_336">depends_on</span>: Ensures that the <span class="inline-code" id="-1119023943#ewdids_337">api</span> and <span class="inline-code" id="-1119023943#ewdids_338">client</span> services are started before Nginx.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_306"><p id="-1119023943#ewdids_339"><span class="control" id="-1119023943#ewdids_341">API (Express)</span>:</p><ul class="list" id="-1119023943#ewdids_340" start="1"><li class="list-item" id="-1119023943#ewdids_342"><p>Runs the Express server.</p></li><li class="list-item" id="-1119023943#ewdids_343"><p><span class="inline-code" id="-1119023943#ewdids_348">build</span>: Builds the Express image from the <span class="inline-code" id="-1119023943#ewdids_349">Dockerfile.dev</span> located in the <span class="inline-code" id="-1119023943#ewdids_350">server</span> directory.</p></li><li class="list-item" id="-1119023943#ewdids_344"><p><span class="inline-code" id="-1119023943#ewdids_351">volumes</span>: Mounts the <span class="inline-code" id="-1119023943#ewdids_352">server</span> directory and <span class="inline-code" id="-1119023943#ewdids_353">node_modules</span> for hot-reloading in development.</p></li><li class="list-item" id="-1119023943#ewdids_345"><p><span class="inline-code" id="-1119023943#ewdids_354">environment</span>: Passes PostgreSQL connection environment variables to the Express server.</p></li><li class="list-item" id="-1119023943#ewdids_346"><p><span class="inline-code" id="-1119023943#ewdids_355">depends_on</span>: Ensures that the PostgreSQL service is up and running before the API service starts.</p></li><li class="list-item" id="-1119023943#ewdids_347"><p><span class="inline-code" id="-1119023943#ewdids_356">ports</span>: Exposes port <span class="inline-code" id="-1119023943#ewdids_357">8000</span> for the Express API.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_307"><p id="-1119023943#ewdids_358"><span class="control" id="-1119023943#ewdids_360">Client (React)</span>:</p><ul class="list" id="-1119023943#ewdids_359" start="1"><li class="list-item" id="-1119023943#ewdids_361"><p>Runs the React frontend.</p></li><li class="list-item" id="-1119023943#ewdids_362"><p><span class="inline-code" id="-1119023943#ewdids_366">build</span>: Builds the React image from the <span class="inline-code" id="-1119023943#ewdids_367">Dockerfile.dev</span> located in the <span class="inline-code" id="-1119023943#ewdids_368">client</span> directory.</p></li><li class="list-item" id="-1119023943#ewdids_363"><p><span class="inline-code" id="-1119023943#ewdids_369">volumes</span>: Mounts the <span class="inline-code" id="-1119023943#ewdids_370">client</span> directory and <span class="inline-code" id="-1119023943#ewdids_371">node_modules</span> for hot-reloading in development.</p></li><li class="list-item" id="-1119023943#ewdids_364"><p><span class="inline-code" id="-1119023943#ewdids_372">ports</span>: Exposes port <span class="inline-code" id="-1119023943#ewdids_373">5173</span> for the React development server.</p></li><li class="list-item" id="-1119023943#ewdids_365"><p><span class="inline-code" id="-1119023943#ewdids_374">depends_on</span>: Ensures the API service is running before the Client starts.</p></li></ul></li></ol></section><section><h3 id="-1119023943#step-by-step-setup-and-execution" data-toc="step-by-step-setup-and-execution#Dockerizing-React-Node-Nginx.md-step-by-step-setup-and-execution">Step-by-Step Setup and Execution</h3><ol class="list list-decimal" id="-1119023943#ewdids_375" type="1" start="1"><li class="list-item" id="-1119023943#ewdids_377"><p id="-1119023943#ewdids_379"><span class="control" id="-1119023943#ewdids_381">Build and Start Services</span>:</p><ul class="list" id="-1119023943#ewdids_380" start="1"><li class="list-item" id="-1119023943#ewdids_382"><p id="-1119023943#ewdids_384">Navigate to the root directory (<span class="inline-code" id="-1119023943#ewdids_386">my-app/</span>) and run the following command to build and start all services:</p><div class="detached code-block" id="-1119023943#ewdids_385"><pre><code class="language-bash">docker-compose up --build</code></pre></div></li><li class="list-item" id="-1119023943#ewdids_383"><p id="-1119023943#ewdids_387">The <span class="inline-code" id="-1119023943#ewdids_388">--build</span> flag ensures that Docker builds the images before starting the containers.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_378"><p id="-1119023943#ewdids_389"><span class="control" id="-1119023943#ewdids_391">Access the Application</span>:</p><ul class="list" id="-1119023943#ewdids_390" start="1"><li class="list-item" id="-1119023943#ewdids_392"><p>Visit <span class="inline-code" id="-1119023943#ewdids_394">http://localhost:3500</span> in your browser to access the frontend, which is proxied through Nginx.</p></li><li class="list-item" id="-1119023943#ewdids_393"><p>The React frontend interacts with the Express backend via the <span class="inline-code" id="-1119023943#ewdids_395">/api</span> route, as defined in the Nginx configuration.</p></li></ul></li></ol><div class="container"><figure class="image-container"><img class="center image image-size" id="-1119023943#ewdids_376" alt="devwebpreview.png" title="devwebpreview.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/devwebpreview.png" width="1795" height="451"><figcaption class="center-text">devwebpreview.png</figcaption></figure></div></section></section><section><h2 id="-1119023943#production-mode" data-toc="production-mode#Dockerizing-React-Node-Nginx.md-production-mode">Production Mode</h2><p id="-1119023943#ewdids_396">We are going to use all files in the development mode but make a couple of changes.ie our docker files will be <span class="inline-code" id="-1119023943#ewdids_407">Docker</span> instead of <span class="inline-code" id="-1119023943#ewdids_408">Docker.dev</span></p><div class="container"><figure class="image-container"><img class="center image image-size" id="-1119023943#ewdids_397" alt="prod.png" title="prod.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/prod.png" width="1271" height="592"><figcaption class="center-text">prod.png</figcaption></figure></div><section><h3 id="-1119023943#1-client-nginx-default-conf" data-toc="1-client-nginx-default-conf#Dockerizing-React-Node-Nginx.md-1-client-nginx-default-conf">1. ./client/nginx/default.conf</h3><ul class="list" id="-1119023943#ewdids_410" start="1"><li class="list-item" id="-1119023943#ewdids_413"><p>Create Nginx folder in client folder and add <span class="inline-code" id="-1119023943#ewdids_414">default.conf</span> with this code</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_411"><pre><code class="language-javascript">server {
    listen 5173;

    location / {
        root /usr/share/nginx/html;
        index index.html index.html;
        try_files $uri/ $uri/ /index.html
    }
}</code></pre></div></section><section><h3 id="-1119023943#2-client-docker" data-toc="2-client-docker#Dockerizing-React-Node-Nginx.md-2-client-docker">2. ./client/Docker</h3><ul class="list" id="-1119023943#ewdids_416" start="1"><li class="list-item" id="-1119023943#ewdids_421"><p>inside the client folder, add a <span class="inline-code" id="-1119023943#ewdids_422">Docker</span> file</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_417"><pre><code class="language-dockerfile">#use alpine Node.js runtime as a parent image and name it as builder
FROM node:20.16.0-alpine as builder

# Set the working directory in the container
WORKDIR /app

# Copy package.json and package-lock.json
COPY package*.json ./

# Install dependencies
RUN npm i

# Copy the rest of the application code
COPY . .

RUN npm run build

FROM nginx

# Expose port 5173
EXPOSE 5173
# copy nginx configuration to the docker image
COPY ./nginx/default.conf /etc/nginx/conf.d/default.conf
# copy all builded files
COPY --from=builder /app/build /usr/share/nginx/html</code></pre></div><p id="-1119023943#ewdids_418">Summary in bullet points:</p><ul class="list" id="-1119023943#ewdids_419" start="1"><li class="list-item" id="-1119023943#ewdids_423"><p id="-1119023943#ewdids_427"><span class="control" id="-1119023943#ewdids_429">Base Image (Builder Stage)</span>:</p><ul class="list" id="-1119023943#ewdids_428" start="1"><li class="list-item" id="-1119023943#ewdids_430"><p>Uses <span class="inline-code" id="-1119023943#ewdids_432">node:20.16.0-alpine</span> as the base image, named as <span class="inline-code" id="-1119023943#ewdids_433">builder</span>.</p></li><li class="list-item" id="-1119023943#ewdids_431"><p>Sets the working directory to <span class="inline-code" id="-1119023943#ewdids_434">/app</span> inside the container.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_424"><p id="-1119023943#ewdids_435"><span class="control" id="-1119023943#ewdids_437">Dependency Installation</span>:</p><ul class="list" id="-1119023943#ewdids_436" start="1"><li class="list-item" id="-1119023943#ewdids_438"><p>Copies <span class="inline-code" id="-1119023943#ewdids_440">package.json</span> and <span class="inline-code" id="-1119023943#ewdids_441">package-lock.json</span> into the container.</p></li><li class="list-item" id="-1119023943#ewdids_439"><p>Installs Node.js dependencies using <span class="inline-code" id="-1119023943#ewdids_442">npm i</span>.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_425"><p id="-1119023943#ewdids_443"><span class="control" id="-1119023943#ewdids_445">Application Code</span>:</p><ul class="list" id="-1119023943#ewdids_444" start="1"><li class="list-item" id="-1119023943#ewdids_446"><p>Copies the entire application code into the container.</p></li><li class="list-item" id="-1119023943#ewdids_447"><p>Runs the build process with <span class="inline-code" id="-1119023943#ewdids_448">npm run build</span>.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_426"><p id="-1119023943#ewdids_449"><span class="control" id="-1119023943#ewdids_451">Final Image (Nginx Stage)</span>:</p><ul class="list" id="-1119023943#ewdids_450" start="1"><li class="list-item" id="-1119023943#ewdids_452"><p>Uses <span class="inline-code" id="-1119023943#ewdids_456">nginx</span> as the final base image.</p></li><li class="list-item" id="-1119023943#ewdids_453"><p>Exposes port <span class="inline-code" id="-1119023943#ewdids_457">5173</span> for the frontend.</p></li><li class="list-item" id="-1119023943#ewdids_454"><p>Copies the Nginx configuration file (<span class="inline-code" id="-1119023943#ewdids_458">default.conf</span>) to the appropriate location in the Nginx container.</p></li><li class="list-item" id="-1119023943#ewdids_455"><p>Copies the built files from the <span class="inline-code" id="-1119023943#ewdids_459">builder</span> stage to the Nginx web root directory (<span class="inline-code" id="-1119023943#ewdids_460">/usr/share/nginx/html</span>).</p></li></ul></li></ul></section><section><h3 id="-1119023943#3-nginx" data-toc="3-nginx#Dockerizing-React-Node-Nginx.md-3-nginx">3. ./nginx</h3><ul class="list" id="-1119023943#ewdids_462" start="1"><li class="list-item" id="-1119023943#ewdids_468"><p>inside the nginx folder create this file <span class="inline-code" id="-1119023943#ewdids_469">default.conf</span> add this code</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_463"><pre><code class="language-javascript">upstream client {
    server client:5173;
}

upstream api {
    server api:8000;
}

server {
    listen 80;

    location / {
        proxy_pass http://client;
    }

    location /sockjs-node {
        proxy_pass http://client;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;Upgrade&quot;;
    }

    location /api {
        rewrite /api/(.*) /$1 break;
        proxy_pass http://api;
    }
}</code></pre></div><p id="-1119023943#ewdids_464">This configuration is for an Nginx server, typically used as a reverse proxy to direct incoming HTTP requests to different backend services based on the request's URL path. Here's a brief explanation:</p><section><h4 id="-1119023943#upstream-client-and-upstream-api" data-toc="upstream-client-and-upstream-api#Dockerizing-React-Node-Nginx.md-upstream-client-and-upstream-api">upstream client { ... } and upstream api { ... }</h4><ul class="list" id="-1119023943#ewdids_471" start="1"><li class="list-item" id="-1119023943#ewdids_474"><p><span class="control" id="-1119023943#ewdids_476"><span class="inline-code" id="-1119023943#ewdids_480">upstream client { server client:5173; }</span></span>: Defines a group of servers (in this case, a single server) that Nginx will forward requests to for the <span class="inline-code" id="-1119023943#ewdids_477">client</span>. The <span class="inline-code" id="-1119023943#ewdids_478">client</span> service is running on port <span class="inline-code" id="-1119023943#ewdids_479">5173</span>.</p></li><li class="list-item" id="-1119023943#ewdids_475"><p><span class="control" id="-1119023943#ewdids_481"><span class="inline-code" id="-1119023943#ewdids_484">upstream api { server api:8000; }</span></span>: Similarly, this defines a group of servers for the <span class="inline-code" id="-1119023943#ewdids_482">api</span>, which runs on port <span class="inline-code" id="-1119023943#ewdids_483">8000</span>.</p></li></ul></section><section><h4 id="-1119023943#server" data-toc="server#Dockerizing-React-Node-Nginx.md-server">server { ... }</h4><p id="-1119023943#ewdids_486">This block defines the configuration for handling incoming requests.</p><p id="-1119023943#ewdids_487">1 <span class="control" id="-1119023943#ewdids_491"><span class="inline-code" id="-1119023943#ewdids_493">listen 80;</span></span>: Configures the server to listen for HTTP requests on port <span class="inline-code" id="-1119023943#ewdids_492">80</span>, the default HTTP port.</p><ul class="list" id="-1119023943#ewdids_488" start="1"><li class="list-item" id="-1119023943#ewdids_494"><p id="-1119023943#ewdids_498"><span class="control" id="-1119023943#ewdids_500"><span class="inline-code" id="-1119023943#ewdids_501">location / { ... }</span></span>:</p><ul class="list" id="-1119023943#ewdids_499" start="1"><li class="list-item" id="-1119023943#ewdids_502"><p>Handles requests to the root (<span class="inline-code" id="-1119023943#ewdids_504">/</span>) path.</p></li><li class="list-item" id="-1119023943#ewdids_503"><p><span class="control" id="-1119023943#ewdids_505"><span class="inline-code" id="-1119023943#ewdids_508">proxy_pass http://client;</span></span>: Forwards these requests to the <span class="inline-code" id="-1119023943#ewdids_506">client</span> service defined earlier, which is the application running on port <span class="inline-code" id="-1119023943#ewdids_507">5173</span>.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_495"><p id="-1119023943#ewdids_509"><span class="control" id="-1119023943#ewdids_511"><span class="inline-code" id="-1119023943#ewdids_512">location /sockjs-node { ... }</span></span>:</p><ul class="list" id="-1119023943#ewdids_510" start="1"><li class="list-item" id="-1119023943#ewdids_513"><p>Handles WebSocket connections, specifically for <span class="inline-code" id="-1119023943#ewdids_517">sockjs-node</span>.</p></li><li class="list-item" id="-1119023943#ewdids_514"><p><span class="control" id="-1119023943#ewdids_518"><span class="inline-code" id="-1119023943#ewdids_520">proxy_pass http://client;</span></span>: Forwards these WebSocket requests to the <span class="inline-code" id="-1119023943#ewdids_519">client</span> service.</p></li><li class="list-item" id="-1119023943#ewdids_515"><p><span class="control" id="-1119023943#ewdids_521"><span class="inline-code" id="-1119023943#ewdids_522">proxy_http_version 1.1;</span></span>: Ensures HTTP/1.1 is used, which is required for WebSocket connections.</p></li><li class="list-item" id="-1119023943#ewdids_516"><p><span class="control" id="-1119023943#ewdids_523"><span class="inline-code" id="-1119023943#ewdids_524">proxy_set_header Upgrade $http_upgrade;</span> and <span class="inline-code" id="-1119023943#ewdids_525">proxy_set_header Connection &quot;Upgrade&quot;;</span></span>: These headers are necessary for handling WebSocket connections, allowing the protocol to be upgraded from HTTP to WebSocket.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_496"><p id="-1119023943#ewdids_526"><span class="control" id="-1119023943#ewdids_528"><span class="inline-code" id="-1119023943#ewdids_529">location /api { ... }</span></span>:</p><ul class="list" id="-1119023943#ewdids_527" start="1"><li class="list-item" id="-1119023943#ewdids_530"><p>Handles requests to the <span class="inline-code" id="-1119023943#ewdids_533">/api</span> path.</p></li><li class="list-item" id="-1119023943#ewdids_531"><p><span class="control" id="-1119023943#ewdids_534"><span class="inline-code" id="-1119023943#ewdids_539">rewrite /api/(.*) /$1 break;</span></span>: This rewrites the URL by stripping the <span class="inline-code" id="-1119023943#ewdids_535">/api</span> prefix before passing it to the <span class="inline-code" id="-1119023943#ewdids_536">api</span> service. For example, a request to <span class="inline-code" id="-1119023943#ewdids_537">/api/users</span> becomes <span class="inline-code" id="-1119023943#ewdids_538">/users</span>.</p></li><li class="list-item" id="-1119023943#ewdids_532"><p><span class="control" id="-1119023943#ewdids_540"><span class="inline-code" id="-1119023943#ewdids_543">proxy_pass http://api;</span></span>: Forwards the rewritten requests to the <span class="inline-code" id="-1119023943#ewdids_541">api</span> service running on port <span class="inline-code" id="-1119023943#ewdids_542">8000</span>.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_497"><p id="-1119023943#ewdids_544">inside the nginx folder create this file <span class="inline-code" id="-1119023943#ewdids_545">Dockerfile</span> add this code</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_489"><pre><code class="language-javascript">FROM nginx
COPY ./default.conf /etc/nginx/conf.d/default.conf</code></pre></div></section></section><section><h3 id="-1119023943#3-server" data-toc="3-server#Dockerizing-React-Node-Nginx.md-3-server">3. ./server</h3><ul class="list" id="-1119023943#ewdids_547" start="1"><li class="list-item" id="-1119023943#ewdids_550"><p>inside the server folder create this file <span class="inline-code" id="-1119023943#ewdids_551">Dockerfile</span> add this code</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_548"><pre><code class="language-dockerfile">#use alpine Node.js runtime as a parent image
FROM node:20.16.0-alpine

# Set the working directory in the container
WORKDIR /app

# Copy package.json and package-lock.json
COPY package*.json  ./

# Install dependencies
RUN npm install

# Copy the rest of the application code
COPY . .

# Expose port 8000
EXPOSE 8000

# Command to run the application
CMD [&quot;npm&quot;, &quot;run&quot;, &quot;start&quot;]</code></pre></div></section><section><h3 id="-1119023943#4-in-both-server-and-client-folder" data-toc="4-in-both-server-and-client-folder#Dockerizing-React-Node-Nginx.md-4-in-both-server-and-client-folder">4. In both server and client folder</h3><ul class="list" id="-1119023943#ewdids_553" start="1"><li class="list-item" id="-1119023943#ewdids_557"><p>Add <span class="inline-code" id="-1119023943#ewdids_558">Dockerfile</span> with this code</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_554"><pre><code class="language-dockerfile">node_modules
build
.git
.gitignore
Dockerfile
Dockerfile.dev
.dockerignore
*.log
.DS_Store
.git</code></pre></div></section><section><h3 id="-1119023943#4-in-the-root-folder-create-a-docker-compose-yml-file" data-toc="4-in-the-root-folder-create-a-docker-compose-yml-file#Dockerizing-React-Node-Nginx.md-4-in-the-root-folder-create-a-docker-compose-yml-file">4. In the root folder create a Docker-compose.yml file.</h3><div class="detached code-block" id="-1119023943#ewdids_560"><pre><code class="language-dockerfile">version: &quot;3.8&quot;
services:
  postgres:
    image: &quot;postgres:latest&quot;
    environment:
      - POSTGRES_PASSWORD=postgres_password
  nginx:
    container_name: nginx
    build:
      context: ./nginx
      dockerfile: Dockerfile  # Change to `Dockerfile` for production
    ports:
      - &quot;80:80&quot;
    depends_on:
      - api
      - client
    restart: always    
  api:
    build:
      dockerfile: Dockerfile # Change to `Dockerfile` for production
      context: &quot;./server&quot;
    volumes:
      - /app/node_modules
      - ./server:/app
    environment:
      - PGUSER=postgres
      - PGHOST=postgres
      - PGDATABASE=postgres
      - PGPASSWORD=postgres_password
      - PGPORT=5432
  client:
    stdin_open: true
    build:
      dockerfile: Dockerfile # Change to `Dockerfile` for production
      context: ./client
    volumes:
      - /app/node_modules
      - ./client:/app</code></pre></div><p id="-1119023943#ewdids_561">This <span class="inline-code" id="-1119023943#ewdids_563">docker-compose.yml</span> file defines a multi-service application using Docker Compose, where different containers are set up for PostgreSQL, Nginx, the API server, and the client application. Here's a breakdown of what each part does:</p></section><section><h3 id="-1119023943#version" data-toc="version#Dockerizing-React-Node-Nginx.md-version">Version</h3><ul class="list" id="-1119023943#ewdids_564" start="1"><li class="list-item" id="-1119023943#ewdids_565"><p><span class="control" id="-1119023943#ewdids_566"><span class="inline-code" id="-1119023943#ewdids_567">version: &quot;3.8&quot;</span></span>: Specifies the version of the Docker Compose file format. Version 3.8 is compatible with the latest features in Docker.</p></li></ul></section><section><h3 id="-1119023943#services" data-toc="services#Dockerizing-React-Node-Nginx.md-services">Services</h3><p id="-1119023943#ewdids_568">The <span class="inline-code" id="-1119023943#ewdids_573">services</span> section defines all the containers that will be started as part of this application.</p><section><h4 id="-1119023943#1-postgres-service" data-toc="1-postgres-service#Dockerizing-React-Node-Nginx.md-1-postgres-service">1. postgres Service</h4><ul class="list" id="-1119023943#ewdids_575" start="1"><li class="list-item" id="-1119023943#ewdids_578"><p><span class="control" id="-1119023943#ewdids_580"><span class="inline-code" id="-1119023943#ewdids_581">image: &quot;postgres:latest&quot;</span></span>: Uses the latest official PostgreSQL Docker image.</p></li><li class="list-item" id="-1119023943#ewdids_579"><p><span class="control" id="-1119023943#ewdids_582"><span class="inline-code" id="-1119023943#ewdids_584">environment:</span></span>: Sets environment variables for the PostgreSQL container. </p><ul class="list" id="-1119023943#ewdids_583" start="1"><li class="list-item" id="-1119023943#ewdids_585"><p><span class="inline-code" id="-1119023943#ewdids_586">POSTGRES_PASSWORD=postgres_password</span>: Sets the password for the default <span class="inline-code" id="-1119023943#ewdids_587">postgres</span> user in PostgreSQL.</p></li></ul></li></ul></section><section><h4 id="-1119023943#2-nginx-service" data-toc="2-nginx-service#Dockerizing-React-Node-Nginx.md-2-nginx-service">2. nginx Service</h4><ul class="list" id="-1119023943#ewdids_589" start="1"><li class="list-item" id="-1119023943#ewdids_592"><p><span class="control" id="-1119023943#ewdids_597"><span class="inline-code" id="-1119023943#ewdids_599">container_name: nginx</span></span>: Names the Nginx container as <span class="inline-code" id="-1119023943#ewdids_598">nginx</span>.</p></li><li class="list-item" id="-1119023943#ewdids_593"><p><span class="control" id="-1119023943#ewdids_600"><span class="inline-code" id="-1119023943#ewdids_602">build:</span></span>: Specifies how to build the Nginx Docker image. </p><ul class="list" id="-1119023943#ewdids_601" start="1"><li class="list-item" id="-1119023943#ewdids_603"><p><span class="inline-code" id="-1119023943#ewdids_605">context: ./nginx</span>: Uses the <span class="inline-code" id="-1119023943#ewdids_606">nginx</span> directory as the build context (where Docker looks for files like the Dockerfile).</p></li><li class="list-item" id="-1119023943#ewdids_604"><p><span class="inline-code" id="-1119023943#ewdids_607">dockerfile: Dockerfile</span>: Specifies the Dockerfile to use for building the Nginx image. It's set to <span class="inline-code" id="-1119023943#ewdids_608">Dockerfile</span>, indicating that it's ready for a production environment.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_594"><p><span class="control" id="-1119023943#ewdids_609"><span class="inline-code" id="-1119023943#ewdids_612">ports:</span></span>: Maps port <span class="inline-code" id="-1119023943#ewdids_610">80</span> on the host to port <span class="inline-code" id="-1119023943#ewdids_611">80</span> in the container, making the Nginx server accessible via HTTP.</p></li><li class="list-item" id="-1119023943#ewdids_595"><p><span class="control" id="-1119023943#ewdids_613"><span class="inline-code" id="-1119023943#ewdids_616">depends_on:</span></span>: Ensures that the <span class="inline-code" id="-1119023943#ewdids_614">api</span> and <span class="inline-code" id="-1119023943#ewdids_615">client</span> services are started before Nginx.</p></li><li class="list-item" id="-1119023943#ewdids_596"><p><span class="control" id="-1119023943#ewdids_617"><span class="inline-code" id="-1119023943#ewdids_618">restart: always</span></span>: Ensures that the Nginx container is always restarted if it stops.</p></li></ul></section><section><h4 id="-1119023943#3-api-service" data-toc="3-api-service#Dockerizing-React-Node-Nginx.md-3-api-service">3. api Service</h4><ul class="list" id="-1119023943#ewdids_620" start="1"><li class="list-item" id="-1119023943#ewdids_623"><p><span class="control" id="-1119023943#ewdids_626"><span class="inline-code" id="-1119023943#ewdids_628">build:</span></span>: Specifies how to build the API server Docker image. </p><ul class="list" id="-1119023943#ewdids_627" start="1"><li class="list-item" id="-1119023943#ewdids_629"><p><span class="inline-code" id="-1119023943#ewdids_631">dockerfile: Dockerfile</span>: Specifies the Dockerfile to use, ready for production.</p></li><li class="list-item" id="-1119023943#ewdids_630"><p><span class="inline-code" id="-1119023943#ewdids_632">context: &quot;./server&quot;</span>: Uses the <span class="inline-code" id="-1119023943#ewdids_633">server</span> directory as the build context.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_624"><p><span class="control" id="-1119023943#ewdids_634"><span class="inline-code" id="-1119023943#ewdids_636">volumes:</span></span>: Mounts local directories into the container. </p><ul class="list" id="-1119023943#ewdids_635" start="1"><li class="list-item" id="-1119023943#ewdids_637"><p><span class="inline-code" id="-1119023943#ewdids_639">/app/node_modules</span>: Ensures <span class="inline-code" id="-1119023943#ewdids_640">node_modules</span> inside the container isn&rsquo;t overwritten by an empty host directory.</p></li><li class="list-item" id="-1119023943#ewdids_638"><p><span class="inline-code" id="-1119023943#ewdids_641">./server:/app</span>: Mounts the <span class="inline-code" id="-1119023943#ewdids_642">server</span> directory on the host to <span class="inline-code" id="-1119023943#ewdids_643">/app</span> inside the container, allowing live development.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_625"><p><span class="control" id="-1119023943#ewdids_644"><span class="inline-code" id="-1119023943#ewdids_646">environment:</span></span>: Sets environment variables to configure the API server. </p><ul class="list" id="-1119023943#ewdids_645" start="1"><li class="list-item" id="-1119023943#ewdids_647"><p><span class="inline-code" id="-1119023943#ewdids_648">PGUSER=postgres</span>, <span class="inline-code" id="-1119023943#ewdids_649">PGHOST=postgres</span>, <span class="inline-code" id="-1119023943#ewdids_650">PGDATABASE=postgres</span>, <span class="inline-code" id="-1119023943#ewdids_651">PGPASSWORD=postgres_password</span>, <span class="inline-code" id="-1119023943#ewdids_652">PGPORT=5432</span>: These configure the connection to the PostgreSQL database running in the <span class="inline-code" id="-1119023943#ewdids_653">postgres</span> service.</p></li></ul></li></ul></section><section><h4 id="-1119023943#4-client-service" data-toc="4-client-service#Dockerizing-React-Node-Nginx.md-4-client-service">4. client Service</h4><ul class="list" id="-1119023943#ewdids_655" start="1"><li class="list-item" id="-1119023943#ewdids_658"><p><span class="control" id="-1119023943#ewdids_661"><span class="inline-code" id="-1119023943#ewdids_662">stdin_open: true</span></span>: Keeps the standard input open, which is often used for interactive debugging.</p></li><li class="list-item" id="-1119023943#ewdids_659"><p><span class="control" id="-1119023943#ewdids_663"><span class="inline-code" id="-1119023943#ewdids_665">build:</span></span>: Specifies how to build the client application Docker image. </p><ul class="list" id="-1119023943#ewdids_664" start="1"><li class="list-item" id="-1119023943#ewdids_666"><p><span class="inline-code" id="-1119023943#ewdids_668">dockerfile: Dockerfile</span>: Specifies the Dockerfile for the client, set up for production.</p></li><li class="list-item" id="-1119023943#ewdids_667"><p><span class="inline-code" id="-1119023943#ewdids_669">context: ./client</span>: Uses the <span class="inline-code" id="-1119023943#ewdids_670">client</span> directory as the build context.</p></li></ul></li><li class="list-item" id="-1119023943#ewdids_660"><p><span class="control" id="-1119023943#ewdids_671"><span class="inline-code" id="-1119023943#ewdids_673">volumes:</span></span>: Mounts local directories into the container. </p><ul class="list" id="-1119023943#ewdids_672" start="1"><li class="list-item" id="-1119023943#ewdids_674"><p><span class="inline-code" id="-1119023943#ewdids_676">/app/node_modules</span>: Similar to the API service, it preserves the <span class="inline-code" id="-1119023943#ewdids_677">node_modules</span> directory inside the container.</p></li><li class="list-item" id="-1119023943#ewdids_675"><p><span class="inline-code" id="-1119023943#ewdids_678">./client:/app</span>: Mounts the <span class="inline-code" id="-1119023943#ewdids_679">client</span> directory on the host to <span class="inline-code" id="-1119023943#ewdids_680">/app</span> inside the container.</p></li></ul></li></ul></section></section><section><h3 id="-1119023943#summary" data-toc="summary#Dockerizing-React-Node-Nginx.md-summary">Summary</h3><p id="-1119023943#ewdids_681">This Docker Compose file sets up a full-stack application with:</p><ul class="list" id="-1119023943#ewdids_682" start="1"><li class="list-item" id="-1119023943#ewdids_683"><p>A <span class="control" id="-1119023943#ewdids_687">PostgreSQL database</span> (<span class="inline-code" id="-1119023943#ewdids_688">postgres</span>).</p></li><li class="list-item" id="-1119023943#ewdids_684"><p>An <span class="control" id="-1119023943#ewdids_689">Nginx server</span> to act as a reverse proxy (<span class="inline-code" id="-1119023943#ewdids_690">nginx</span>).</p></li><li class="list-item" id="-1119023943#ewdids_685"><p>An <span class="control" id="-1119023943#ewdids_691">API backend</span> (<span class="inline-code" id="-1119023943#ewdids_692">api</span>).</p></li><li class="list-item" id="-1119023943#ewdids_686"><p>A <span class="control" id="-1119023943#ewdids_693">client frontend</span> (<span class="inline-code" id="-1119023943#ewdids_694">client</span>).</p></li></ul></section></section><section><h2 id="-1119023943#build-and-run-using-docker-compose-yml" data-toc="build-and-run-using-docker-compose-yml#Dockerizing-React-Node-Nginx.md-build-and-run-using-docker-compose-yml">Build and Run using docker-compose.yml</h2><p id="-1119023943#ewdids_696">To build and run the services defined in the <span class="inline-code" id="-1119023943#ewdids_702">docker-compose.yml</span> file, you can use the following commands in your terminal:</p><section><h3 id="-1119023943#1-build-the-services" data-toc="1-build-the-services#Dockerizing-React-Node-Nginx.md-1-build-the-services">1. Build the Services</h3><div class="detached code-block" id="-1119023943#ewdids_703"><pre><code class="language-bash">docker-compose build</code></pre></div><p id="-1119023943#ewdids_704">This command will build the Docker images for all the services (PostgreSQL, Nginx, API, and Client) as defined in the <span class="inline-code" id="-1119023943#ewdids_705">docker-compose.yml</span> file. It will use the specified <span class="inline-code" id="-1119023943#ewdids_706">Dockerfile</span> and context for each service.</p></section><section><h3 id="-1119023943#2-run-the-services" data-toc="2-run-the-services#Dockerizing-React-Node-Nginx.md-2-run-the-services">2. Run the Services</h3><div class="detached code-block" id="-1119023943#ewdids_707"><pre><code class="language-bash">docker-compose up</code></pre></div><p id="-1119023943#ewdids_708">This command will start all the services defined in the <span class="inline-code" id="-1119023943#ewdids_709">docker-compose.yml</span> file. It will also create and start any necessary networks, volumes, and dependencies.</p></section><section><h3 id="-1119023943#3-run-the-services-in-detached-mode-optional" data-toc="3-run-the-services-in-detached-mode-optional#Dockerizing-React-Node-Nginx.md-3-run-the-services-in-detached-mode-optional">3. Run the Services in Detached Mode (Optional)</h3><p id="-1119023943#ewdids_710">If you want to run the services in the background (detached mode), you can use:</p><div class="detached code-block" id="-1119023943#ewdids_711"><pre><code class="language-bash">docker-compose up -d</code></pre></div><p id="-1119023943#ewdids_712">This will start the containers in the background, allowing you to continue using the terminal for other tasks.</p></section><section><h3 id="-1119023943#4-stopping-the-services" data-toc="4-stopping-the-services#Dockerizing-React-Node-Nginx.md-4-stopping-the-services">4. Stopping the Services</h3><p id="-1119023943#ewdids_713">To stop the services that are running:</p><div class="detached code-block" id="-1119023943#ewdids_714"><pre><code class="language-bash">docker-compose down</code></pre></div><p id="-1119023943#ewdids_715">This will stop and remove all the containers, networks, and volumes created by <span class="inline-code" id="-1119023943#ewdids_716">docker-compose up</span>.</p></section></section><section><h2 id="-1119023943#pushing-local-docker-images-to-dockerhub-repositories" data-toc="pushing-local-docker-images-to-dockerhub-repositories#Dockerizing-React-Node-Nginx.md-pushing-local-docker-images-to-dockerhub-repositories">Pushing local Docker images to DockerHub Repositories</h2><ul class="list" id="-1119023943#ewdids_717" start="1"><li class="list-item" id="-1119023943#ewdids_722"><p>sign in to https://hub.docker.com/ and create a repository called <span class="inline-code" id="-1119023943#ewdids_725">react-app-prod</span>, <span class="inline-code" id="-1119023943#ewdids_726">express-app-prod</span> and <span class="inline-code" id="-1119023943#ewdids_727">ngnix-prod</span></p></li><li class="list-item" id="-1119023943#ewdids_723"><p>Go back to your project and cd into the root of <span class="inline-code" id="-1119023943#ewdids_728">client</span></p></li><li class="list-item" id="-1119023943#ewdids_724"><p>Log in to the Docker registry:</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_718"><pre><code class="language-dockerfile">docker login</code></pre></div><ul class="list" id="-1119023943#ewdids_719" start="1"><li class="list-item" id="-1119023943#ewdids_729"><p>Enter your username and password when prompted. If you are using Docker Hub, these would be your Docker Hub credentials. For private registries, use the appropriate credentials.</p></li></ul><section><h3 id="-1119023943#client-react-app" data-toc="client-react-app#Dockerizing-React-Node-Nginx.md-client-react-app">Client(React-app)</h3><ul class="list" id="-1119023943#ewdids_730" start="1"><li class="list-item" id="-1119023943#ewdids_736"></li><li class="list-item" id="-1119023943#ewdids_737"><p>To push an image use</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_731"><pre><code class="language-dockerfile">docker push my-dockerhub-username/my-repo:tag</code></pre></div><ul class="list" id="-1119023943#ewdids_732" start="1"><li class="list-item" id="-1119023943#ewdids_738"><p>For this example I'll build the client image with <span class="inline-code" id="-1119023943#ewdids_739">my-dockerhub-username/my-repo:tag</span></p></li></ul><div class="detached code-block" id="-1119023943#ewdids_733"><pre><code class="language-dockerfile">docker build -t kelchospense/react-app-prod:v1 .</code></pre></div><ul class="list" id="-1119023943#ewdids_734" start="1"><li class="list-item" id="-1119023943#ewdids_740"><p>Then push</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_735"><pre><code class="language-dockerfile">docker push kelchospense/react-app-prod:v1</code></pre></div></section><section><h3 id="-1119023943#server-express-app" data-toc="server-express-app#Dockerizing-React-Node-Nginx.md-server-express-app">Server(Express-app)</h3><ul class="list" id="-1119023943#ewdids_741" start="1"><li class="list-item" id="-1119023943#ewdids_745"><p>To build server go to the <span class="inline-code" id="-1119023943#ewdids_746">./server</span> dir</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_742"><pre><code class="language-dockerfile">docker build -t kelchospense/express-app-prod:v1 .</code></pre></div><ul class="list" id="-1119023943#ewdids_743" start="1"><li class="list-item" id="-1119023943#ewdids_747"><p>Then push</p></li></ul><div class="detached code-block" id="-1119023943#ewdids_744"><pre><code class="language-dockerfile">docker push kelchospense/express-app-prod:v1</code></pre></div></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2032313741">Restore the old Context Menu in Windows 11</h1><ol class="list list-decimal" id="2032313741#z6r3ldo_3" type="1" start="1"><li class="list-item" id="2032313741#z6r3ldo_5"><p>Right-click the Start button and choose Windows Terminal.</p></li><li class="list-item" id="2032313741#z6r3ldo_6"><p>Copy the command from below, paste it into Windows Terminal Window, and press enter.</p></li><li class="list-item" id="2032313741#z6r3ldo_7"><div class="detached code-block" id="2032313741#z6r3ldo_10"><pre><code class="language-bash">reg.exe add &quot;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32&quot; /f /ve</code></pre></div></li><li class="list-item" id="2032313741#z6r3ldo_8"><p>Restart File Explorer or your computer for the changes to take effect.</p></li><li class="list-item" id="2032313741#z6r3ldo_9"><p>You would see the Legacy Right Click Context menu by default.</p></li></ol><section><h2 id="2032313741#restore-modern-context-menus-in-windows-11" data-toc="restore-modern-context-menus-in-windows-11#Modern-Context-menus-in-Windows-11.md-restore-modern-context-menus-in-windows-11">Restore Modern Context menus in Windows 11</h2><ul class="list" id="2032313741#z6r3ldo_11" start="1"><li class="list-item" id="2032313741#z6r3ldo_12"><p id="2032313741#z6r3ldo_13">To undo this change, in a Terminal Window, execute this command:</p><div class="detached code-block" id="2032313741#z6r3ldo_14"><pre><code class="language-bash">reg.exe delete &quot;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}&quot; /f</code></pre></div></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="114282917">Kubernetes Multi Container Deployment | React | Node.js | Postgres | Ingress Nginx | step by step</h1><section><h2 id="114282917#chapter-1-introduction" data-toc="chapter-1-introduction#Kubernetes Multi Container Deployment.md-chapter-1-introduction">Chapter 1: Introduction</h2><div class="container"><figure class="image-container"><img class="center image image-size" id="114282917#trhd3w_6" alt="kubernetes.png" title="kubernetes.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/kubernetes.png" width="2097" height="1052"><figcaption class="center-text">kubernetes.png</figcaption></figure></div><p id="114282917#trhd3w_7">This diagram illustrates a Kubernetes deployment architecture for a full-stack application consisting of a React frontend, a Node.js (Express) backend, and a PostgreSQL database, with traffic management handled by an Ingress service using Nginx. Here&rsquo;s a step-by-step explanation of how this setup works:</p><section><h3 id="114282917#1-traffic-ingress-via-ingress-service" data-toc="1-traffic-ingress-via-ingress-service#Kubernetes Multi Container Deployment.md-1-traffic-ingress-via-ingress-service">1. Traffic Ingress via Ingress Service</h3><ul class="list" id="114282917#trhd3w_15" start="1"><li class="list-item" id="114282917#trhd3w_17"><p><span class="control" id="114282917#trhd3w_18">Ingress Service</span>: </p><ul class="list" id="114282917#trhd3w_19" start="1"><li class="list-item" id="114282917#trhd3w_20"><p>The first component of this architecture is the Ingress service, which acts as the entry point for all external traffic into the Kubernetes cluster.</p></li><li class="list-item" id="114282917#trhd3w_21"><p>In this context, Nginx is likely used as the ingress controller to manage incoming HTTP/HTTPS requests. It routes the traffic based on defined rules to the appropriate services inside the cluster.</p></li></ul></li></ul></section><section><h3 id="114282917#2-routing-to-cluster-ip-services" data-toc="2-routing-to-cluster-ip-services#Kubernetes Multi Container Deployment.md-2-routing-to-cluster-ip-services">2. Routing to Cluster IP Services</h3><ul class="list" id="114282917#trhd3w_23" start="1"><li class="list-item" id="114282917#trhd3w_25"><p><span class="control" id="114282917#trhd3w_26">Cluster IP Services</span>: </p><ul class="list" id="114282917#trhd3w_27" start="1"><li class="list-item" id="114282917#trhd3w_28"><p>These services act as internal load balancers within the Kubernetes cluster, distributing incoming requests from the Ingress to the appropriate pods.</p></li><li class="list-item" id="114282917#trhd3w_29"><p>There are two Cluster IP services in this diagram: </p><ul class="list" id="114282917#trhd3w_30" start="1"><li class="list-item" id="114282917#trhd3w_31"><p>One for the <span class="control" id="114282917#trhd3w_33">Client-react-app</span>.</p></li><li class="list-item" id="114282917#trhd3w_32"><p>One for the <span class="control" id="114282917#trhd3w_34">Server-express-app</span>.</p></li></ul></li></ul></li></ul></section><section><h3 id="114282917#3-client-react-app-deployment" data-toc="3-client-react-app-deployment#Kubernetes Multi Container Deployment.md-3-client-react-app-deployment">3. Client-React-App Deployment</h3><ul class="list" id="114282917#trhd3w_36" start="1"><li class="list-item" id="114282917#trhd3w_38"><p><span class="control" id="114282917#trhd3w_39">Deployment</span>: </p><ul class="list" id="114282917#trhd3w_40" start="1"><li class="list-item" id="114282917#trhd3w_41"><p>This is where the React frontend is deployed.</p></li><li class="list-item" id="114282917#trhd3w_42"><p>The React application is served as static files and is accessed by the user&rsquo;s browser.</p></li><li class="list-item" id="114282917#trhd3w_43"><p>It communicates with the backend (Server-express-app) for dynamic data.</p></li><li class="list-item" id="114282917#trhd3w_44"><p>Traffic destined for the React app is routed by the Ingress service to this deployment via the corresponding Cluster IP service.</p></li></ul></li></ul></section><section><h3 id="114282917#4-server-express-app-deployment" data-toc="4-server-express-app-deployment#Kubernetes Multi Container Deployment.md-4-server-express-app-deployment">4. Server-Express-App Deployment</h3><ul class="list" id="114282917#trhd3w_46" start="1"><li class="list-item" id="114282917#trhd3w_48"><p><span class="control" id="114282917#trhd3w_49">Deployment</span>: </p><ul class="list" id="114282917#trhd3w_50" start="1"><li class="list-item" id="114282917#trhd3w_51"><p>This is where the backend server, built with Node.js and Express, is deployed.</p></li><li class="list-item" id="114282917#trhd3w_52"><p>The server handles API requests from the frontend and manages business logic. It also interacts with the PostgreSQL database to fetch or store data.</p></li><li class="list-item" id="114282917#trhd3w_53"><p>The Ingress service routes traffic intended for the backend to this deployment through its associated Cluster IP service.</p></li></ul></li></ul></section><section><h3 id="114282917#5-postgres-db-deployment" data-toc="5-postgres-db-deployment#Kubernetes Multi Container Deployment.md-5-postgres-db-deployment">5. Postgres-DB Deployment</h3><ul class="list" id="114282917#trhd3w_55" start="1"><li class="list-item" id="114282917#trhd3w_57"><p><span class="control" id="114282917#trhd3w_58">Deployment</span>: </p><ul class="list" id="114282917#trhd3w_59" start="1"><li class="list-item" id="114282917#trhd3w_60"><p>The PostgreSQL database is deployed here.</p></li><li class="list-item" id="114282917#trhd3w_61"><p>It stores all persistent data for the application and is accessed by the Server-express-app for CRUD operations.</p></li><li class="list-item" id="114282917#trhd3w_62"><p>This deployment is not exposed to external traffic but is accessed internally by the Server-express-app.</p></li></ul></li></ul></section><section><h3 id="114282917#6-inter-deployment-communication" data-toc="6-inter-deployment-communication#Kubernetes Multi Container Deployment.md-6-inter-deployment-communication">6. Inter-Deployment Communication</h3><ul class="list" id="114282917#trhd3w_64" start="1"><li class="list-item" id="114282917#trhd3w_66"><p><span class="control" id="114282917#trhd3w_67">Server-Express-App to Postgres-DB</span>: </p><ul class="list" id="114282917#trhd3w_68" start="1"><li class="list-item" id="114282917#trhd3w_69"><p>The backend server (Node.js Express app) communicates with the PostgreSQL database deployment internally within the Kubernetes cluster.</p></li><li class="list-item" id="114282917#trhd3w_70"><p>The communication is facilitated via internal DNS or direct service names in Kubernetes, ensuring that the database is secure and only accessible by the backend service.</p></li></ul></li></ul></section></section><section><h2 id="114282917#install-kubernetes-via-docker" data-toc="install-kubernetes-via-docker#Kubernetes Multi Container Deployment.md-install-kubernetes-via-docker">Install Kubernetes via Docker</h2><ul class="list" id="114282917#trhd3w_71" start="1"><li class="list-item" id="114282917#trhd3w_72"><p>Please make sure this option is checked below. </p><div class="container"><figure class="image-container"><img class="center image image-size" id="114282917#trhd3w_74" alt="Screenshot 2024-08-13 170438.png" title="Screenshot 2024-08-13 170438.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/docker-kubernetes-config.png" width="1903" height="1066"><figcaption class="center-text">Screenshot 2024-08-13 170438.png</figcaption></figure></div></li><li class="list-item" id="114282917#trhd3w_73"><p>Run this on your terminal <span class="inline-code" id="114282917#trhd3w_75">kubectl version</span> this command is used to check the version of the kubectl client and the version of the Kubernetes server (i.e., the Kubernetes control plane) that your kubectl is communicating with.</p></li></ul></section><section><h2 id="114282917#create-k8s-folder" data-toc="create-k8s-folder#Kubernetes Multi Container Deployment.md-create-k8s-folder">Create K8S folder</h2><div class="container"><figure class="image-container"><img class="center image image-size" id="114282917#trhd3w_76" alt="ks8-folder-structure.png" title="ks8-folder-structure.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/ks8-folder-structure.png" width="873" height="463"><figcaption class="center-text">ks8-folder-structure.png</figcaption></figure></div><section><h3 id="114282917#1-add-client-deployment-yml-file-with-this-code" data-toc="1-add-client-deployment-yml-file-with-this-code#Kubernetes Multi Container Deployment.md-1-add-client-deployment-yml-file-with-this-code">1. Add client-deployment.yml file with this code</h3><div class="detached code-block" id="114282917#trhd3w_80"><pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: client-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      component: web
  template:
    metadata:
      labels:
        component: web
    spec:
      containers:
        - name: client
          image: kelchospense/react-app-prod
          ports:
            - containerPort: 5173</code></pre></div><p id="114282917#trhd3w_81">This YAML configuration is a Kubernetes manifest that defines a <span class="control" id="114282917#trhd3w_88">Deployment</span> for a React application. Here's a brief explanation of each section:</p><ul class="list" id="114282917#trhd3w_82" start="1"><li class="list-item" id="114282917#trhd3w_89"><section><h4 id="114282917#apiversion-apps-v1" data-toc="apiversion-apps-v1#Kubernetes Multi Container Deployment.md-apiversion-apps-v1">apiVersion: apps/v1</h4></section></li></ul><p id="114282917#trhd3w_83">Specifies the version of the Kubernetes API being used. The <span class="inline-code" id="114282917#trhd3w_93">apps/v1</span> version is used for managing deployments, stateful sets, and other application-related resources.</p><section><h4 id="114282917#2-kind-deployment" data-toc="2-kind-deployment#Kubernetes Multi Container Deployment.md-2-kind-deployment">2. kind: Deployment</h4><ul class="list" id="114282917#trhd3w_95" start="1"><li class="list-item" id="114282917#trhd3w_97"><p>Indicates that this manifest describes a <span class="control" id="114282917#trhd3w_98">Deployment</span> resource. A Deployment is responsible for managing a set of identical pods, ensuring that the desired number of pods are running, and handling updates to the application.</p></li></ul></section><section><h4 id="114282917#3-metadata" data-toc="3-metadata#Kubernetes Multi Container Deployment.md-3-metadata">3. metadata</h4><ul class="list" id="114282917#trhd3w_100" start="1"><li class="list-item" id="114282917#trhd3w_102"><p><span class="control" id="114282917#trhd3w_103">name: client-deployment</span>: Assigns a name to the Deployment. In this case, it's called <span class="inline-code" id="114282917#trhd3w_104">client-deployment</span>.</p></li></ul></section><section><h4 id="114282917#4-spec" data-toc="4-spec#Kubernetes Multi Container Deployment.md-4-spec">4. spec</h4><ul class="list" id="114282917#trhd3w_106" start="1"><li class="list-item" id="114282917#trhd3w_108"><p id="114282917#trhd3w_112">The <span class="inline-code" id="114282917#trhd3w_113">spec</span> section defines the desired state of the Deployment.</p></li><li class="list-item" id="114282917#trhd3w_109"><p id="114282917#trhd3w_114"><span class="control" id="114282917#trhd3w_115">replicas: 1</span>: Specifies that only one replica (pod) of this application should be running. This can be scaled up if needed.</p></li><li class="list-item" id="114282917#trhd3w_110"><p id="114282917#trhd3w_116"><span class="control" id="114282917#trhd3w_118">selector</span>:</p><ul class="list" id="114282917#trhd3w_117" start="1"><li class="list-item" id="114282917#trhd3w_119"><p><span class="control" id="114282917#trhd3w_120">matchLabels</span>: This section defines a label selector. It ensures that the Deployment manages only the pods that have the label <span class="inline-code" id="114282917#trhd3w_121">component: web</span>.</p></li></ul></li><li class="list-item" id="114282917#trhd3w_111"><p id="114282917#trhd3w_122"><span class="control" id="114282917#trhd3w_124">template</span>:</p><ul class="list" id="114282917#trhd3w_123" start="1"><li class="list-item" id="114282917#trhd3w_125"><p id="114282917#trhd3w_128">Defines the template for the pods that will be created by this Deployment.</p></li><li class="list-item" id="114282917#trhd3w_126"><p id="114282917#trhd3w_129"><span class="control" id="114282917#trhd3w_131">metadata</span>:</p><ul class="list" id="114282917#trhd3w_130" start="1"><li class="list-item" id="114282917#trhd3w_132"><p><span class="control" id="114282917#trhd3w_133">labels</span>: Labels added to the pod. Here, the label <span class="inline-code" id="114282917#trhd3w_134">component: web</span> is assigned to the pod. This label must match the <span class="inline-code" id="114282917#trhd3w_135">matchLabels</span> selector in the Deployment spec.</p></li></ul></li><li class="list-item" id="114282917#trhd3w_127"><p id="114282917#trhd3w_136"><span class="control" id="114282917#trhd3w_138">spec</span>:</p><ul class="list" id="114282917#trhd3w_137" start="1"><li class="list-item" id="114282917#trhd3w_139"><p id="114282917#trhd3w_140"><span class="control" id="114282917#trhd3w_142">containers</span>: Defines the container(s) that will run inside the pod.</p><ul class="list" id="114282917#trhd3w_141" start="1"><li class="list-item" id="114282917#trhd3w_143"><p id="114282917#trhd3w_146"><span class="control" id="114282917#trhd3w_147">name: client</span>: The name of the container running in the pod.</p></li><li class="list-item" id="114282917#trhd3w_144"><p id="114282917#trhd3w_148"><span class="control" id="114282917#trhd3w_149">image: kelchospense/react-app-prod</span>: The Docker image that the container will run. In this case, it's a React application that has been containerized and pushed to a Docker registry under the name <span class="inline-code" id="114282917#trhd3w_150">kelchospense/react-app-prod</span>.</p></li><li class="list-item" id="114282917#trhd3w_145"><p id="114282917#trhd3w_151"><span class="control" id="114282917#trhd3w_153">ports</span>:</p><ul class="list" id="114282917#trhd3w_152" start="1"><li class="list-item" id="114282917#trhd3w_154"><p><span class="control" id="114282917#trhd3w_155">containerPort: 5173</span>: Specifies the port on which the application inside the container listens. This port will be exposed by the container so that it can be accessed by other services or users.</p></li></ul></li></ul></li></ul></li></ul></li></ul></section></section><section><h3 id="114282917#testing-the-client-deployment-yml" data-toc="testing-the-client-deployment-yml#Kubernetes Multi Container Deployment.md-testing-the-client-deployment-yml">Testing the client-deployment.yml`</h3><ul class="list" id="114282917#trhd3w_156" start="1"><li class="list-item" id="114282917#trhd3w_162"><p>Go to the root dir and open terminal.</p></li></ul><div class="detached code-block" id="114282917#trhd3w_157"><pre><code class="language-bash">kubectl apply -f k8s</code></pre></div><ul class="list" id="114282917#trhd3w_158" start="1"><li class="list-item" id="114282917#trhd3w_163"><p>Check the pod is running</p></li></ul><div class="detached code-block" id="114282917#trhd3w_159"><pre><code class="language-bash">kubectl get pods</code></pre></div><ul class="list" id="114282917#trhd3w_160" start="1"><li class="list-item" id="114282917#trhd3w_164"><p>should get</p></li></ul><div class="detached code-block" id="114282917#trhd3w_161"><pre><code class="language-bash">client-deployment-5656f88b7c-2p9cs     1/1     Running   2               18m</code></pre></div></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="52475659">What is Kubernetes?</h1><p id="52475659#qb0p1a_3">Kubernetes, often abbreviated as &quot;K8s,&quot; is an open-source platform designed to automate the deployment, scaling, and management of containerized applications. It&rsquo;s crucial in modern cloud-native application development for several reasons:</p><section><h2 id="52475659#1-scalability" data-toc="1-scalability#Kubernetes-101.md-1-scalability">1. Scalability</h2><ul class="list" id="52475659#qb0p1a_18" start="1"><li class="list-item" id="52475659#qb0p1a_20"><p>Kubernetes allows you to easily scale your application up or down based on demand. This ensures that your application can handle traffic spikes without manual intervention.</p></li></ul></section><section><h2 id="52475659#2-high-availability" data-toc="2-high-availability#Kubernetes-101.md-2-high-availability">2. High Availability</h2><ul class="list" id="52475659#qb0p1a_22" start="1"><li class="list-item" id="52475659#qb0p1a_24"><p>Kubernetes ensures that your application is always up and running by automatically restarting failed containers, replicating services across nodes, and managing rolling updates.</p></li></ul></section><section><h2 id="52475659#3-efficient-resource-utilization" data-toc="3-efficient-resource-utilization#Kubernetes-101.md-3-efficient-resource-utilization">3. Efficient Resource Utilization</h2><ul class="list" id="52475659#qb0p1a_26" start="1"><li class="list-item" id="52475659#qb0p1a_28"><p>It schedules containers based on available resources and requirements, optimizing the use of underlying infrastructure. This ensures cost-effective usage of computing resources.</p></li></ul></section><section><h2 id="52475659#4-self-healing" data-toc="4-self-healing#Kubernetes-101.md-4-self-healing">4. Self-Healing</h2><ul class="list" id="52475659#qb0p1a_30" start="1"><li class="list-item" id="52475659#qb0p1a_32"><p>Kubernetes automatically monitors the health of your applications and containers. If a container fails, it restarts it. If a node fails, it redistributes the workloads.</p></li></ul></section><section><h2 id="52475659#5-automated-rollouts-and-rollbacks" data-toc="5-automated-rollouts-and-rollbacks#Kubernetes-101.md-5-automated-rollouts-and-rollbacks">5. Automated Rollouts and Rollbacks</h2><ul class="list" id="52475659#qb0p1a_34" start="1"><li class="list-item" id="52475659#qb0p1a_36"><p>You can define how your application should be updated. Kubernetes will gradually roll out changes while monitoring the health of your application, allowing for automated rollbacks if something goes wrong.</p></li></ul></section><section><h2 id="52475659#6-portability-and-flexibility" data-toc="6-portability-and-flexibility#Kubernetes-101.md-6-portability-and-flexibility">6. Portability and Flexibility</h2><ul class="list" id="52475659#qb0p1a_38" start="1"><li class="list-item" id="52475659#qb0p1a_40"><p>Kubernetes abstracts away the underlying infrastructure, making it easier to move workloads between different environments (on-premises, public cloud, hybrid cloud).</p></li></ul></section><section><h2 id="52475659#use-cases" data-toc="use-cases#Kubernetes-101.md-use-cases">Use Cases:</h2><ul class="list" id="52475659#qb0p1a_41" start="1"><li class="list-item" id="52475659#qb0p1a_42"><p><span class="control" id="52475659#qb0p1a_46">Microservices Architecture</span>: Kubernetes is ideal for deploying microservices because it can manage a large number of interdependent services with ease.</p></li><li class="list-item" id="52475659#qb0p1a_43"><p><span class="control" id="52475659#qb0p1a_47">DevOps Pipelines</span>: Automate deployment, scaling, and operations of application containers across clusters of hosts.</p></li><li class="list-item" id="52475659#qb0p1a_44"><p><span class="control" id="52475659#qb0p1a_48">Hybrid Cloud Deployments</span>: Consistently deploy applications across on-premises and public cloud environments.</p></li><li class="list-item" id="52475659#qb0p1a_45"><p><span class="control" id="52475659#qb0p1a_49">Batch Processing and CI/CD</span>: Efficiently run batch jobs, continuous integration, and continuous deployment tasks with Kubernetes.</p></li></ul></section><section><h2 id="52475659#practical-example-kubernetes-on-docker-desktop" data-toc="practical-example-kubernetes-on-docker-desktop#Kubernetes-101.md-practical-example-kubernetes-on-docker-desktop">Practical Example: Kubernetes on Docker Desktop</h2><p id="52475659#qb0p1a_50">Let's create a simple example where we deploy a Node.js application on Kubernetes using Docker Desktop.</p></section><section><h2 id="52475659#step-0-set-up-kubernetes-on-docker-desktop" data-toc="step-0-set-up-kubernetes-on-docker-desktop#Kubernetes-101.md-step-0-set-up-kubernetes-on-docker-desktop">Step 0: Set Up Kubernetes on Docker Desktop</h2><ol class="list list-decimal" id="52475659#qb0p1a_51" type="1" start="1"><li class="list-item" id="52475659#qb0p1a_52"><p id="52475659#qb0p1a_54"><span class="control" id="52475659#qb0p1a_56">Install Docker Desktop</span>:</p><ul class="list" id="52475659#qb0p1a_55" start="1"><li class="list-item" id="52475659#qb0p1a_57"><p>Download and install Docker Desktop from the official site (<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a>).</p></li></ul></li><li class="list-item" id="52475659#qb0p1a_53"><p id="52475659#qb0p1a_59"><span class="control" id="52475659#qb0p1a_61">Enable Kubernetes</span>:</p><ul class="list" id="52475659#qb0p1a_60" start="1"><li class="list-item" id="52475659#qb0p1a_62"><p>Open Docker Desktop, go to <span class="control" id="52475659#qb0p1a_64">Settings</span> &gt; <span class="control" id="52475659#qb0p1a_65">Kubernetes</span> and check &quot;Enable Kubernetes&quot;.</p></li><li class="list-item" id="52475659#qb0p1a_63"><p>Click &quot;Apply &amp; Restart&quot;. Docker Desktop will install and start a local Kubernetes cluster.</p></li></ul></li></ol></section><section><h2 id="52475659#step-1-set-up-the-node-js-application" data-toc="step-1-set-up-the-node-js-application#Kubernetes-101.md-step-1-set-up-the-node-js-application">Step 1: Set Up the Node.js Application</h2><div class="container"><figure class="image-container"><img class="center image image-size" id="52475659#qb0p1a_66" alt="express-k8s-folder-structure.png" title="express-k8s-folder-structure.png" src="D:/KelchoRepos/WritersideProjects/TEACH2GIVE-Docker/Writerside/images/express-k8s-folder-structure.png" width="424" height="328"><figcaption class="center-text">express-k8s-folder-structure.png</figcaption></figure></div><ol class="list list-decimal" id="52475659#qb0p1a_67" type="1" start="1"><li class="list-item" id="52475659#qb0p1a_68"><p id="52475659#qb0p1a_74"><span class="control" id="52475659#qb0p1a_77">Initialize the Node.js Project</span>:</p><div class="detached code-block" id="52475659#qb0p1a_75"><pre><code class="language-bash">mkdir express-postgres-k8s
cd express-postgres-k8s
npm init -y
npm install express pg sequelize</code></pre></div><ul class="list" id="52475659#qb0p1a_76" start="1"><li class="list-item" id="52475659#qb0p1a_78"><p><span class="control" id="52475659#qb0p1a_81"><span class="inline-code" id="52475659#qb0p1a_82">express</span></span>: Framework to build the API.</p></li><li class="list-item" id="52475659#qb0p1a_79"><p><span class="control" id="52475659#qb0p1a_83"><span class="inline-code" id="52475659#qb0p1a_84">pg</span></span>: PostgreSQL client for Node.js.</p></li><li class="list-item" id="52475659#qb0p1a_80"><p><span class="control" id="52475659#qb0p1a_85"><span class="inline-code" id="52475659#qb0p1a_86">sequelize</span></span>: ORM (Object-Relational Mapping) for PostgreSQL.</p></li></ul></li><li class="list-item" id="52475659#qb0p1a_69"><p id="52475659#qb0p1a_87"><span class="control" id="52475659#qb0p1a_91">Set Up Sequelize and PostgreSQL Connection</span>:</p><p id="52475659#qb0p1a_88">Create a file <span class="inline-code" id="52475659#qb0p1a_92">db.js</span> to configure Sequelize and connect to PostgreSQL:</p><div class="detached code-block" id="52475659#qb0p1a_89"><pre><code class="language-javascript">const { Sequelize } = require('sequelize');

// Create a new Sequelize instance
const sequelize = new Sequelize('todo_db', 'postgres', 'password', {
  host: 'localhost',
  dialect: 'postgres',
});

// Test the connection
sequelize
  .authenticate()
  .then(() =&gt; {
    console.log('Connection to PostgreSQL has been established successfully.');
  })
  .catch(err =&gt; {
    console.error('Unable to connect to the database:', err);
  });

module.exports = sequelize;</code></pre></div><ul class="list" id="52475659#qb0p1a_90" start="1"><li class="list-item" id="52475659#qb0p1a_93"><p><span class="control" id="52475659#qb0p1a_97">Database Name</span>: <span class="inline-code" id="52475659#qb0p1a_98">todo_db</span></p></li><li class="list-item" id="52475659#qb0p1a_94"><p><span class="control" id="52475659#qb0p1a_99">User</span>: <span class="inline-code" id="52475659#qb0p1a_100">postgres</span></p></li><li class="list-item" id="52475659#qb0p1a_95"><p><span class="control" id="52475659#qb0p1a_101">Password</span>: <span class="inline-code" id="52475659#qb0p1a_102">password</span></p></li><li class="list-item" id="52475659#qb0p1a_96"><p><span class="control" id="52475659#qb0p1a_103">Host</span>: <span class="inline-code" id="52475659#qb0p1a_104">localhost</span> (will be updated for Docker/Kubernetes)</p></li></ul></li><li class="list-item" id="52475659#qb0p1a_70"><p id="52475659#qb0p1a_105"><span class="control" id="52475659#qb0p1a_108">Define the To-Do Model</span>:</p><p id="52475659#qb0p1a_106">Create a file <span class="inline-code" id="52475659#qb0p1a_109">todo.model.js</span> to define the To-Do model:</p><div class="detached code-block" id="52475659#qb0p1a_107"><pre><code class="language-javascript">const { DataTypes } = require('sequelize');
const sequelize = require('./db');

const Todo = sequelize.define('Todo', {
  id: {
    type: DataTypes.INTEGER,
    autoIncrement: true,
    primaryKey: true,
  },
  title: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  completed: {
    type: DataTypes.BOOLEAN,
    defaultValue: false,
  },
});

// Sync the model with the database
sequelize.sync()
  .then(() =&gt; {
    console.log('Todo model synced with the database.');
  })
  .catch(err =&gt; {
    console.error('Failed to sync model with the database:', err);
  });

module.exports = Todo;</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_71"><p id="52475659#qb0p1a_110"><span class="control" id="52475659#qb0p1a_113">Create the Express Server with CRUD Routes</span>:</p><p id="52475659#qb0p1a_111">Create a file <span class="inline-code" id="52475659#qb0p1a_114">index.js</span> to define the Express server and CRUD routes:</p><div class="detached code-block" id="52475659#qb0p1a_112"><pre><code class="language-javascript">const express = require('express');
const Todo = require('./todo.model');

const app = express();
app.use(express.json());

// Create a new to-do
app.post('/todos', async (req, res) =&gt; {
  try {
    const todo = await Todo.create(req.body);
    res.status(201).json(todo);
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// Get all to-dos
app.get('/todos', async (req, res) =&gt; {
  try {
    const todos = await Todo.findAll();
    res.status(200).json(todos);
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// Get a single to-do by ID
app.get('/todos/:id', async (req, res) =&gt; {
  try {
    const todo = await Todo.findByPk(req.params.id);
    if (todo) {
      res.status(200).json(todo);
    } else {
      res.status(404).json({ error: 'To-do not found' });
    }
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// Update a to-do
app.put('/todos/:id', async (req, res) =&gt; {
  try {
    const todo = await Todo.findByPk(req.params.id);
    if (todo) {
      await todo.update(req.body);
      res.status(200).json(todo);
    } else {
      res.status(404).json({ error: 'To-do not found' });
    }
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// Delete a to-do
app.delete('/todos/:id', async (req, res) =&gt; {
  try {
    const todo = await Todo.findByPk(req.params.id);
    if (todo) {
      await todo.destroy();
      res.status(204).end();
    } else {
      res.status(404).json({ error: 'To-do not found' });
    }
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// Start the server
const PORT = process.env.PORT || 3000;
app.listen(PORT, () =&gt; {
  console.log(`Server is running on port ${PORT}`);
});</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_72"><p id="52475659#qb0p1a_115"><span class="control" id="52475659#qb0p1a_118">Create a PostgreSQL Database</span>:</p><p id="52475659#qb0p1a_116">Before testing, create the database <span class="inline-code" id="52475659#qb0p1a_119">todo_db</span> in PostgreSQL:</p><div class="detached code-block" id="52475659#qb0p1a_117"><pre><code class="language-bash">psql -U postgres
CREATE DATABASE todo_db;</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_73"><p id="52475659#qb0p1a_120"><span class="control" id="52475659#qb0p1a_124">Test the Application Locally</span>:</p><p id="52475659#qb0p1a_121">Run the Node.js application:</p><div class="detached code-block" id="52475659#qb0p1a_122"><pre><code class="language-bash">node index.js</code></pre></div><ul class="list" id="52475659#qb0p1a_123" start="1"><li class="list-item" id="52475659#qb0p1a_125"><p>Use Postman or cURL to test the CRUD operations against <span class="inline-code" id="52475659#qb0p1a_126">http://localhost:3000/todos</span>.</p></li></ul></li></ol></section><section><h2 id="52475659#step-2-dockerize-the-application" data-toc="step-2-dockerize-the-application#Kubernetes-101.md-step-2-dockerize-the-application">Step 2: Dockerize the Application</h2><ol class="list list-decimal" id="52475659#qb0p1a_127" type="1" start="1"><li class="list-item" id="52475659#qb0p1a_130"><p id="52475659#qb0p1a_133"><span class="control" id="52475659#qb0p1a_136">Create a Dockerfile</span>:</p><div class="detached code-block" id="52475659#qb0p1a_134"><pre><code class="language-none">FROM node:14

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .

EXPOSE 3000

CMD [&quot;node&quot;, &quot;index.js&quot;]</code></pre></div><ol class="list list-decimal" id="52475659#qb0p1a_135" type="1" start="2"><li class="list-item" id="52475659#qb0p1a_137"><p id="52475659#qb0p1a_138"><span class="control" id="52475659#qb0p1a_142">Create a <span class="inline-code" id="52475659#qb0p1a_143">docker-compose.yml</span> outside <span class="inline-code" id="52475659#qb0p1a_144">express-postgres-k8s</span> folder for Local Development</span>:</p><p id="52475659#qb0p1a_139">We'll use Docker Compose to run the application along with PostgreSQL.</p><div class="detached code-block" id="52475659#qb0p1a_140"><pre><code class="language-yaml">version: '3.8'

services:
  postgres:
    image: postgres:13
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: todo_db
      ports:
        - &quot;5432:5432&quot;
      volumes:
        - postgres-data:/var/lib/postgresql/data

  app:
    build:
      dockerfile: Dockerfile
      context: ./express-postgres-k8s
  environment:
    DB_HOST: postgres
    DB_USER: postgres
    DB_PASSWORD: password
    DB_NAME: todo_db
  ports:
    - &quot;3000:3000&quot;
  depends_on:
    - postgres

volumes:
  postgres-data:</code></pre></div><ul class="list" id="52475659#qb0p1a_141" start="1"><li class="list-item" id="52475659#qb0p1a_145"><p><span class="control" id="52475659#qb0p1a_146">Explanation</span>: </p><ul class="list" id="52475659#qb0p1a_147" start="1"><li class="list-item" id="52475659#qb0p1a_148"><p>This <span class="inline-code" id="52475659#qb0p1a_150">docker-compose.yml</span> sets up two services: <span class="inline-code" id="52475659#qb0p1a_151">postgres</span> and <span class="inline-code" id="52475659#qb0p1a_152">app</span>.</p></li><li class="list-item" id="52475659#qb0p1a_149"><p>The Node.js app depends on the PostgreSQL service and uses environment variables to connect to the database.</p></li></ul></li></ul></li></ol></li><li class="list-item" id="52475659#qb0p1a_131"><p id="52475659#qb0p1a_153"><span class="control" id="52475659#qb0p1a_156">Update <span class="inline-code" id="52475659#qb0p1a_157">db.js</span> to Use Environment Variables</span>:</p><p id="52475659#qb0p1a_154">Update the <span class="inline-code" id="52475659#qb0p1a_158">db.js</span> file to use the environment variables defined in <span class="inline-code" id="52475659#qb0p1a_159">docker-compose.yml</span>:</p><div class="detached code-block" id="52475659#qb0p1a_155"><pre><code class="language-javascript">const { Sequelize } = require('sequelize');

const sequelize = new Sequelize(process.env.DB_NAME, process.env.DB_USER, process.env.DB_PASSWORD, {
  host: process.env.DB_HOST,
  dialect: 'postgres',
});

sequelize.authenticate()
  .then(() =&gt; {
    console.log('Connection to PostgreSQL has been established successfully.');
  })
  .catch(err =&gt; {
    console.error('Unable to connect to the database:', err);
  });

module.exports = sequelize;</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_132"><p id="52475659#qb0p1a_160"><span class="control" id="52475659#qb0p1a_161">Testing the API</span>: install REST Client extension and create <span class="inline-code" id="52475659#qb0p1a_162">app.http</span> and add this code</p></li></ol><div class="detached code-block" id="52475659#qb0p1a_128"><pre><code class="language-javascript">### Create a new To-Do
POST http://localhost:3000/todos
Content-Type: application/json

{
 &quot;title&quot;: &quot;Buy groceries&quot;
}

### Get all To-Dos
GET http://localhost:3000/todos

### Get a single To-Do by ID
GET http://localhost:3000/todos/1

### Update a To-Do (mark as completed)
PUT http://localhost:3000/todos/1
Content-Type: application/json

{
 &quot;completed&quot;: true
}

### Delete a To-Do
DELETE http://localhost:3000/todos/1</code></pre></div><ol class="list list-decimal" id="52475659#qb0p1a_129" type="1" start="5"><li class="list-item" id="52475659#qb0p1a_163"><p id="52475659#qb0p1a_164"><span class="control" id="52475659#qb0p1a_167">Build and Run the Docker Compose Setup</span>:</p><div class="detached code-block" id="52475659#qb0p1a_165"><pre><code class="language-bash">docker-compose up --build</code></pre></div><ul class="list" id="52475659#qb0p1a_166" start="1"><li class="list-item" id="52475659#qb0p1a_168"><p>This command will build the Node.js Docker image, start the PostgreSQL service, and run the application.</p></li><li class="list-item" id="52475659#qb0p1a_169"><p>The app will be accessible at <span class="inline-code" id="52475659#qb0p1a_170">http://localhost:3000</span>.</p></li></ul></li></ol></section><section><h2 id="52475659#step-3-deploy-to-kubernetes" data-toc="step-3-deploy-to-kubernetes#Kubernetes-101.md-step-3-deploy-to-kubernetes">Step 3: Deploy to Kubernetes</h2><p id="52475659#qb0p1a_171">Now, let's deploy the application on Kubernetes.</p><ol class="list list-decimal" id="52475659#qb0p1a_172" type="1" start="1"><li class="list-item" id="52475659#qb0p1a_173"><p id="52475659#qb0p1a_177"><span class="control" id="52475659#qb0p1a_179">Push the Docker Image to Docker Hub</span>:</p><div class="detached code-block" id="52475659#qb0p1a_178"><pre><code class="language-bash">docker build -t &lt;your-dockerhub-username&gt;/node-postgres-todo:v1 .
docker push &lt;your-dockerhub-username&gt;/node-postgres-todo:v1</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_174"><p id="52475659#qb0p1a_180"><span class="control" id="52475659#qb0p1a_182">Create Kubernetes Manifests</span>:</p><ol class="list list-decimal" id="52475659#qb0p1a_181" type="1" start="1"><li class="list-item" id="52475659#qb0p1a_183"><p id="52475659#qb0p1a_188"><span class="control" id="52475659#qb0p1a_190">PostgreSQL Deployment</span> (<span class="inline-code" id="52475659#qb0p1a_191">postgres-deployment.yaml</span>):</p><div class="detached code-block" id="52475659#qb0p1a_189"><pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      app: postgres
  template:
    metadata:
      labels:
        app: postgres
    spec:
      containers:
      - name: postgres
        image: postgres:13
        ports:
        - containerPort: 5432
        env:
        - name: POSTGRES_USER
          value: &quot;postgres&quot;
        - name: POSTGRES_PASSWORD
          value: &quot;password&quot;
        - name: POSTGRES_DB
          value: &quot;todo_db&quot;
        volumeMounts:
        - mountPath: /var/lib/postgresql/data
          name: postgres-storage
      volumes:
      - name: postgres-storage
        persistentVolumeClaim:
          claimName: postgres-pvc</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_184"><p id="52475659#qb0p1a_192"><span class="control" id="52475659#qb0p1a_194">PostgreSQL Persistent Volume Claim</span> (<span class="inline-code" id="52475659#qb0p1a_195">postgres-pvc.yaml</span>):</p><div class="detached code-block" id="52475659#qb0p1a_193"><pre><code class="language-yaml">apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: postgres-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:


    requests:
      storage: 1Gi</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_185"><p id="52475659#qb0p1a_196"><span class="control" id="52475659#qb0p1a_198">PostgreSQL Service</span> (<span class="inline-code" id="52475659#qb0p1a_199">postgres-service.yaml</span>):</p><div class="detached code-block" id="52475659#qb0p1a_197"><pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: postgres-service
spec:
  selector:
    app: postgres
  ports:
    - protocol: TCP
      port: 5432
  type: ClusterIP</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_186"><p id="52475659#qb0p1a_200"><span class="control" id="52475659#qb0p1a_202">Node.js Application Deployment</span> (<span class="inline-code" id="52475659#qb0p1a_203">node-app-deployment.yaml</span>):</p><div class="detached code-block" id="52475659#qb0p1a_201"><pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: node-app-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: node-app
  template:
    metadata:
      labels:
        app: node-app
    spec:
      containers:
      - name: node-app
        image: &lt;your-dockerhub-username&gt;/node-postgres-todo:v1
        ports:
        - containerPort: 3000
        env:
        - name: DB_HOST
          value: &quot;postgres-service&quot;
        - name: DB_USER
          value: &quot;postgres&quot;
        - name: DB_PASSWORD
          value: &quot;password&quot;
        - name: DB_NAME
          value: &quot;todo_db&quot;</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_187"><p id="52475659#qb0p1a_204"><span class="control" id="52475659#qb0p1a_206">Node.js Application Service</span> (<span class="inline-code" id="52475659#qb0p1a_207">node-app-service.yaml</span>):</p><div class="detached code-block" id="52475659#qb0p1a_205"><pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: node-app-service
spec:
  selector:
    app: node-app
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3000
  type: LoadBalancer</code></pre></div></li></ol></li><li class="list-item" id="52475659#qb0p1a_175"><p id="52475659#qb0p1a_208"><span class="control" id="52475659#qb0p1a_210">Deploy to Kubernetes</span>:</p><div class="detached code-block" id="52475659#qb0p1a_209"><pre><code class="language-bash">kubectl apply -f postgres-pvc.yaml
kubectl apply -f postgres-deployment.yaml
kubectl apply -f postgres-service.yaml
kubectl apply -f node-app-deployment.yaml
kubectl apply -f node-app-service.yaml</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_176"><p id="52475659#qb0p1a_211"><span class="control" id="52475659#qb0p1a_213">Verify the Deployment</span>:</p><ul class="list" id="52475659#qb0p1a_212" start="1"><li class="list-item" id="52475659#qb0p1a_214"><p id="52475659#qb0p1a_216">Check the pods and services:</p><div class="detached code-block" id="52475659#qb0p1a_217"><pre><code class="language-bash">kubectl get pods
kubectl get svc</code></pre></div></li><li class="list-item" id="52475659#qb0p1a_215"><p id="52475659#qb0p1a_218">Once the services are up and running, the Node.js app will be accessible via the external IP of the <span class="inline-code" id="52475659#qb0p1a_219">node-app-service</span>.</p></li></ul></li></ol></section><section><h2 id="52475659#conclusion" data-toc="conclusion#Kubernetes-101.md-conclusion">Conclusion</h2><p id="52475659#qb0p1a_220">You've now created a full-stack Node.js application using Express and PostgreSQL with a simple To-Do list example. You've containerized the application using Docker, orchestrated it using Docker Compose for local development, and finally deployed it on Kubernetes. This example demonstrates how Kubernetes can help manage a multi-service application, providing scalability, load balancing, and resilience.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1601392088">Kubernetes Cheat Sheet</h1><p id="1601392088#-t2nprj_2">Here's a Kubernetes cheat sheet with some commonly used commands, including how to delete pods and more:</p><section><h2 id="1601392088#1-basic-commands" data-toc="1-basic-commands#Kubernetes Cheat Sheet.md-1-basic-commands">1. Basic Commands</h2><ul class="list" id="1601392088#-t2nprj_12" start="1"><li class="list-item" id="1601392088#-t2nprj_14"><p id="1601392088#-t2nprj_17"><span class="control" id="1601392088#-t2nprj_19">Get cluster information:</span></p><div class="detached code-block" id="1601392088#-t2nprj_18"><pre><code class="language-bash">kubectl cluster-info</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_15"><p id="1601392088#-t2nprj_20"><span class="control" id="1601392088#-t2nprj_22">View nodes in the cluster:</span></p><div class="detached code-block" id="1601392088#-t2nprj_21"><pre><code class="language-bash">kubectl get nodes</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_16"><p id="1601392088#-t2nprj_23"><span class="control" id="1601392088#-t2nprj_25">View all resources (pods, services, etc.):</span></p><div class="detached code-block" id="1601392088#-t2nprj_24"><pre><code class="language-bash">kubectl get all</code></pre></div></li></ul></section><section><h2 id="1601392088#2-pods" data-toc="2-pods#Kubernetes Cheat Sheet.md-2-pods">2. Pods</h2><ul class="list" id="1601392088#-t2nprj_27" start="1"><li class="list-item" id="1601392088#-t2nprj_29"><p id="1601392088#-t2nprj_36"><span class="control" id="1601392088#-t2nprj_38">List all pods in the current namespace:</span></p><div class="detached code-block" id="1601392088#-t2nprj_37"><pre><code class="language-bash">kubectl get pods</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_30"><p id="1601392088#-t2nprj_39"><span class="control" id="1601392088#-t2nprj_41">List pods in all namespaces:</span></p><div class="detached code-block" id="1601392088#-t2nprj_40"><pre><code class="language-bash">kubectl get pods --all-namespaces</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_31"><p id="1601392088#-t2nprj_42"><span class="control" id="1601392088#-t2nprj_44">Get detailed information about a pod:</span></p><div class="detached code-block" id="1601392088#-t2nprj_43"><pre><code class="language-bash">kubectl describe pod &lt;pod_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_32"><p id="1601392088#-t2nprj_45"><span class="control" id="1601392088#-t2nprj_47">Delete a specific pod:</span></p><div class="detached code-block" id="1601392088#-t2nprj_46"><pre><code class="language-bash">kubectl delete pod &lt;pod_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_33"><p id="1601392088#-t2nprj_48"><span class="control" id="1601392088#-t2nprj_50">Force delete a pod (without waiting for graceful termination):</span></p><div class="detached code-block" id="1601392088#-t2nprj_49"><pre><code class="language-bash">kubectl delete pod &lt;pod_name&gt; --grace-period=0 --force</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_34"><p id="1601392088#-t2nprj_51"><span class="control" id="1601392088#-t2nprj_53">Get logs of a specific pod:</span></p><div class="detached code-block" id="1601392088#-t2nprj_52"><pre><code class="language-bash">kubectl logs &lt;pod_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_35"><p id="1601392088#-t2nprj_54"><span class="control" id="1601392088#-t2nprj_56">Stream logs of a specific pod:</span></p><div class="detached code-block" id="1601392088#-t2nprj_55"><pre><code class="language-bash">kubectl logs -f &lt;pod_name&gt;</code></pre></div></li></ul></section><section><h2 id="1601392088#3-deployments" data-toc="3-deployments#Kubernetes Cheat Sheet.md-3-deployments">3. Deployments</h2><ul class="list" id="1601392088#-t2nprj_58" start="1"><li class="list-item" id="1601392088#-t2nprj_60"><p id="1601392088#-t2nprj_66"><span class="control" id="1601392088#-t2nprj_68">List all deployments:</span></p><div class="detached code-block" id="1601392088#-t2nprj_67"><pre><code class="language-bash">kubectl get deployments</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_61"><p id="1601392088#-t2nprj_69"><span class="control" id="1601392088#-t2nprj_71">Describe a specific deployment:</span></p><div class="detached code-block" id="1601392088#-t2nprj_70"><pre><code class="language-bash">kubectl describe deployment &lt;deployment_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_62"><p id="1601392088#-t2nprj_72"><span class="control" id="1601392088#-t2nprj_74">Create a deployment:</span></p><div class="detached code-block" id="1601392088#-t2nprj_73"><pre><code class="language-bash">kubectl create deployment &lt;deployment_name&gt; --image=&lt;image_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_63"><p id="1601392088#-t2nprj_75"><span class="control" id="1601392088#-t2nprj_77">Update a deployment with a new image:</span></p><div class="detached code-block" id="1601392088#-t2nprj_76"><pre><code class="language-bash">kubectl set image deployment/&lt;deployment_name&gt; &lt;container_name&gt;=&lt;new_image_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_64"><p id="1601392088#-t2nprj_78"><span class="control" id="1601392088#-t2nprj_80">Scale a deployment:</span></p><div class="detached code-block" id="1601392088#-t2nprj_79"><pre><code class="language-bash">kubectl scale deployment &lt;deployment_name&gt; --replicas=&lt;number_of_replicas&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_65"><p id="1601392088#-t2nprj_81"><span class="control" id="1601392088#-t2nprj_83">Delete a deployment:</span></p><div class="detached code-block" id="1601392088#-t2nprj_82"><pre><code class="language-bash">kubectl delete deployment &lt;deployment_name&gt;</code></pre></div></li></ul></section><section><h2 id="1601392088#4-services" data-toc="4-services#Kubernetes Cheat Sheet.md-4-services">4. Services</h2><ul class="list" id="1601392088#-t2nprj_85" start="1"><li class="list-item" id="1601392088#-t2nprj_87"><p id="1601392088#-t2nprj_91"><span class="control" id="1601392088#-t2nprj_93">List all services:</span></p><div class="detached code-block" id="1601392088#-t2nprj_92"><pre><code class="language-bash">kubectl get services</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_88"><p id="1601392088#-t2nprj_94"><span class="control" id="1601392088#-t2nprj_96">Describe a specific service:</span></p><div class="detached code-block" id="1601392088#-t2nprj_95"><pre><code class="language-bash">kubectl describe service &lt;service_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_89"><p id="1601392088#-t2nprj_97"><span class="control" id="1601392088#-t2nprj_99">Expose a deployment as a service:</span></p><div class="detached code-block" id="1601392088#-t2nprj_98"><pre><code class="language-bash">kubectl expose deployment &lt;deployment_name&gt; --type=&lt;type&gt; --port=&lt;port&gt; --target-port=&lt;target_port&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_90"><p id="1601392088#-t2nprj_100"><span class="control" id="1601392088#-t2nprj_102">Delete a service:</span></p><div class="detached code-block" id="1601392088#-t2nprj_101"><pre><code class="language-bash">kubectl delete service &lt;service_name&gt;</code></pre></div></li></ul></section><section><h2 id="1601392088#5-namespaces" data-toc="5-namespaces#Kubernetes Cheat Sheet.md-5-namespaces">5. Namespaces</h2><ul class="list" id="1601392088#-t2nprj_104" start="1"><li class="list-item" id="1601392088#-t2nprj_106"><p id="1601392088#-t2nprj_110"><span class="control" id="1601392088#-t2nprj_112">List all namespaces:</span></p><div class="detached code-block" id="1601392088#-t2nprj_111"><pre><code class="language-bash">kubectl get namespaces</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_107"><p id="1601392088#-t2nprj_113"><span class="control" id="1601392088#-t2nprj_115">Create a new namespace:</span></p><div class="detached code-block" id="1601392088#-t2nprj_114"><pre><code class="language-bash">kubectl create namespace &lt;namespace_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_108"><p id="1601392088#-t2nprj_116"><span class="control" id="1601392088#-t2nprj_118">Delete a namespace:</span></p><div class="detached code-block" id="1601392088#-t2nprj_117"><pre><code class="language-bash">kubectl delete namespace &lt;namespace_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_109"><p id="1601392088#-t2nprj_119"><span class="control" id="1601392088#-t2nprj_121">Switch to a different namespace:</span></p><div class="detached code-block" id="1601392088#-t2nprj_120"><pre><code class="language-bash">kubectl config set-context --current --namespace=&lt;namespace_name&gt;</code></pre></div></li></ul></section><section><h2 id="1601392088#6-configmaps-secrets" data-toc="6-configmaps-secrets#Kubernetes Cheat Sheet.md-6-configmaps-secrets">6. ConfigMaps &amp; Secrets</h2><ul class="list" id="1601392088#-t2nprj_123" start="1"><li class="list-item" id="1601392088#-t2nprj_125"><p id="1601392088#-t2nprj_129"><span class="control" id="1601392088#-t2nprj_131">Create a ConfigMap:</span></p><div class="detached code-block" id="1601392088#-t2nprj_130"><pre><code class="language-bash">kubectl create configmap &lt;configmap_name&gt; --from-literal=&lt;key&gt;=&lt;value&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_126"><p id="1601392088#-t2nprj_132"><span class="control" id="1601392088#-t2nprj_134">Create a Secret:</span></p><div class="detached code-block" id="1601392088#-t2nprj_133"><pre><code class="language-bash">kubectl create secret generic &lt;secret_name&gt; --from-literal=&lt;key&gt;=&lt;value&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_127"><p id="1601392088#-t2nprj_135"><span class="control" id="1601392088#-t2nprj_137">Describe a ConfigMap or Secret:</span></p><div class="detached code-block" id="1601392088#-t2nprj_136"><pre><code class="language-bash">kubectl describe configmap &lt;configmap_name&gt;
kubectl describe secret &lt;secret_name&gt;</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_128"><p id="1601392088#-t2nprj_138"><span class="control" id="1601392088#-t2nprj_140">Delete a ConfigMap or Secret:</span></p><div class="detached code-block" id="1601392088#-t2nprj_139"><pre><code class="language-bash">kubectl delete configmap &lt;configmap_name&gt;
kubectl delete secret &lt;secret_name&gt;</code></pre></div></li></ul></section><section><h2 id="1601392088#7-others" data-toc="7-others#Kubernetes Cheat Sheet.md-7-others">7. Others</h2><ul class="list" id="1601392088#-t2nprj_142" start="1"><li class="list-item" id="1601392088#-t2nprj_145"><p id="1601392088#-t2nprj_149"><span class="control" id="1601392088#-t2nprj_151">Apply a configuration from a file:</span></p><div class="detached code-block" id="1601392088#-t2nprj_150"><pre><code class="language-bash">kubectl apply -f &lt;file_name&gt;.yaml</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_146"><p id="1601392088#-t2nprj_152"><span class="control" id="1601392088#-t2nprj_154">Delete resources from a file:</span></p><div class="detached code-block" id="1601392088#-t2nprj_153"><pre><code class="language-bash">kubectl delete -f &lt;file_name&gt;.yaml</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_147"><p id="1601392088#-t2nprj_155"><span class="control" id="1601392088#-t2nprj_157">View events:</span></p><div class="detached code-block" id="1601392088#-t2nprj_156"><pre><code class="language-bash">kubectl get events</code></pre></div></li><li class="list-item" id="1601392088#-t2nprj_148"><p id="1601392088#-t2nprj_158"><span class="control" id="1601392088#-t2nprj_160">View the current context:</span></p><div class="detached code-block" id="1601392088#-t2nprj_159"><pre><code class="language-bash">kubectl config current-context</code></pre></div></li></ul><p id="1601392088#-t2nprj_143">This cheat sheet covers the most common operations in Kubernetes. It&rsquo;s helpful to keep this handy when working with Kubernetes clusters!</p></section></article></div></section></div></body></html>